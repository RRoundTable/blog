<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://fastpages.fast.ai/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://fastpages.fast.ai/blog/" rel="alternate" type="text/html" /><updated>2020-06-17T20:54:23-05:00</updated><id>https://fastpages.fast.ai/blog/feed.xml</id><title type="html">RoundTable</title><subtitle>An easy to use blogging platform with support for Jupyter Notebooks.</subtitle><entry><title type="html">Residual Variational Autoencoder: Anomaly Detection에 활용하기</title><link href="https://fastpages.fast.ai/blog/deeplearning/anomayl%20detection/2020/06/05/Residual-Variational-Autoencoder.html" rel="alternate" type="text/html" title="Residual Variational Autoencoder: Anomaly Detection에 활용하기" /><published>2020-06-05T00:00:00-05:00</published><updated>2020-06-05T00:00:00-05:00</updated><id>https://fastpages.fast.ai/blog/deeplearning/anomayl%20detection/2020/06/05/Residual-Variational-Autoencoder</id><content type="html" xml:base="https://fastpages.fast.ai/blog/deeplearning/anomayl%20detection/2020/06/05/Residual-Variational-Autoencoder.html">&lt;h1 id=&quot;residual-variational-autoencoder-anomaly-detection에-활용하기&quot;&gt;Residual Variational Autoencoder: Anomaly Detection에 활용하기&lt;/h1&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;이번 포스팅은 마키나락스에서 내부적으로 개발한 Residual Variational Autoencoder에 대해서 작성하였습니다.&lt;/p&gt;

&lt;p&gt;많은 딥러닝의 연구들은 비선형적인 레이어를 깊게 쌓으면서 좋은 성능을 보여줬습니다. 대표적인 예로, Resnet의 경우에 더 깊은 레이어를 효과적으로 쌓아 성능향상을 이루었습니다.&lt;/p&gt;

&lt;p&gt;같은 맥락으로 Residual Variational Autoencoder은 레이어를 효과적으로 사용할 수 있도록 설계했습니다. 결과적으로 깊은 레이어를 통해 만들어진 정보압축을 통해서 anomaly detection에서 뛰어난 성능을 보여줬습니다.&lt;/p&gt;

&lt;p&gt;아래의 글에서는 RVAE(Residual Variational Autoencoder)의 동기와 직면하였던 문제들에 대해서 설명드리고, anomaly detection 실험결과를 공유드리면서 글을 마치려고 합니다.&lt;/p&gt;

&lt;h2 id=&quot;related-works&quot;&gt;Related Works&lt;/h2&gt;

&lt;h3 id=&quot;residual-connection&quot;&gt;Residual Connection&lt;/h3&gt;

&lt;p&gt;딥러닝 모델이 깊어지게 되면, 모델의 표현능력이 커지게 되며 train loss는 더 작아져야합니다. 하지만, 모델이 깊어지게 되면서 &lt;strong&gt;train loss&lt;/strong&gt;가 더 증가하기도 하며, 이를 degradation이라고 정의합니다. 아래의 이미지는 degradation 문제를 보여줍니다. [4]&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/degradation.png&quot; alt=&quot;degradation&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Resnet은 Residual connection을 통해서 Degradation 문제를 효과적으로 해결했습니다.[4]&lt;/p&gt;

&lt;p&gt;Residual Connection은 직관적으로는 레이어간의 지름길을 뚫어주는 효과를 줍니다. Residual Connection의 구조는 아래의 그림을 통해서 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/residual_learning.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;gradient-explosion-in-deep-network&quot;&gt;Gradient Explosion in deep network&lt;/h3&gt;

&lt;p&gt;gradient explosion이란 학습과정에서 backpropagation 도중에 gradient가 갑작스럽게 증가하는 현상을 의미합니다.&lt;/p&gt;

&lt;p&gt;딥러닝 연구에서 일반적으로 비선형적인 레이어를 효과적으로 쌓으면, 모델 성능이 좋아지는 것을 보여줍니다.
하지만, 레이어를 깊게 쌓을 때, graidnet vanishing/explosion 문제가 발생하여 오히려 모델 성능이 하락하는 문제가 발생됩니다. [4, 5, 6, 7, 10]&lt;/p&gt;

&lt;h3 id=&quot;anomaly-detection-based-on-autoencoder&quot;&gt;Anomaly detection based on Autoencoder&lt;/h3&gt;

&lt;p&gt;anomaly detection에서 &lt;strong&gt;Autoencdoer&lt;/strong&gt;구조는 많이 활용되고 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://makinarocks.github.io/assets/images/20191215/1.png&quot; alt=&quot;autoencoder&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Autoencoder는 x 라는 고차원의 데이터를 저차원의 latent space(z)로 압축하고 이를 다시 $\hat{x}$ 로 복원시키는 구조이며, 이때 MSE(Mean Squared Error) $\rVert x - \hat{x} \rVert^2$을 최소화하는 방향으로 학습이 진행됩니다. manifold 가설에 따르면, Autoencoder는 input data의 noise를 제거하면서 의미있는 정보압축을 진행하는 방향으로 학습됩니다. [2]&lt;/p&gt;

&lt;p&gt;이렇게 학습된 Autoencoder는 다음과 같은 과정을 통해서 anomayl detection을 수행합니다. [1]&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;입력 샘플을 인코더를 통해 저차원으로 압축합니다.&lt;/li&gt;
  &lt;li&gt;압축된 샘플을 디코더를 통과시켜 다시 원래의 차원으로 복원합니다.&lt;/li&gt;
  &lt;li&gt;입력 샘플과 복원 샘플의 복원 오차(reconstruction error)를 구합니다.&lt;/li&gt;
  &lt;li&gt;복원 오차는 이상 점수(anomaly score)가 되어 threshold와 비교를 통해 이상 여부를 결정합니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;anomaly-detection-based-on-variational-autoencoder&quot;&gt;Anomaly detection based on Variational Autoencoder&lt;/h2&gt;

&lt;p&gt;variational autoencoder는 저자 Kingma가 2014년에 Auto-Encoding Variational Bayes [4]을 통해서 소개한 바 있습니다. variational autoencoder는 해당 논문에서 소개한 reparameterization trick을 통해서 인코더가 생성하는 $m, \sigma$ 로 latent variable $z$를 샘플링하고 이로부터 posterior distribuion $p(x | z)$ 를 근사하여 학습하게 됩니다. [1]
&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://makinarocks.github.io/assets/images/20191215/5.png&quot; alt=&quot;vae&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$x \in R^n$: input data&lt;/li&gt;
  &lt;li&gt;$z \in R^m$: latent variable&lt;/li&gt;
  &lt;li&gt;$\hat{x} \in R^n$: reconstructed data&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;variational autoencoder에서는 MSE(Mean Squared Error)에 KLD 항을 더하여 loss function이 정의됩니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;∥&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;∥&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;σ&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;loss_{vae} = \rVert x - \hat{x} \rVert ^ 2 + KL( \mathcal{N} (m, \sigma), \mathcal{N}(0, I))&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;e&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;∥&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1141079999999999em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;∥&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8641079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathcal&quot; style=&quot;margin-right:0.14736em;&quot;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;σ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathcal&quot; style=&quot;margin-right:0.14736em;&quot;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;결론적으로 VAE는 MSE(reconstruction error)를 최소화하는 과정에서 KLD도 감소시켜야합니다. reconstruction error와 KLD는 서로 반대방향으로 움직이는 경향이 있습니다. KLD이 0이 된다면 input data에 대해서 독립적인 latent variable을 생성하게 됩니다. 그렇게 되면, reconstruction error가 높아집니다. 반대로, reconstruction error가 0이 된다면, KLD의 값이 커지게 됩니다. 정리하면, KLD의 역할은 VAE 모델이 x와 z가 적당히 연관되면서 reconstruction과 상관없는 정보를 더 잘 버릴수 있도록 하는데 있습니다. [1]&lt;/p&gt;

&lt;p&gt;이처럼 KLD는 훌륭하게 regularizer의 역할을 하며 오버피팅을 막아줍니다. 결과적으로 이것은 마치 주어진 상황에서 최적의 병목 구간 크기를 갖게 하는 효과를 갖습니다. KLD를 통해 VAE는 vanilla autoencoder에 비해 훨씬 나은 성능의 이상탐지(anomaly detection) 성능을 제공합니다. 실험을 통해 우리는 기존의 autoencoder는 너무 큰 bottleneck을 가지면 identity function이 되며 이상탐지 성능이 떨어지는 것에 반해, VAE는 bottleneck의 크기가 커질수록 이상탐지 성능이 오르는 효과를 갖는 것을 확인할 수 있었습니다. 따라서 AE 기반의 anomaly detection을 수행할 때, 기존에는 bottleneck의 크기를 hyper-parameter로 튜닝해야 했던 반면에, VAE의 경우에는 튜닝을 할 필요가 거의 없어졌습니다. [1]&lt;/p&gt;

&lt;h2 id=&quot;motivation&quot;&gt;Motivation&lt;/h2&gt;

&lt;p&gt;AE(autoencoder)와 VAE(variational AE)는 휼륭한 결과를 보여줬습니다. 하지만, 레이어를 깊게 쌓을 수 없다는 한계가 있었습니다. 실험을 통해서, 레이어의 수가 특정 임계치를 넘어가면 레이어의 수가 늘어날 수록 train loss가 증가하는 현상이 발생하는 것을 확인했습니다. 우리는 이것을 &lt;strong&gt;degradation&lt;/strong&gt; 문제로 정의했습니다. [4]&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;AE: train loss&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;AE: AUROC&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/emnist_train_loss.png&quot; alt=&quot;Degradation&quot; /&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/emnist_auroc.png&quot; alt=&quot;Degradation&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;위의 실험은 EMNIST 데이터셋을 바탕으로 anomaly detection의 실험환경에서 진행하였습니다. n_layers는 각 인코더, 디코더의 layer의 수를 의미합니다. 우리는 대칭적인 AE를 사용했으므로, 총 레이어의 수는 n_layers x 2 입니다.&lt;/p&gt;

&lt;p&gt;효과적인 anomaly detection을 위해서는 일정수 이상의 레이어가 필요합니다. 이는 layer가 깊어질수록 더 많은 것을 고려한 압축과 복원작업을 학습하기 때문에, 더 의미있는 정보를 압축했다고 해석할 수 있습니다.&lt;/p&gt;

&lt;p&gt;하지만, 기존의 AE에서는 레이어의 수가 임계치를 넘으면 train loss가 증가하며, auroc성능도 함께 하락합니다. 따라서 레이어를 쌓으면서 train loss를 줄이기 위한 방법이 필요합니다.&lt;/p&gt;

&lt;p&gt;이를 위해서 &lt;strong&gt;Residual Connection&lt;/strong&gt;을 고려했습니다. &lt;strong&gt;더 깊은 레이어&lt;/strong&gt;의 AE 혹은 VAE 구조를 효과적으로 학습하기 위해서 Residual connection을 고려하게 되었습니다. [4]&lt;/p&gt;

&lt;h2 id=&quot;method&quot;&gt;Method&lt;/h2&gt;

&lt;p&gt;본 섹션은 크게 3가지로 나누어서 설명드리겠습니다. 우리가 겪은 문제는 크게 3가지 입니다.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Degradation을 어떻게 해결할 것인가?&lt;/li&gt;
  &lt;li&gt;AE 구조에서 residual connection을 어떻게 구현할 것인가?&lt;/li&gt;
  &lt;li&gt;Residual AE에서 발생하는 gradient explosion은 어떻게 해결할 것인가?&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;degradation-residual-connection&quot;&gt;Degradation: Residual Connection&lt;/h3&gt;

&lt;p&gt;Degradation 문제를 해결하기 위해서 Residual Connection을 활용하였습니다.[4] 일반적으로 residual connection을 사용하게 되면, gradient의 지름길이 뚫려서 멀리까지 전달되는 효과가 있습니다. residual connection은 결과적으로 gradient vanishing 문제를 효과적으로 해결 할 수 있으며 모델의 효과적인 학습에 기여합니다.&lt;/p&gt;

&lt;p&gt;residual connection을 수식으로 나타내면 아래와 같습니다. [4]&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot;&gt;&lt;/mspace&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;y_l = h(x_l) + \mathcal{F}(x_l, W_l) \\
x_{l+1} = f(y_l)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.625em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathcal&quot; style=&quot;margin-right:0.09931em;&quot;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace newline&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.638891em;vertical-align:-0.208331em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3361079999999999em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.208331em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;ul&gt;
  &lt;li&gt;$x_l$: l-th residual unit&lt;/li&gt;
  &lt;li&gt;$W_l = {w_{l, k} \mid 1 \le k \le K}$: l-th layer weight and bias&lt;/li&gt;
  &lt;li&gt;$K$: the number of layers in reisudal unit&lt;/li&gt;
  &lt;li&gt;$F$: reisdual function&lt;/li&gt;
  &lt;li&gt;$f$: activation function&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;우리가 사용한 Residual connection 구조는 (b) proposed(identity)입니다.[8]&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/original-identity.png&quot; alt=&quot;structure&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(b) proposed는 해당 identity 구조입니다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;identity mapping&lt;/strong&gt;은 아래와 같은 관계를 가집니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;x_{l+1} = x_l + \mathcal{F}(x_l, W_l)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.638891em;vertical-align:-0.208331em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3361079999999999em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.208331em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.73333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathcal&quot; style=&quot;margin-right:0.09931em;&quot;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;이를 재귀적으로 풀어보면 아래와 같습니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;x_{L} = x_l + \sum_{i=l}^{L-1}\mathcal{F}(x_i, W_i)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.58056em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.32833099999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.73333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:3.1304490000000005em;vertical-align:-1.302113em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.8283360000000002em;&quot;&gt;&lt;span style=&quot;top:-1.8478869999999998em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.0500049999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop op-symbol large-op&quot;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.300005em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.302113em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathcal&quot; style=&quot;margin-right:0.09931em;&quot;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;이처럼 identity mapping은 현재 레이어를 거쳐온 모든 레이어의 정보를 가지고 있다고 볼 수 있습니다. 그리고 이러한 관계는 backpropagation에서 근사한 특징을 가집니다. 미분하는 과정을 생각해보면, $x_L$이 $x_l$을 포함하기 때문에 $\frac{\partial x_L}{\partial x_l}$ 을 계산할 때, $\frac{Loss}{\partial x_L}$은 보존되게 됩니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\frac{\partial Loss}{\partial x_l} = \frac{\partial Loss}{\partial x_L} \frac{\partial x_L}{\partial x_l} = \frac{\partial Loss}{\partial x_L}(1 + \frac{\partial}{\partial x_l}\sum_{i = l + 1}^{L-1}\mathcal{F}(x_i, W_i))&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.20744em;vertical-align:-0.8360000000000001em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.37144em;&quot;&gt;&lt;span style=&quot;top:-2.3139999999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8360000000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.20744em;vertical-align:-0.8360000000000001em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.37144em;&quot;&gt;&lt;span style=&quot;top:-2.3139999999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.32833099999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8360000000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.37144em;&quot;&gt;&lt;span style=&quot;top:-2.3139999999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.32833099999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8360000000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.20744em;vertical-align:-0.8360000000000001em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.37144em;&quot;&gt;&lt;span style=&quot;top:-2.3139999999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.32833099999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8360000000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:3.1887800000000004em;vertical-align:-1.360444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.37144em;&quot;&gt;&lt;span style=&quot;top:-2.3139999999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8360000000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.8283360000000002em;&quot;&gt;&lt;span style=&quot;top:-1.8478869999999998em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.0500049999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop op-symbol large-op&quot;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.300005em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.360444em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathcal&quot; style=&quot;margin-right:0.09931em;&quot;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;이러한 특징은 &lt;strong&gt;degradation&lt;/strong&gt; 문제를 매우 효과적으로 해결해줍니다. 따라서, 레이어가 깊어지더라도 train loss가 증가하는 폭을 낮출 수 있습니다.&lt;/p&gt;

&lt;p&gt;우리는 이러한 identity mapping의 효과를 기대하며, 이를 AE에 적용했습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/residual_ae.jpeg&quot; alt=&quot;직관적인 그림&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;gradient-explosion-gradient-clipping&quot;&gt;Gradient Explosion: Gradient Clipping&lt;/h3&gt;

&lt;p&gt;위의 과정을 거쳐서 residual AE/VAE가 완성되었지만, 해결해야 할 문제가 생겼습니다. 더 깊은 모델을 학습하는 과정에서 gradient explosion현상이 발생했습니다.[10] 이로 인해서 Residual Autoencoder를 학습할 때 아래와 같이 학습이 매우 불안정적으로 진행되었습니다. (g_norm은 gradient의 norm을 의미합니다.)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/gradient_explosion.png&quot; alt=&quot;gradient explosion&quot; /&gt;&lt;/p&gt;

&lt;p&gt;해당 그래프는 Residual AE를 MNIST데이터 셋을 학습시킨 결과입니다.&lt;/p&gt;

&lt;p&gt;발생하는 원인에 대해서 loss surface가 아래와 같이 매우 극단적으로 나오는 것으로 추론할 수 있습니다.&lt;/p&gt;

&lt;p&gt;이해를 돕기 위해서 아래와 같은 이미지로 설명드리겠습니다. 아래의 이미지는 모델의 파라미터가 $W \in R, b \in R$ 만 존재하는 경우의 loss surface입니다. 파란색 점은 모델의 파라미터에 대응하는 loss를 의미합니다. 학습이 진행되다가 loss surface가 매우 가파른 곳을 만나게되면, gradient의 값이 매우 커지게 됩니다. [7]&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/ExplodingGradient_Razvan.png&quot; alt=&quot;loss surface&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이를 해결하기 위해서 graidient를 clipping하여 사용했습니다. gradient clipping을 한다는 것은 weight가 학습되는 폭을 강제로 제한 하는 것입니다. 실제로 recurrent network를 학습시킬때 많이 활용하던 방법입니다. [12]&lt;/p&gt;

&lt;h2 id=&quot;experiments&quot;&gt;Experiments&lt;/h2&gt;

&lt;p&gt;실험은 Residual AE/VAE 모델의 성능을 검증하기 위해서 설계되었습니다. 모델 성능은 train loss와 anomaly detection의 auroc를 통해서 검증하였습니다.&lt;/p&gt;

&lt;p&gt;실험파트는 크게 두 가지 내용을 검증합니다. 첫 번째로 AE 구조에서 Residual Connection이 degradation 문제를 해결하였는지 검증하였습니다. 이러한 결과를 바탕으로 anomaly detection에서 긍정적인 방향으로 적용되는지 실험하였습니다.&lt;/p&gt;

&lt;h3 id=&quot;rae-vs-ae&quot;&gt;RAE vs AE&lt;/h3&gt;

&lt;p&gt;동일한 레이어의 대비 RAE와 AE 성능을 살펴보고, 각 모델의 최고 성능을 비교해보겠습니다. 실험에서 사용한 데이터셋은 &lt;a href=&quot;https://www.nist.gov/itl/products-and-services/emnist-dataset&quot;&gt;EMNIST&lt;/a&gt; 이며, byclass의 데이터셋에서 0번 클레스를 anomaly class로 설정하였습니다. [14] 또한 anomaly class의 비율은 전체 데이터셋의 0.35로 고정시킨채 실험을 진행했습니다.&lt;/p&gt;

&lt;h4 id=&quot;train-loss&quot;&gt;Train loss&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/rae_train_loss.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위의 그래프는 레이어의 수에 따른 train loss를 나타냅니다. 해당 결과는 AE 구조에서 나타나던 degradation 문제를 경감시킨 것을 보여줍니다.&lt;/p&gt;

&lt;h4 id=&quot;auroc&quot;&gt;AUROC&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-06-05-Residual-Variational-Autoencoder/rae_auroc.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위의 그래프는 레이어 수 당 auroc를 나타냅니다. degradation 문제를 경감시키고 나서 anomaly detection에서의 성능을 확인해봤습니다. 아쉽게도 감소시킨 train loss가 auroc 성능향상에 도움을 줬으나, 일관성은 부족했습니다.&lt;/p&gt;

&lt;p&gt;우리는 이것을 anomaly detection에서의 오버피팅이라고 생각하고 있습니다. n_layers = 6인 모델이 n_layers=4인 모델보다 복원에 필요한 압축은 잘하지만, 정상과 비정상을 나눌 수 있는 압축의 능력은 떨어졌습니다. 적절한 regularization이 더해진다면, 일관성 있는 결과가 나올 것으로 기대할 수 있습니다.&lt;/p&gt;

&lt;h3 id=&quot;rvae-vs-vae&quot;&gt;RVAE vs VAE&lt;/h3&gt;

&lt;p&gt;위에서 residual connection이 degradation 문제를 효과적으로 해결했음을 보였습니다. 이런 효과를 바탕으로 Residual VAE를 구현하여 실험했습니다. Variational AE, RVAE 같은 경우에는 KLD 값의 영향으로 train loss를 비교하는 것은 어렵습니다. 따라서 AUROC 성능으로 검증하도록 하겠습니다.&lt;/p&gt;

&lt;h4 id=&quot;auroc-1&quot;&gt;AUROC&lt;/h4&gt;

&lt;p&gt;아래의 실험은 SEED를 고정시키고 실험을 진행했습니다. 다른 논문의 VAE의 벤치마크 성능[13]과 비교해봤을 때, 큰 차이가 없는 것을 확인했습니다.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;n_layers&lt;/th&gt;
      &lt;th&gt;RVAE&lt;/th&gt;
      &lt;th&gt;VAE&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0.99&lt;/td&gt;
      &lt;td&gt;0.987&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0.408&lt;/td&gt;
      &lt;td&gt;0.396&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0.99&lt;/td&gt;
      &lt;td&gt;0.991&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;0.969&lt;/td&gt;
      &lt;td&gt;0.97&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.944&lt;/td&gt;
      &lt;td&gt;0.935&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;0.968&lt;/td&gt;
      &lt;td&gt;0.969&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;0.962&lt;/td&gt;
      &lt;td&gt;0.943&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;0.909&lt;/td&gt;
      &lt;td&gt;0.91&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;0.974&lt;/td&gt;
      &lt;td&gt;0.972&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;0.848&lt;/td&gt;
      &lt;td&gt;0.833&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;위의 실험결과를 통해서 RVAE 모델이 VAE모델보다 AUROC 성능을 향상 시킨 것을 확인했습니다. 실험결과를 보면 이렇게 해석할 수 있습니다. Residual Connection의 영향으로 레이어가 깊어져도 train loss는 낮게 유지할 수 있었습니다. 이는 상대적으로 큰 모델을 효과적으로 학습할 수 있음을 의미합니다. KLD를 활용한 regularization과 합쳐지면서 모델은 더 효과적인 압축을 진행할 수 있게 됩니다.&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;더 깊은 레이어를 쌓으면서 발생했던 degradation 문제와 이를 해결하기 위한 residual connection에 대해서 다뤄습니다. 또한, AE 구조에 residual connection을 적용하기 위한 노력들과 깊은 fully connected layer와 batch normalization을 같이 사용하면서 발생한 gradient explosion 현상을 해결하기 위해서 gradient clipping을 적용하였습니다.&lt;/p&gt;

&lt;p&gt;결과적으로 RAE를 통해서 깊은 레이어의 모델에서 발생하는 degradation문제를 해결할 수 있었고, 여기에 KLD regularization을 적용하여 AUROC(anomaly detection 성능)을 높였습니다.&lt;/p&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;p&gt;[1] &lt;a href=&quot;https://makinarocks.github.io/Autoencoder-based-anomaly-detection/&quot;&gt;Makinarocks: Autoencoder based Anomaly Detection&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;[2] Stanislav Pidhorskyi et al., Generative Probabilistic Novelty Detection with Adversarial Autoencoders, NeurIPS, 2018&lt;/p&gt;

&lt;p&gt;[3] Kingma et al., Auto-Encoding Variational Bayes, ICLR, 2014&lt;/p&gt;

&lt;p&gt;[4] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning
for image recognition. In CVPR, 2016&lt;/p&gt;

&lt;p&gt;[5] Y. Bengio, P. Simard, and P. Frasconi. Learning long-term dependencies with gradient descent is difficult. IEEE Transactions on Neural
Networks, 5(2):157–166, 1994.&lt;/p&gt;

&lt;p&gt;[6] S. Hochreiter. Untersuchungen zu dynamischen neuronalen netzen.
Diploma thesis, TU Munich, 1991.&lt;/p&gt;

&lt;p&gt;[7] X. Glorot and Y. Bengio. Understanding the difficulty of training
deep feedforward neural networks. In AISTATS, 2010&lt;/p&gt;

&lt;p&gt;[8] K. He, X. Zhang, S. Ren, and J. Sun. Identity mappings in
deep residual networks. In ECCV, 2016&lt;/p&gt;

&lt;p&gt;[9] https://colah.github.io/posts/2014-03-NN-Manifolds-Topology/&lt;/p&gt;

&lt;p&gt;[10] Song Mei, Andrea Montanari, and Phan-Minh Nguyen. A mean field view of the landscape
of two-layer neural networks. Proceedings of the National Academy of Sciences, 115(33):
E7665–E7671, 2018.&lt;/p&gt;

&lt;p&gt;[11] A. Veit, M. Wilber, and S. Belongie. Residual networks
behave like ensembles of relatively shallow network. In
NIPS, 2016.&lt;/p&gt;

&lt;p&gt;[12] Pascanu, R., Mikolov, T., and Bengio, Y. (2013b). On the difficulty of training recurrent neural
networks. In Proceedings of the 30th International Conference on Machine Learning (ICML
2013).&lt;/p&gt;

&lt;p&gt;[13] Kim, K., Shim, S., Lim, Y., Jeon, J., Choi, J., Kim, B., Yoon, A., 2020. Rapp: Novelty
Detection With Reconstruction Along Projection Pathway. ICLR 2020&lt;/p&gt;

&lt;p&gt;[14] Cohen, G., Afshar, S., Tapson, J., &amp;amp; van Schaik, A. (2017). EMNIST: an extension of MNIST to handwritten letters. Retrieved from http://arxiv.org/abs/1702.05373&lt;/p&gt;</content><author><name></name></author><summary type="html">Residual Variational Autoencoder: Anomaly Detection에 활용하기</summary></entry><entry><title type="html">Integrated Gradient 정리글</title><link href="https://fastpages.fast.ai/blog/deeplearning/xai/2020/05/05/integrated-gradient.html" rel="alternate" type="text/html" title="Integrated Gradient 정리글" /><published>2020-05-05T00:00:00-05:00</published><updated>2020-05-05T00:00:00-05:00</updated><id>https://fastpages.fast.ai/blog/deeplearning/xai/2020/05/05/integrated-gradient</id><content type="html" xml:base="https://fastpages.fast.ai/blog/deeplearning/xai/2020/05/05/integrated-gradient.html">&lt;h1 id=&quot;integrated-gradient-정리글&quot;&gt;Integrated Gradient 정리글&lt;/h1&gt;

&lt;p&gt;XAI을 위한 다양한 방법론들이 있습니다. 그 중 input feature의 attribution을 파악하는 다양한 기법들이 있습니다. attribution이란 input feature가 모델의 예측에 영향을 끼쳤는지 나타내주는 값입니다.&lt;/p&gt;

&lt;p&gt;하지만, 정량적으로 이들을 비교하고 성능을 평가하는 것은 쉽지 않습니다. 일반적인 모델들은 accuracy를 가지고 판단할 수 있지만, attribution을 생성하는 모델의 경우에는 정량적으로 평가하기 쉽지 않습니다.&lt;/p&gt;

&lt;p&gt;2017년도 ICML에서 소개된 &lt;strong&gt;‘Axiomatic Attribution for Deep Networks’&lt;/strong&gt; 에서는 이런 문제의식을 가지고 연구를 진행했습니다.&lt;/p&gt;

&lt;p&gt;이 논문에서는 attribution 방법론이 가져야 하는 주요한 성질(axioms)에 대해서 설명하고, 그 성질을 만족하는 integrated gradient 방법을 제안합니다.&lt;/p&gt;

&lt;h2 id=&quot;attribution이란&quot;&gt;Attribution이란?&lt;/h2&gt;

&lt;p&gt;Attribution을 파악한다는 것은 모델의 input과 output간의 관계를 파악하는 것입니다. 즉, model이 예측을 할 때, 어떤 input feature가 해당 예측에 큰 영향을 주었는지 파악하는 것이 주요한 목적입니다.&lt;/p&gt;

&lt;p&gt;본 논문에서 Attribution은 아래와 같이 정의될 수 있습니다. 주목할 점은 attribution을 구할 때, input과 baseline을 함께 사용한다는 점입니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;deep network: $F: R^n \rightarrow [0, 1]$&lt;/li&gt;
  &lt;li&gt;input: $x = (x_1, \cdots, x_n) \in R^n$&lt;/li&gt;
  &lt;li&gt;baseline input: $\acute{x} = (\acute{x_1}, \cdots, \acute{x_n}) \in R^n$&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Attribution은 아래와 같이 수식으로 나타낼 수 있습니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;ˊ&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mo&gt;⋯&lt;/mo&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;A_F(x, \acute{x}) = (a_1, \cdots, a_n) \in R^n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.32833099999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;ˊ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;⋯&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.7143919999999999em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.00773em;&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7143919999999999em;&quot;&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;$a_1, \cdots, a_n$은 feature importance와 유사한 개념입니다.&lt;/p&gt;

&lt;p&gt;baseline이란, 일종의 비교대상입니다. 아래의 gradient 이미지를 보면, 직관적으로 받아들 일 수 있으리라 생각됩니다. 좋은 baseline이란, 모델에 대해서 중립적인 의미를 가지는 데이터포인트입니다.&lt;/p&gt;

&lt;p&gt;예를 들어, object recognition에 경우에 input image의 어느 pixel이 특정 class라고 판단하게 하는지 구할 수 있습니다.  일반적인 경우에는 baseline 이미지는 zero pixel로 두어 구하기도 합니다. 자세한 사항은 아래의 gradient 부분에서 다루도록 하겠습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-05-05-Integrated-gradient-정리글/ex1.png&quot; alt=&quot;&quot; title=&quot;Example1&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;motivation-정량적-평가가-아닌-two-fundamental-axioms을-통해서&quot;&gt;Motivation: 정량적 평가가 아닌 Two Fundamental Axioms을 통해서&lt;/h2&gt;

&lt;p&gt;많은 attribution method의 문제는 평가하는 것이 어렵다는 것입니다. 정량적으로 평가하는 방법들이 있지만, 한계가 명확합니다. attribution이 높은 feature들을 제거하면서 모델의 성능이 얼마나 떨어지는지 파악하기도 합니다. 언뜻 생각해보면, 상당히 직관적인 방법입니다. 하지만, 일부 feature가 제거된 모델의 성능이 떨어지는 이유가 단지 중요한 feature여서이기보다는 모델이 학습시키지 않은 분포의 데이터이기 때문에 성능하락이 나타날 수 있습니다.&lt;/p&gt;

&lt;p&gt;아래의 이미지를 예시로 설명드리겠습니다. input image를 개로 분류하는데 주요한 feauture가 코라고 가정해보겠습니다. 그럼 아래의 이미지처럼 코 부분을 zero-pixel로 만들고 model metric이 떨어지는지 파악합니다. 주요한 feature를 제거했기 때문에, metric값은 떨어질 것입니다. 하지만, 이때 metric이 떨어진 것이 주요한 feature를 제거했기 때문인지, 코 부분을 인위적으로 제거한 unrealistic한 이미지때문인지는 판단하기 어렵습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-05-05-Integrated-gradient-정리글/remove_feature.png&quot; alt=&quot;&quot; title=&quot;Example2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;본 연구에서는 이런 한계를 극복하기 위해서 정량적인 평가보다는 주요한 성질(axioms)을 정의하고 이를 충족시키는 intergrated gradient라는 방법을 제안합니다.&lt;/p&gt;

&lt;p&gt;그리고 그 두가지 조건은 아래와 같습니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Sensitivity&lt;/li&gt;
  &lt;li&gt;Implementation Invariance&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;sensitivity이란&quot;&gt;Sensitivity이란?&lt;/h3&gt;

&lt;p&gt;baseline과 input과의 차이가 오직 하나의 feature이고 baseline의 예측과 input의 예측이 다른경우를 가정해보겠습니다. 이런 상황에서는 차이나는 feature가 모델의 예측에 영향을 끼쳤다고 생각할 수 있습니다.  이렇게 차이나는 feature는 non-zero의 attribution의 값을 가져야합니다. 그리고 이러한 조건이 만족된다면, sensitivity 조건을 만족하게 됩니다.&lt;/p&gt;

&lt;h4 id=&quot;gradients는-sensitivity를-충족하지-못합니다&quot;&gt;Gradients는 sensitivity를 충족하지 못합니다.&lt;/h4&gt;

&lt;p&gt;gradient는 model coefficient를 쉽게 알 수 있는 방법입니다. backpropagation을 통해서 작업하게 되면, 쉽게 input의 gradient값을 구할 수 있습니다. 하지만, sensitivity 하지 않다는 단점을 가집니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-05-05-Integrated-gradient-정리글/gradient.png&quot; alt=&quot;&quot; title=&quot;gradient&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위와 같은 함수가 있다고 가정해보겠습니다.  baseline $x=0$이 주어졌을때, input $x=2$의 gradient를 구해보겠습니다.  $x=2 $에서 함수는 평평하므로 gradient값은 0이 됩니다. 하지만, baseline을 고려해보면, 함수값의 차이는 1이 되므로, attribution은 non-zero여야 합니다.&lt;/p&gt;

&lt;h3 id=&quot;impementation-invariance이란&quot;&gt;Impementation Invariance이란?&lt;/h3&gt;

&lt;p&gt;서로 다른 network이지만 같은 input ~ output 관계를 가진다면, 두 network는 동일한 attribution을 가져야 합니다. 이러한 특성을 implementation invariance라고 합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-05-05-Integrated-gradient-정리글/implementation_invariance.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;gradient는 sensitivity하지는 않지만, chain rule이 성립하기 때문에, implementation invariant하다는 장점을 가지고 있습니다.  수식으로 살펴보겠습니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;model output: $f$&lt;/li&gt;
  &lt;li&gt;model input: $g$&lt;/li&gt;
  &lt;li&gt;network: $h$&lt;/li&gt;
&lt;/ul&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;⋅&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\frac{\partial f}{\partial g} = \frac{\partial f}{\partial h} \cdot \frac{\partial h}{\partial g}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.25188em;vertical-align:-0.8804400000000001em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.3714399999999998em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8804400000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.0574399999999997em;vertical-align:-0.686em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.3714399999999998em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.686em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;⋅&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.25188em;vertical-align:-0.8804400000000001em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.37144em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8804400000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;하지만, LRP 혹은 DeepLIFT와 같은 방법론은 chain rule이 성립하지 않습니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo mathvariant=&quot;normal&quot;&gt;≠&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;⋅&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt; for all &lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\frac{f(x_1) - f(x_0)}{g(x_1) - g(x_0)} \ne \frac{f(x_1) - f(x_0)}{h(x_1) - h(x_0)} \cdot \frac{h(x_1) - h(x_0)}{g(x_1) - g(x_0)} \text{   for all  } x_1, x_0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.363em;vertical-align:-0.936em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.936em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;&lt;span class=&quot;mrel&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;rlap&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;inner&quot;&gt;&lt;span class=&quot;mrel&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;fix&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.19444em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.363em;vertical-align:-0.936em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.936em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;⋅&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.363em;vertical-align:-0.936em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.936em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot;&gt;&lt;span class=&quot;mord&quot;&gt; for all &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;아래의 이미지는 이를 실험한 결과입니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-05-05-Integrated-gradient-정리글/figure7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위의 이미지에서 integrated gradient를 제외한 나머지 discreted gradient를 사용한 모델은 implementation에 따라서 attribution의 값이 달라진 것을 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;만약, implementation에 따라서 attribution이 달라진다면, input-output관계가 아닌 것에 영향을 받는 것입니다. 동일한 input-output 관계를 가진 두 모델이 서로 다른 attribution을 보여준다면, 신뢰도 있는 해석은 기대하기 힘듭니다.&lt;/p&gt;

&lt;h2 id=&quot;integrated-gradients를-소개합니다&quot;&gt;Integrated Gradients를 소개합니다.&lt;/h2&gt;

&lt;p&gt;위에서 gradient가 implementation invariant하지만 sensitivity의 속성은 충족시키지 못하는 것을 살펴봤습니다.  integrated gradient는 이러한 한계를 극복하면서 implementation invariance를 유지하는 방법입니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-05-05-Integrated-gradient-정리글/integrated_gradient.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;직관적으로 살펴보면, integrated gradient는 baseline에서 input까지의 모든 gradient를 고려하는 방법입니다. 결과적으로 각 path의 gradient를 모두 고려하므로 특정 지점에서 gradient값이 0이 되는 이슈를 해결할 수 있으면서, gradient를 활용하므로 implementation invariance합니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;ˊ&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;×&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;∫&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;ˊ&lt;/mo&gt;&lt;/mover&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;ˊ&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;IntegratedGrads_i(x) = (x_i - \acute{x}_i) \times \int_{\alpha=0}^1 \frac{\partial F(\acute{x} + \alpha(x-\acute{x}) )}{\partial x_i} d\alpha&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;ˊ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;×&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.4759580000000003em;vertical-align:-0.9119499999999999em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol large-op&quot; style=&quot;margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;&quot;&gt;∫&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.5640080000000003em;&quot;&gt;&lt;span style=&quot;top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.8129000000000004em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9119499999999999em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.3139999999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;ˊ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;ˊ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8360000000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;h3 id=&quot;integrated-gradients여야-하는-이유&quot;&gt;Integrated Gradients여야 하는 이유&lt;/h3&gt;

&lt;p&gt;이미지 인식에서 attribution method를 평가하는 방법으로 다음과 같은 방법이 있습니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Attribution score가 높은 pixel을 제거해나가면서, 성능의 저하를 확인합니다.&lt;/li&gt;
  &lt;li&gt;좋은 attribution 방법이라면, model score가 급격히 떨어질 것으로 기대합니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;하지만, 이런 방법은 문제가 있습니다. pixel을 제거한 이미지의 성능저하가 attribution이 좋아서 그런 것인지 아니면 처음 본 이미지 형식이라서 그런지 알 수 없다는 것입니다. 이런 이유로 해당논문은 수치적으로 attribution 방법을 증명하기 보다는 sensitivity와 implementation invariance의 특성을 만족하는 것으로 integrated gradient의 정당성을 설득합니다.&lt;/p&gt;

&lt;p&gt;이런 문제의식을 바탕으로 해당 연구에서는 두 가지 단계의 논리를 전개합니다.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;path method 소개&lt;/li&gt;
  &lt;li&gt;path method중에서 integrated gradient가 선택된 이유&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;path-methods는-implementation-invariance합니다&quot;&gt;Path Methods는 implementation invariance합니다.&lt;/h3&gt;

&lt;p&gt;모든 path integrated gradient는 &lt;strong&gt;implementation invariance&lt;/strong&gt; 성질을 만족합니다. 또한 path integrated gradient만이 sensitivity와 implementation invariance를 모두 만족할 수 있다고 주장합니다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Theorem 1 (Friedman, 2004))&lt;/p&gt;

  &lt;p&gt;Path methods are the only attribution methods that always satisfy
Implementation Invariance, Sensitivity, Linearity, and Completeness.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;integrated gradient는 baseline과 input사이의 직선 상에 존재하는 feature들의 gradient값을 모으는 방법입니다. 하지만, 아래의 그림처럼 baseline과 input사이의 path는 직선 뿐만 아니라 비선형적인 path도 있습니다. 이렇게 다른 path들은 서로 다른 attribution 방법이 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-05-05-Integrated-gradient-정리글/figure1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;path integrated gradient는 직선 path 뿐만 아니라 general path에 대해서 다룹니다. 수식을 통해서 정리해보겠습니다.&lt;/p&gt;

&lt;p&gt;$\gamma$는 path를 정의하는 함수 입니다. $\gamma(0)$은 baseline을 의미하고, $\gamma(1)$은 input을 의미합니다. 데이터의 차원은 n이고 $\gamma_i$는 i 차원의 path를 의미합니다. $(\gamma_1, \cdots, \gamma_n)$ 이 모여서 데이터의 path를 정의합니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$\gamma = (\gamma_1, \cdots, \gamma_n) : [0, 1] \rightarrow R^n$&lt;/li&gt;
  &lt;li&gt;$\gamma(0) = \acute{x}$&lt;/li&gt;
  &lt;li&gt;$\gamma(1) = x$&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;$\gamma$의 path integrated gradient는 아래와 정리할 수 있습니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;∫&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;PathIntegratedGrads_i^\gamma(x) = \int_{\alpha=0}^1 \frac{\partial F(\gamma(\alpha))}{\partial \gamma_i(\alpha)} \frac{\partial \gamma_i(\alpha)}{\partial \alpha} d\alpha&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.059164em;vertical-align:-0.276864em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7822999999999999em;&quot;&gt;&lt;span style=&quot;top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.180908em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05556em;&quot;&gt;γ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.276864em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.5000080000000002em;vertical-align:-0.936em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol large-op&quot; style=&quot;margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;&quot;&gt;∫&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.5640080000000003em;&quot;&gt;&lt;span style=&quot;top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.8129000000000004em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9119499999999999em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05556em;&quot;&gt;γ&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05556em;&quot;&gt;γ&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.936em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05556em;&quot;&gt;γ&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.686em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;덧붙여서, 세션 제목에서 언급한 path method라는 표현은 path integrated gradient를 의미합니다.&lt;/p&gt;

&lt;h3 id=&quot;많은-path-method중에서-integrated-gradients-symmetry-preserving&quot;&gt;많은 Path method중에서 Integrated Gradients: Symmetry-Preserving&lt;/h3&gt;

&lt;p&gt;$x, y$가 함수 $F$에 대해서 대칭이라면, 다음과 같이 나타낼 수 있습니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F(x, y) = F(y, x)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;attribution method는 다음과 같은 조건이 지켜지면 symmetry preserving하다고 표현합니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;input: symmetric variable이 모두 동일한 값을 가진다.&lt;/li&gt;
  &lt;li&gt;baseline: symmetric variable이 모두 동일한 값을 가진다.&lt;/li&gt;
  &lt;li&gt;각 symmetry variable은 모두 같은 attribution을 가져야한다.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;다음과 같은 예시를 통해서 이해해보겠습니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mo&gt;⋯&lt;/mo&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;Sigmoid(x1 + x2, \cdots)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05764em;&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;⋯&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;$x_1, x_2$는 symmetric variable이고 input에서는 $x_1=x_2=1$ 이며, basline에서는 $x_1=x_2=0$입니다. symmetry preserving하다면, $x_1, x_2$에 모두 동일한 attribution 값이 나와야합니다.&lt;/p&gt;

&lt;p&gt;그리고, integrated gradient는 이러한 조건을 만족합니다. integrated gradient 하에서는 path가 선형적이기 때문에, 동일한 값을 가지는 $x_1, x_2$는 동일한 attribution을 가지게 됩니다.&lt;/p&gt;

&lt;p&gt;하지만, path가 비선형적이라면 이는 성립하지 않습니다.  아래의 수식의 $\frac{\partial \gamma_i(\alpha)}{\partial \alpha}$ 부분을 고려해보면 알 수 있습니다.  integrated gradient의 경우 선형적이기때문에 이 값이 상수값이며 모든 dimension에서 동일합니다. 하지만 비선형적인 path를 가진다면 이 값은 dimension마다 다른 값을 가지게 될 것입니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;∫&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;PathIntegratedGrads_i^\gamma(x) = \int_{\alpha=0}^1 \frac{\partial F(\gamma(\alpha))}{\partial \gamma_i(\alpha)} \frac{\partial \gamma_i(\alpha)}{\partial \alpha} d\alpha&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.059164em;vertical-align:-0.276864em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7822999999999999em;&quot;&gt;&lt;span style=&quot;top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.180908em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05556em;&quot;&gt;γ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.276864em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.5000080000000002em;vertical-align:-0.936em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol large-op&quot; style=&quot;margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;&quot;&gt;∫&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.5640080000000003em;&quot;&gt;&lt;span style=&quot;top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.8129000000000004em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9119499999999999em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05556em;&quot;&gt;γ&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05556em;&quot;&gt;γ&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.936em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05556em;&quot;&gt;γ&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.686em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;아래의 증명은 non-straightline은 symmetry preserving하지 않다는 것을 반례를 통해서 보여주고 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-05-05-Integrated-gradient-정리글/proof1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;integrated-gradient의-기타-특징들&quot;&gt;integrated gradient의 기타 특징들&lt;/h3&gt;

&lt;h4 id=&quot;completeness란&quot;&gt;Completeness란?&lt;/h4&gt;

&lt;p&gt;integrated gradient는 completeness라는 재밌는 특성을 가집니다.  integrated gradient로 나오는 attribution들을 모두 더하면, 결국은 두 모델의 예측값의 차이가 됩니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;ˊ&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\sum_{i=1}^n IntegratedGrads_i(x) = F(x) - F(\acute{x})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.929066em;vertical-align:-1.277669em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.6513970000000002em;&quot;&gt;&lt;span style=&quot;top:-1.872331em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.050005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop op-symbol large-op&quot;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.3000050000000005em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.277669em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;ˊ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;참고로, Completness는 sensitivity를 내포하고 있습니다. Completeness는 함수값의 차이는 attribution의 합이어야 합니다. sensitivity는 한 feature가 예측값의 차이를 발생시켰다면 해당 attribution은 non-zero어야합니다.&lt;/p&gt;

&lt;h4 id=&quot;linearity란&quot;&gt;Linearity란?&lt;/h4&gt;

&lt;p&gt;$f_1, f_2$ 의 두 모델이 있다고 가정해보겠습니다. 그리고 이를 바탕으로 $f_3 = a \times f_1 + b \times f_2$를 만들었습니다. $f_3$에 대해서 attribution을 구하면, f1과 $f_2$의 attribution에서 각각 $a, b$만큼의 가중치를 부여해서 구할 수 있는 속성입니다.&lt;/p&gt;

&lt;h2 id=&quot;실제로-integrated-gradients-구하기&quot;&gt;실제로 Integrated Gradients 구하기&lt;/h2&gt;

&lt;p&gt;실제로 적용단계에서 integral gradient를 수식대로 구하는 것은 매우 높은 비용을 치루거나 불가능합니다. 따라서 아래와 같은 근사하는 방법을 사용합니다.  직관적으로는 gradient를 구하는 경로를 m등분하여 각 gradient의 평균값을 구하는 것입니다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;ˊ&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;×&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msubsup&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;ˊ&lt;/mo&gt;&lt;/mover&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;×&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;ˊ&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;×&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;IntegratedGrads_i^{approx}(x) = (x_i - \acute{x_i}) \times \sum_{k=1}^m \frac{\partial F(\acute{x} + \frac{k}{m} \times (x-\acute{x}) )}{\partial x_i} \times \frac{1}{m}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.059164em;vertical-align:-0.276864em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7823em;&quot;&gt;&lt;span style=&quot;top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.1809080000000005em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.276864em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;ˊ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;×&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.61192em;vertical-align:-0.44509999999999994em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol small-op&quot; style=&quot;position:relative;top:-0.0000050000000000050004em;&quot;&gt;∑&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.804292em;&quot;&gt;&lt;span style=&quot;top:-2.40029em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.2029em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.29971000000000003em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.16682em;&quot;&gt;&lt;span style=&quot;top:-2.655em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3280857142857143em;&quot;&gt;&lt;span style=&quot;top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.143em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.5508em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord accent mtight&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-2.7em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.7em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;&lt;span class=&quot;mtight&quot;&gt;ˊ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mopen nulldelimiter sizing reset-size3 size6&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8800285714285714em;&quot;&gt;&lt;span style=&quot;top:-2.656em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.2255000000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line mtight&quot; style=&quot;border-bottom-width:0.049em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.384em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.344em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter sizing reset-size3 size6&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;×&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mord accent mtight&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-2.7em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.7em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;&lt;span class=&quot;mtight&quot;&gt;ˊ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.44509999999999994em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;×&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.190108em;vertical-align:-0.345em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.845108em;&quot;&gt;&lt;span style=&quot;top:-2.6550000000000002em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.394em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.345em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$m$: the number of steps in the Riemman approximation&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;마무리-하며&quot;&gt;마무리 하며…&lt;/h2&gt;

&lt;p&gt;이번 글에서는 Attribution method가 갖춰야할 주요한 조건들과 integrated gradient라는 기법에 대해서 알아보았습니다. 추후에 이어질 포스팅에서는 다양한 XAI기법들에 대해서 다룰 예정입니다.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;[1] Mukund Sundararajan, Axiomatic Attribution for Deep Networks, ICML, 2017&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">Integrated Gradient 정리글</summary></entry><entry><title type="html">RAPP: NOVELTY DETECTION WITH RECONSTRUCTION ALONG PROJECTION PATHWAY 정리글</title><link href="https://fastpages.fast.ai/blog/2020/04/02/RaPP.html" rel="alternate" type="text/html" title="RAPP: NOVELTY DETECTION WITH RECONSTRUCTION ALONG PROJECTION PATHWAY 정리글" /><published>2020-04-02T00:00:00-05:00</published><updated>2020-04-02T00:00:00-05:00</updated><id>https://fastpages.fast.ai/blog/2020/04/02/RaPP</id><content type="html" xml:base="https://fastpages.fast.ai/blog/2020/04/02/RaPP.html">&lt;h1 id=&quot;rapp-novelty-detection-with-reconstruction-along-projection-pathway--정리글&quot;&gt;RAPP: NOVELTY DETECTION WITH RECONSTRUCTION ALONG PROJECTION PATHWAY  정리글&lt;/h1&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract&lt;/h2&gt;

&lt;p&gt;autoencoder를 활용하여 anomaly detection을 수행하는 시도들이 있다. 하지만, 이러한 방법론은 주로 input과 reconstruct된 output간의 차이에 집중하고, hidden space간의 관계에 대해서는 고려하지 않는다는 한계를 가지고 있다. 본 연구에서는 autoencoder 구조를 바탕으로 input space와 output간의 관계뿐만 아니라, hidden space간의 관계를 고려하는 방법을 제안한다. (encoder hidden space와 대응되는 decoder hidden space와 비교) 또한,  reconstructed된 output을 다시 동일한 autoencoder에 넣어서 발생되는 activation value가 original input을 동일한 모델에 넣었을때의 대응되는 decoder activation value와 동일하다는 것을 보였다.&lt;/p&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;아쉽게도 encoder hidden space와 대응되는 decoder hidden space를 비교하는 것은 불가능하다. &lt;strong&gt;왜냐하면, 학습이 진행되는 동안은 모델이 불안정하며 encoder-decoder layer pair가 대응된다고 볼 수 없기 때문이다.&lt;/strong&gt;  하지만 reconstructed된 output을 다시 동일한 autoencoder에 넣어서 발생되는 activation value가 original input을 동일한 모델에 넣었을때의 대응되는 decoder activation value와 동일하다는 것을 보임으로써 문제를 해결할 수 있었다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Contributions&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;hidden space도 함께 활용한 방법론&lt;/li&gt;
  &lt;li&gt;RaPP의 motivation 소개 및 증명&lt;/li&gt;
  &lt;li&gt;RaPP의 성능 증명&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;proposed-method-rapp&quot;&gt;Proposed Method RaPP&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-04-02-RaPP/img1.png&quot; alt=&quot;&quot; title=&quot;hidden space&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위의 이미지 처럼 encoder와 decoder간의 hidden space를  비교하는 것이 목표이지만, 위에서 언급한 한계때문에 불가능하다.  그래서 새롭게 제안하는 방법은 reconstruction output을 다시 autoencoder에 넣어서 decoder의 hidden space들을 재현하는 것이다.&lt;/p&gt;

&lt;h3 id=&quot;reconstruction-based-novelty-detection&quot;&gt;Reconstruction Based Novelty Detection&lt;/h3&gt;

&lt;p&gt;autoencoder $A$ 는 unsupervised 방법을 바탕으로 의미있는 representation을 만들어내며, 아래는 사용되는 objective이다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;ϵ&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;      whrere A = f(g(x)) &lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\epsilon = \mid \mid x - A(x) \mid \mid _2 \ \ \ \ \ \ \text{whrere A = f(g(x)) }&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;ϵ&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.66666em;vertical-align:-0.08333em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot;&gt;&lt;span class=&quot;mord&quot;&gt;whrere A = f(g(x)) &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
또한, $\epsilon(x)$가 높다면, anomaly일 가능성이 높아진다고 해석할 수 있다. 하지만, 모델의 구조가 깊어질수록 hierarchical information을 활용하지 못하는 점에서 아쉬움이 남는다. 딥러닝 모델의 모든 layer를 충분히 활용하려면 결국 hidden space를 잘 활용할 필요가 있다.&lt;/p&gt;

&lt;h3 id=&quot;reconstruction-error-in-hidden-spaces&quot;&gt;Reconstruction Error In Hidden Spaces&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-04-02-RaPP/figure1_a.png&quot; alt=&quot;&quot; title=&quot;Figure1 (a)&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위에 보이는 이미지처럼, $h_i(x), \hat{h}_i(x)$를 각각 구한다.&lt;/p&gt;

&lt;p&gt;다음과 같은 encoder를 정의하면 위의 과정을 전개할 수 있다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;∘&lt;/mo&gt;&lt;mo&gt;⋯&lt;/mo&gt;&lt;mo&gt;∘&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;g_{:i} = g_i \circ \cdots \circ g1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.625em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mrel mtight&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.63889em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∘&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.44445em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;⋯&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∘&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8388800000000001em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mspace linebreak=&quot;newline&quot;&gt;&lt;/mspace&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;   where A is autoencoder&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;h_i(x) = g_{:i} \\
\hat{h_i(x)} = g_{:i}(\hat{x}) = g_{:i}(A(x)) \ \ \ \text{where A is autoencoder}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.625em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mrel mtight&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace newline&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.26344em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.01344em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.319em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.25em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mrel mtight&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.22222em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mrel mtight&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mord text&quot;&gt;&lt;span class=&quot;mord&quot;&gt;where A is autoencoder&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;그리고 위와 같은 hidden space value들을 decoder hidden space의 수 만큼 모아준다. 
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;≤&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;≤&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;H(x) = \{ (h_i(x), \hat{h}_i(x)) : i \le i \le l \}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.08125em;&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.2078799999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9578799999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.26344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.79549em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≤&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.79549em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≤&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
$H(x)$를 활용해서 novelty score를 얻기 위해 다음과 같은 과정을 진행한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-04-02-RaPP/algorithm1.png&quot; alt=&quot;&quot; title=&quot;Algorithm1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;여기서 $S$ 는 novelty score를 측정하는 함수로 본 연구에서는 크게 두 가지 방향을 제시한다.&lt;/p&gt;

&lt;h3 id=&quot;simple-aggregation-along-pathwaysap&quot;&gt;Simple Aggregation Along Pathway(SAP)&lt;/h3&gt;

&lt;p&gt;두 hidden space간의 Euclidean distance를 구한다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/munderover&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;S_{SAP}(x) = \sum_{i=0}^l  \mid \mid h_i(x) - \hat{h}_i(x) \mid \mid_2^2 = \mid \mid h(x) - \hat{h}_i(x) \mid \mid _x^2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05764em;&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.32833099999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05764em;&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:3.1137820000000005em;vertical-align:-1.277669em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.8361130000000003em;&quot;&gt;&lt;span style=&quot;top:-1.872331em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.050005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop op-symbol large-op&quot;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.3000050000000005em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.277669em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.2078799999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9578799999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.26344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1141079999999999em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8641079999999999em;&quot;&gt;&lt;span style=&quot;top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.247em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.36687em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.2078799999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9578799999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.26344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1141079999999999em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8641079999999999em;&quot;&gt;&lt;span style=&quot;top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.247em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;h3 id=&quot;normalized-aggregation-along-pathwaynap&quot;&gt;Normalized Aggregation Along Pathway(NAP)&lt;/h3&gt;

&lt;p&gt;위의 SAP 방법은 각 hidden space간의 특성은 고려하지 못한다. 각 pair마다 distance distribution이 다르게 나타날 수 있는데 이러한 문제를 해결하기 위해서 orthogonalization과 scaling을 통한 normalization 방법을 제안한다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;∣&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;S_{NAP}(x) = \mid \mid d(x) - uX)^T V\Sigma^{-1} \mid \mid_2^2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05764em;&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.32833099999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.10903em;&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1413309999999999em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8913309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.22222em;&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;Σ&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.864108em;&quot;&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1141079999999999em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;&lt;span class=&quot;mrel&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8641079999999999em;&quot;&gt;&lt;span style=&quot;top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.247em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;ul&gt;
  &lt;li&gt;$d(x) = h(x) - \hat{h}(x)$&lt;/li&gt;
  &lt;li&gt;$D$ 는 matrix이며 각 row i는 data point $x_i$가 가지고 있는 pair들의 distance들로 이루어져있다.&lt;/li&gt;
  &lt;li&gt;$\bar{D}  $는 $D$의 column wise centered matrix 이다.&lt;/li&gt;
  &lt;li&gt;normalization을 위해서 SVD를 수행한다. $\bar{D} = U \Sigma V^T$&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;motivation-of-rapp&quot;&gt;Motivation Of RAPP&lt;/h2&gt;

&lt;p&gt;‘hidden space정보를 활용할 수 있지 않을까’라는 동기에서 연구가 출발했다. 하지만, 이런 문제의식을 가지더라도 해결해야될 이슈가 있다. 대응하는 encoder decoder의 layer pair가 서로 같은 space를 표현한다고 할 수 없다. &lt;strong&gt;왜냐하면, autoencoder의 objective는 각 layer에 들어오는 input에 대해서 어떤 제약도 하지 않기 때문이다. 결과적으로 $f_{l:i+1}(g(x)) = g_{:i}(x)$과 같은 관계가 성립한다고 볼 수 없다.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;그럼에도 불구하고, $\hat{h}&lt;em&gt;i(x) = g&lt;/em&gt;(A(x))$의 관계를 바탕으로, 위의 문제의식을 실현할 수 있었다. 전반적인 프로세스는 아래의 Figure1 (b)를 확인하면 알 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-04-02-RaPP/figure1_b.png&quot; alt=&quot;&quot; title=&quot;Figure1 (b)&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;computation-of-hidden-reconstruction&quot;&gt;Computation Of Hidden Reconstruction&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;$A = f \circ g$은 학습된 autoencoder라고 가정한다.&lt;/li&gt;
  &lt;li&gt;$M_0 = { A(x):  x \in R^n }$은 reconstruction된 output 집합이다.
    &lt;ul&gt;
      &lt;li&gt;$A$는 다음과 같이 표현된다. $ x\in M_0, x= A(x)$&lt;/li&gt;
      &lt;li&gt;해석하자면, reconstruction된 결과를 다시 autoencoder에 넣으면 input으로 넣은 reconstruction과 동일하다는 것이다.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;$M_i = { g_{:i(x)}: x \in M_0 }$&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-04-02-RaPP/M.png&quot; alt=&quot;&quot; title=&quot;M&quot; /&gt;&lt;/p&gt;

&lt;p&gt;다음과 같은 decoder $\tilde{f}$ 가 있다고 가정하자.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∀&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot;&gt;&lt;/mspace&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∀&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;∘&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\forall x \in M_l, \tilde{f}(x) = f(x)\\  
\forall a \in M_i, a = (g_i \circ \tilde{f})(a)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.73354em;vertical-align:-0.0391em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∀&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1812999999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9312999999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.61344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.08332999999999999em;&quot;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.19444em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace newline&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.73354em;vertical-align:-0.0391em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∀&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8777699999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∘&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1812999999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9312999999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.61344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.08332999999999999em;&quot;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.19444em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;첫 번째 조건 $x \in M_l, \tilde{f}(x) = f(x)\ $은 feed foward의 결과가 같다는 것을 의미한다.&lt;/p&gt;

&lt;p&gt;두 번째 조건$a \in M_i, a = (g_i \circ \tilde{f})(a)$은 $\tilde{f}&lt;em&gt;{l:i+1}$과 $g&lt;/em&gt;{i+1:}$이 서로 적합한 encoder decoder의 pair로 만들어준다. 즉 서로 inverse의 관계를 가진다.  따라서 다음과 같은 수식 전개가 가능하다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;msup&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo mathvariant=&quot;normal&quot; lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;/msup&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;∘&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\hat{h^{&amp;#x27;}}_i = (\tilde{f}_{l:i+1} \circ g_{i+1:})(h_i(x))&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1804199999999998em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.03042em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.76698em;&quot;&gt;&lt;span style=&quot;top:-2.789em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.6828285714285715em;&quot;&gt;&lt;span style=&quot;top:-2.786em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.33598em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1812999999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9312999999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.61344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.08332999999999999em;&quot;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.19444em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3361079999999999em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.208331em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∘&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.311664em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.208331em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
이는 Figure1 (b)를 보면, 어떤 의미인지 알 수 있다. 간략히 설명하면, decoder 부분의 hidden space다.&lt;/p&gt;

&lt;p&gt;그리고 다음과 같은 과정을 통해서 $\hat{h^{‘}}_i(x) = \hat{h}_i(x)$임을 증명할 수 있다.
&lt;span class=&quot;katex-error&quot; title=&quot;ParseError: KaTeX parse error: No such environment: split at position 23: …aligned}
\begin{̲s̲p̲l̲i̲t̲}̲
\hat{h^{&amp;#x27;}}_i(…&quot; style=&quot;color:#cc0000&quot;&gt;\begin{aligned}
\begin{split}
\hat{h^{&amp;#x27;}}_i(x) = (\tilde{f}_{l:i+1} \circ g_{i+1:})(h_i(x))
&amp;amp;= (\tilde{f}_{l:i+1} \circ g)(x) \\
&amp;amp;= (g_{:i} \circ \tilde{f} \circ g)(x) \\
&amp;amp;= (g_{:i} \circ A)(x) = h_i(\hat{x}) = \hat{h}_i(x)
\end{split}
\end{aligned}&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;주목할 점은 $\hat{h^{‘}}_i$을 얻기 뒤해서 $\tilde{f}_i$가 필요하지 않다는 것이다. 그리고 $x \in M_0$에 대해서는 다음과 같은 관계도 성립한다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;msup&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo mathvariant=&quot;normal&quot; lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;/msup&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mstyle mathcolor=&quot;#cc0000&quot;&gt;&lt;mtext&gt;\mbox&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;≤&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;≤&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;h_i(x) = \hat{h}_i(x) = \hat{h^{&amp;#x27;}}_i(x), \mbox{    for every   } 1  \le i \le l&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.2078799999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9578799999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.26344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.28042em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.03042em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.76698em;&quot;&gt;&lt;span style=&quot;top:-2.789em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.6828285714285715em;&quot;&gt;&lt;span style=&quot;top:-2.786em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.33598em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot; style=&quot;color:#cc0000;&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;color:#cc0000;&quot;&gt;\mbox&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≤&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.79549em;vertical-align:-0.13597em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≤&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;h3 id=&quot;existence-of-f_tilde&quot;&gt;Existence of f_tilde&lt;/h3&gt;

&lt;p&gt;전제조건은 다음과 같다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$x = A(x) \text{   for } x \in M_0$&lt;/li&gt;
  &lt;li&gt;$g_i(x: x \in M_{i-1}) = \hat{x}: \hat{x} \in M_i$&lt;/li&gt;
  &lt;li&gt;$f_i(x: x \in M_{i-1}) = \hat{x}: \hat{x} \in M_i$&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;여기에 다음과 같이 정의해보자.&lt;/p&gt;

&lt;p&gt;$\tilde{f}_i =g_i^{-1} \text{    for  } M_i$이라면, 이런관계가 성립한다.   $\tilde{f} = g^{-1}$
해석하면, 각 encoder decoder layer pair에 대해서 inverse 관계가 성립하게 되면, encoder decoder에 대해서도 inverse 관계가 성립하게 된다.&lt;/p&gt;

&lt;p&gt;이런 정의는 아래와 같은 조건을 충족시킨다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mo&gt;∘&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt; for &lt;/mtext&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;x = (\tilde{f} \circ g)(x) \text{   for  } x \in M_0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1812999999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9312999999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.61344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.08332999999999999em;&quot;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.19444em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;∘&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord text&quot;&gt;&lt;span class=&quot;mord&quot;&gt; for &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;$x = A(x)$ 라는 전제조건을 생각해보면,&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mtext&gt; on &lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\tilde{f} = f \text{ on } M_l&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1257399999999997em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9312999999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.61344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.08332999999999999em;&quot;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.19444em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord text&quot;&gt;&lt;span class=&quot;mord&quot;&gt; on &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;h3 id=&quot;existence-of-f_tilde-with-neural-networks&quot;&gt;Existence of f_tilde With Neural Networks&lt;/h3&gt;

&lt;p&gt;neural network는 유연한 구조를 가졌기때문에, 특정 함수를 쉽게 근사할 수 있다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;reference: 마키나락스&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">RAPP: NOVELTY DETECTION WITH RECONSTRUCTION ALONG PROJECTION PATHWAY 정리글</summary></entry><entry><title type="html">Variational Autoencoder based Anomaly Dection using Reconstruction Probability</title><link href="https://fastpages.fast.ai/blog/2020/03/30/anomaly-detection-by-VAE.html" rel="alternate" type="text/html" title="Variational Autoencoder based Anomaly Dection using Reconstruction Probability" /><published>2020-03-30T00:00:00-05:00</published><updated>2020-03-30T00:00:00-05:00</updated><id>https://fastpages.fast.ai/blog/2020/03/30/anomaly-detection-by-VAE</id><content type="html" xml:base="https://fastpages.fast.ai/blog/2020/03/30/anomaly-detection-by-VAE.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-30-anomaly-detection-by-VAE.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Backgraound&quot;&gt;Backgraound&lt;a class=&quot;anchor-link&quot; href=&quot;#Backgraound&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h3 id=&quot;Anomaly-deteciton&quot;&gt;Anomaly deteciton&lt;a class=&quot;anchor-link&quot; href=&quot;#Anomaly-deteciton&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;anomaly detection 방법은 다음과 같은 3가지 관점으로 분류할 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;statistical&lt;/li&gt;
&lt;li&gt;proximity&lt;/li&gt;
&lt;li&gt;deviation&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;statistical관점&lt;/strong&gt;은 data가 특정 분포를 따른다고 가정한다. 예를 들어, parametric model인 Gaussian Mixture Model이나 nonparametric model인 kernel density estimation은 이런 분포를 정의하는데 사용될 수 있다. 만약 특정 data point가 가정한 분포에서 낮은 확률을 가진다면, anomaly라고 정의할 수 있다. probability를 기반으로 anomaly를 정의할 수 있다는 장점을 가지고 있다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;proximity&lt;/strong&gt;관점은 anomaly data가 다른 데이터와 고립되어 있다고 가정한다. 이 관점은 크게 세가지 방법을 가지고 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;clustering&lt;/p&gt;
&lt;p&gt;cluster의 크기나 centroid의 거리를 가지고 anomaly를 결정한다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;density&lt;/p&gt;
&lt;p&gt;특정 위치의 data가 밀집된 정도가 낮다면, anomaly로 정의할 수 있다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;distance&lt;/p&gt;
&lt;p&gt;neighbor와의 거리가 멀다면, anomaly로 정의할 수 있다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;deviation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;reconstruction error를 바탕으로 anomaly를 정의할 수 있다. 이를 위해서는 우선, dimension reduction방법을 통해 압축된 정보를 바탕으로 reconstruct해야한다. 그리고 실제 데이터와의 차이를 reconstruction error로 정의한다. 만약 reconstruction error가 특정 수준보다 높다면, anomaly라고 정의한다.&lt;/p&gt;
&lt;h3 id=&quot;Autoencoder-and-anomaly-detection&quot;&gt;Autoencoder and anomaly detection&lt;a class=&quot;anchor-link&quot; href=&quot;#Autoencoder-and-anomaly-detection&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://lilianweng.github.io/lil-log/assets/images/autoencoder-architecture.png&quot; alt=&quot;&quot; title=&quot;Autoencoder&quot; /&gt;&lt;/p&gt;
&lt;p&gt;autoencoder의 objective는 아래와 같다.&lt;/p&gt;
$$
L_\text{AE}(\theta, \phi) = \frac{1}{n}\sum_{i=1}^n (\mathbf{x}^{(i)} - f_\theta(g_\phi(\mathbf{x}^{(i)})))^2
$$&lt;p&gt;autoencoder를 활용하여, anomaly detection을 수행하면, 
reconstruction error $ \mid \mid \mathbf{x}^{(i)} - f_\theta(g_\phi(\mathbf{x}^{(i)})) \mid \mid$를 anomaly를 판별하는데 사용한다.&lt;/p&gt;
&lt;h3 id=&quot;Variational-Autoencoder&quot;&gt;Variational Autoencoder&lt;a class=&quot;anchor-link&quot; href=&quot;#Variational-Autoencoder&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;variation Autoencoder는 다음 링크에서 자세히 확인 할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://rroundtable.github.io/FastPages/vae/deeplearning/2020/03/25/VAE.html&quot;&gt;https://rroundtable.github.io/FastPages/vae/deeplearning/2020/03/25/VAE.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;autoencoder와의 다른 점은 autoencoder는 input variable자체를 압축하고 복원하는 과정을 거치지만, VAE는 복원하는 것이 input variable로 부터 만들어진 paramters(mean, var)를 바탕으로 복원한다.&lt;/p&gt;
&lt;h2 id=&quot;Proposed-Method&quot;&gt;Proposed Method&lt;a class=&quot;anchor-link&quot; href=&quot;#Proposed-Method&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h3 id=&quot;Algorithm&quot;&gt;Algorithm&lt;a class=&quot;anchor-link&quot; href=&quot;#Algorithm&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Monte-Carlo estimate를 통해서 $\mathbb{E}_{q_{\phi (x \mid z)} [\log p_{\theta}(x \mid z)]}$를 근사할 수 있다.&lt;/p&gt;
&lt;p&gt;한 데이터 포인트의 reconstruction probability는 다음과 같다.&lt;/p&gt;
$$
\frac{1}{L} \sum_{l=1}^L p_{\theta}(x^{(i)} \mid u_{\hat{x}^{(i, l)}}, \sigma_{\hat{x}^{(i, l)}})
$$&lt;h3 id=&quot;Reconstruction-Probability&quot;&gt;Reconstruction Probability&lt;a class=&quot;anchor-link&quot; href=&quot;#Reconstruction-Probability&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;VAE는 복원하는 것이 input variable로 부터 만들어진 paramters(mean, var)를 바탕으로 복원한다. 이 mean과 var로 만들어진 분포는 확률분포로 해석할 수 있다.&lt;/p&gt;
&lt;p&gt;또한, mean값 뿐만 아니라 variance도 함께 고려한다는 점도 중요하다.&lt;/p&gt;
&lt;h3 id=&quot;Difference-from-an-autoencoder-based-anomaly-detection&quot;&gt;Difference from an autoencoder based anomaly detection&lt;a class=&quot;anchor-link&quot; href=&quot;#Difference-from-an-autoencoder-based-anomaly-detection&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;첫 번째 차이점은 VAE의 latent variable이 stochastic variable이라는 것이다.(latent variable이 복원해야하는 대상이 아니고 복원에 필요한 parameter를 의미한다.) autoencoder의 latent variable은 deterministic하게 정해진다. 이런 차이점이 VAE의 표현능력을 키워준다. 특정 분포에서 sampling하기 때문에, 다양한 variable를 경험할 수 있다. 그리고 anomaly data는 variance가 높아서 reconstructiuon probability가 낮다.&lt;/p&gt;
&lt;p&gt;두 번째 차이점은 VAE의 reconstruction variable 또한 stochastic하다는 것이다. reconstruction probability는 original input과 reconstruction간의 차이와 함께 variance도 고려한다.&lt;/p&gt;
&lt;p&gt;세 번째 차이점은 VAE는 복원정도를 probability 확률로 측정할 수 있다는 것이다. autoencoder는 reconstruction error를 통해서 measure해야하기 때문에, input variable이 heterogeneous하다면 측정하기 힘들다. heterogeneous하다면, 각각 다른 가중치를 곱해줘야 하며, anomaly를 판단하기 위한 threshold를 결정하기도 쉽지 않다.&lt;/p&gt;
&lt;p&gt;반면에, VAE는 heterogeneous한 데이터에도 각각 다른 가중치를 곱할 필요가 없다. 이는 각 heterogeneous한 데이터 마다 variance를 구해주기 때문에 각각의 분포를 정의할 수 있게 되기 때문이다. 또한 1%의 확률은 어떤 데이터에서든 1%의 의미를 가진다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pytorch-&amp;#44396;&amp;#54788;&amp;#52404;&quot;&gt;Pytorch &amp;#44396;&amp;#54788;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#Pytorch-&amp;#44396;&amp;#54788;&amp;#52404;&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/GunhoChoi/PyTorch-FastCampus&quot;&gt;https://github.com/GunhoChoi/PyTorch-FastCampus&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;1)-Import-required-libraries&quot;&gt;1) Import required libraries&lt;a class=&quot;anchor-link&quot; href=&quot;#1)-Import-required-libraries&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.optim&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;optim&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn.init&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;init&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torchvision.datasets&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;dset&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torchvision.transforms&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;transforms&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.autograd&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;2)-Set-hyperparmeters&quot;&gt;2) Set hyperparmeters&lt;a class=&quot;anchor-link&quot; href=&quot;#2)-Set-hyperparmeters&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0005&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hidden_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;3) Download Data&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MNIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;./&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;download&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mnist_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MNIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;./&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;download&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./MNIST/raw/train-images-idx3-ubyte.gz
Extracting ./MNIST/raw/train-images-idx3-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./MNIST/raw/train-labels-idx1-ubyte.gz
Extracting ./MNIST/raw/train-labels-idx1-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./MNIST/raw/t10k-images-idx3-ubyte.gz

Extracting ./MNIST/raw/t10k-images-idx3-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./MNIST/raw/t10k-labels-idx1-ubyte.gz
Extracting ./MNIST/raw/t10k-labels-idx1-ubyte.gz to ./MNIST/raw
Processing...
Done!
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;4)-Set-DataLoader&quot;&gt;4) Set DataLoader&lt;a class=&quot;anchor-link&quot; href=&quot;#4)-Set-DataLoader&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;5)-Model&quot;&gt;5) Model&lt;a class=&quot;anchor-link&quot; href=&quot;#5)-Model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# for mu&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# for logvar&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;log_var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_var&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reparametrize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Transformation for differentiable function&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Return&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            z = mu + std * eps&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;eps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FloatTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;eps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparametrize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigmoid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sigmoid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigmoid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;VAE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VAE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bce&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BCELoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_recon_prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;Not Completed: Ask to someone&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;bce_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparametrize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;recon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;bce_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;bce_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bce_loss&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VAE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/usr/local/lib/python3.6/dist-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction=&amp;#39;sum&amp;#39; instead.
  warnings.warn(warning.format(ret))
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;6)-Loss-function-&amp;amp;-Optimizer&quot;&gt;6) Loss function &amp;amp; Optimizer&lt;a class=&quot;anchor-link&quot; href=&quot;#6)-Loss-function-&amp;amp;-Optimizer&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reconstruction_function&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BCELoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;loss_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recon_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;BCE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reconstruction_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recon_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reconstruction error&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# see Appendix B from VAE paper:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Kingma and Welling. Auto-Encoding Variational Bayes. ICLR, 2014&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# https://arxiv.org/abs/1312.6114&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# 0.5 * sum(1 + log(sigma^2) - mu^2 - sigma^2)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;KLD_element&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mul_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;KLD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KLD_element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mul_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# regularizer term&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BCE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KLD&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/usr/local/lib/python3.6/dist-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction=&amp;#39;sum&amp;#39; instead.
  warnings.warn(warning.format(ret))
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;7)-Train&quot;&gt;7) Train&lt;a class=&quot;anchor-link&quot; href=&quot;#7)-Train&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cum_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;cum_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cum_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train graph&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/usr/local/lib/python3.6/dist-packages/torch/nn/modules/loss.py:498: UserWarning: Using a target size (torch.Size([128, 1, 28, 28])) that is different to the input size (torch.Size([128, 28, 28, 1])) is deprecated. Please ensure they have the same size.
  return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;8)-Make-anomaly-data&quot;&gt;8) Make anomaly data&lt;a class=&quot;anchor-link&quot; href=&quot;#8)-Make-anomaly-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ood1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ood1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ood 1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ood2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ood2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ood 2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAEICAYAAACZA4KlAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0
dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAMIElEQVR4nO3df6zd9V3H8edrUIoCLmVoUwHZjxAj
MRHMDS4ZMRgcMvwB+4eMRKwJsftj6BaXKE4S+UMjMWPTGF1SpKHTDUICCBqiYJ0hJIZQCIMCmyAp
ga7QITFjU0uBt3/cL+xS7u29nB/3nPX9fCQ395zv95x+3z3p856ft59UFZKOfu+Z9QCS1oexS00Y
u9SEsUtNGLvUhLFLTRi71iTJ+5NUkmNnPYtGY+yaiCRXJdmd5GCSm2Y9j97Jn9KalG8Bfwz8EvBD
M55Fy/Ce/SiX5KeS/FuS/07yeJJfW7LvvUm+nOTbSZ5Nck2S9wz7jkny+SQvJXkG+OUjHaeqbq+q
vwf+a7p/I43Ke/ajWJINwD8AO4ALgfOAO5MsVNU3gb8E3gt8EHgfcA+wH7gR+C3gV4BzgO8Bt637
X0AT5T370e3DwInAdVX1alX9K/CPwOVJjgE+AfxBVb1SVXuB64ErhuteBvx5VT1XVS8Df7r+42uS
jP3o9uPAc1X1xpJtzwKnAqcAG4bzh+9767qH7dMPMGM/un0LOP3N5+GDnwD2AS8Bh4AzltkHiw/n
Tz9sn36AGfvR7QHgf4DfS7IhyfnArwK3VNXrwK3AnyQ5KckZwO8Cfzdc91bgd5KclmQTcPWRDpTk
2CTHA8cAxyQ53vfk54uxH8Wq6lUW4/4Yi/fkfw38RlV9Y7jIb7P44tszwP3AV1l8MQ/gBuCfga8D
DwO3r3K4a4D/ZfGHwq8Pp6+Z1N9F44v/eYXUg/fsUhPGLjVh7FITxi41sa5vjRyXjXU8J6znIaVW
/o/v8WodzHL7xoo9yUXAX7D43urfVNV1R7r88ZzAz+WCcQ4p6QgeqF0r7hv5Yfzw2eq/YvE93LNY
/Lz1WaP+eZKma5zn7OcCT1fVM8OHN24BLpnMWJImbZzYT+XtvyjxPN//JYq3JNk2/A8muw9xcIzD
SRrH1F+Nr6rtVbVQVQsb2Djtw0lawTix7+PtvxV1Gt//jSlJc2ac2B8EzkzygSTHsfgfIdw1mbEk
TdrIb71V1WtJrmLxN6OOAXZU1eMTm0zSRI31PntV3Q3cPaFZJE2RH5eVmjB2qQljl5owdqkJY5ea
MHapCWOXmjB2qQljl5owdqkJY5eaMHapCWOXmjB2qQljl5owdqkJY5eaMHapCWOXmjB2qQljl5ow
dqkJY5eaMHapCWOXmjB2qQljl5owdqkJY5eaMHapibGWbE6yF3gFeB14raoWJjGUpMkbK/bBL1TV
SxP4cyRNkQ/jpSbGjb2Ae5I8lGTbchdIsi3J7iS7D3FwzMNJGtW4D+PPq6p9SX4MuDfJN6rqvqUX
qKrtwHaAH8nJNebxJI1orHv2qto3fD8A3AGcO4mhJE3eyLEnOSHJSW+eBi4E9kxqMEmTNc7D+M3A
HUne/HO+WlX/NJGpJE3cyLFX1TPAz0xwFklT5FtvUhPGLjVh7FITxi41YexSE8YuNWHsUhPGLjVh
7FITxi41YexSE8YuNWHsUhPGLjVh7FITxi41YexSE8YuNWHsUhPGLjVh7FITxi41YexSE8YuNWHs
UhPGLjVh7FITxi41YexSE8YuNbFq7El2JDmQZM+SbScnuTfJU8P3TdMdU9K41nLPfhNw0WHbrgZ2
VdWZwK7hvKQ5tmrsVXUf8PJhmy8Bdg6ndwKXTnguSRN27IjX21xV+4fTLwCbV7pgkm3ANoDj+eER
DydpXGO/QFdVBdQR9m+vqoWqWtjAxnEPJ2lEo8b+YpItAMP3A5MbSdI0jBr7XcDW4fRW4M7JjCNp
Wtby1tvNwL8DP5nk+SRXAtcBH03yFPCLw3lJc2zVF+iq6vIVdl0w4VkkTZGfoJOaMHapCWOXmjB2
qQljl5owdqkJY5eaMHapCWOXmjB2qQljl5owdqkJY5eaMHapCWOXmjB2qQljl5owdqkJY5eaMHap
CWOXmjB2qQljl5owdqkJY5eaMHapCWOXmjB2qQljl5owdqmJtazPviPJgSR7lmy7Nsm+JI8MXxdP
d0xJ41rLPftNwEXLbP9iVZ09fN092bEkTdqqsVfVfcDL6zCLpCka5zn7VUkeHR7mb1rpQkm2Jdmd
ZPchDo5xOEnjGDX2LwEfAs4G9gPXr3TBqtpeVQtVtbCBjSMeTtK4Roq9ql6sqter6g3gBuDcyY4l
adJGij3JliVnPw7sWemykubDsatdIMnNwPnAKUmeB/4IOD/J2UABe4FPTnFGSROwauxVdfkym2+c
wiySpshP0ElNGLvUhLFLTRi71ISxS00Yu9SEsUtNGLvUhLFLTRi71ISxS00Yu9SEsUtNGLvUhLFL
TRi71ISxS00Yu9SEsUtNGLvUhLFLTRi71ISxS00Yu9SEsUtNGLvUhLFLTRi71ISxS02sGnuS05N8
LckTSR5P8ulh+8lJ7k3y1PB90/THlTSqtdyzvwZ8tqrOAj4MfCrJWcDVwK6qOhPYNZyXNKdWjb2q
9lfVw8PpV4AngVOBS4Cdw8V2ApdOa0hJ43tXz9mTvB84B3gA2FxV+4ddLwCbJzqZpIlac+xJTgRu
Az5TVd9Zuq+qCqgVrrctye4kuw9xcKxhJY1uTbEn2cBi6F+pqtuHzS8m2TLs3wIcWO66VbW9qhaq
amEDGycxs6QRrOXV+AA3Ak9W1ReW7LoL2Dqc3grcOfnxJE3KsWu4zEeAK4DHkjwybPsccB1wa5Ir
gWeBy6YzoqRJWDX2qrofyAq7L5jsOJKmxU/QSU0Yu9SEsUtNGLvUhLFLTRi71ISxS00Yu9SEsUtN
GLvUhLFLTRi71ISxS00Yu9SEsUtNGLvUhLFLTRi71ISxS00Yu9SEsUtNGLvUhLFLTRi71ISxS00Y
u9SEsUtNGLvUhLFLTRi71MSqsSc5PcnXkjyR5PEknx62X5tkX5JHhq+Lpz+upFGtuj478Brw2ap6
OMlJwENJ7h32fbGqPj+98SRNyqqxV9V+YP9w+pUkTwKnTnswSZP1rp6zJ3k/cA7wwLDpqiSPJtmR
ZNMK19mWZHeS3Yc4ONawkka35tiTnAjcBnymqr4DfAn4EHA2i/f81y93varaXlULVbWwgY0TGFnS
KNYUe5INLIb+laq6HaCqXqyq16vqDeAG4NzpjSlpXGt5NT7AjcCTVfWFJdu3LLnYx4E9kx9P0qSs
5dX4jwBXAI8leWTY9jng8iRnAwXsBT45lQklTcRaXo2/H8gyu+6e/DiSpsVP0ElNGLvUhLFLTRi7
1ISxS00Yu9SEsUtNGLvUhLFLTRi71ISxS00Yu9SEsUtNGLvURKpq/Q6WfBt4dsmmU4CX1m2Ad2de
Z5vXucDZRjXJ2c6oqh9dbse6xv6Ogye7q2phZgMcwbzONq9zgbONar1m82G81ISxS03MOvbtMz7+
kczrbPM6FzjbqNZltpk+Z5e0fmZ9zy5pnRi71MRMYk9yUZJvJnk6ydWzmGElSfYmeWxYhnr3jGfZ
keRAkj1Ltp2c5N4kTw3fl11jb0azzcUy3kdYZnymt92slz9f9+fsSY4B/gP4KPA88CBweVU9sa6D
rCDJXmChqmb+AYwkPw98F/hyVf30sO3PgJer6rrhB+Wmqvr9OZntWuC7s17Ge1itaMvSZcaBS4Hf
ZIa33RHmuox1uN1mcc9+LvB0VT1TVa8CtwCXzGCOuVdV9wEvH7b5EmDncHoni/9Y1t0Ks82Fqtpf
VQ8Pp18B3lxmfKa33RHmWheziP1U4Lkl559nvtZ7L+CeJA8l2TbrYZaxuar2D6dfADbPcphlrLqM
93o6bJnxubntRln+fFy+QPdO51XVzwIfAz41PFydS7X4HGye3jtd0zLe62WZZcbfMsvbbtTlz8c1
i9j3AacvOX/asG0uVNW+4fsB4A7mbynqF99cQXf4fmDG87xlnpbxXm6Zcebgtpvl8ueziP1B4Mwk
H0hyHPAJ4K4ZzPEOSU4YXjghyQnAhczfUtR3AVuH01uBO2c4y9vMyzLeKy0zzoxvu5kvf15V6/4F
XMziK/L/CfzhLGZYYa4PAl8fvh6f9WzAzSw+rDvE4msbVwLvA3YBTwH/Apw8R7P9LfAY8CiLYW2Z
0WznsfgQ/VHgkeHr4lnfdkeYa11uNz8uKzXhC3RSE8YuNWHsUhPGLjVh7FITxi41YexSE/8PUKmz
brW7omQAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Test&quot;&gt;Test&lt;a class=&quot;anchor-link&quot; href=&quot;#Test&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;in_dist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unsqueeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;in_recon_prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_recon_prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_dist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/usr/local/lib/python3.6/dist-packages/torch/nn/modules/loss.py:498: UserWarning: Using a target size (torch.Size([1, 1, 28, 28])) that is different to the input size (torch.Size([1, 28, 28, 1])) is deprecated. Please ensure they have the same size.
  return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_dist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;out_dist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FloatTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;out_recon_prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_recon_prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/usr/local/lib/python3.6/dist-packages/torch/nn/modules/loss.py:498: UserWarning: Using a target size (torch.Size([1, 1, 28, 28])) that is different to the input size (torch.Size([1, 28, 28, 1])) is deprecated. Please ensure they have the same size.
  return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_recon_prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_recon_prob&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(tensor(110.3578, device=&amp;#39;cuda:0&amp;#39;, grad_fn=&amp;lt;DivBackward0&amp;gt;),
 tensor(1126.5494, device=&amp;#39;cuda:0&amp;#39;, grad_fn=&amp;lt;DivBackward0&amp;gt;))&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;

&lt;script type=&quot;application/vnd.jupyter.widget-state+json&quot;&gt;
{&quot;3bdf7bfa33424afe9e6664871ae9c29e&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;_dom_classes&quot;: [], &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;layout&quot;: &quot;IPY_MODEL_d0d88d816ae943a1812d00a199d59715&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;children&quot;: [&quot;IPY_MODEL_097cc8b59edf42acbfd1ead07f61bbe8&quot;, &quot;IPY_MODEL_bedbca85516641ccb5ceca90c0843bb3&quot;]}}, &quot;d0d88d816ae943a1812d00a199d59715&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;097cc8b59edf42acbfd1ead07f61bbe8&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;IntProgressModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;style&quot;: &quot;IPY_MODEL_aaefda59b2674f03934cea78f5aa8275&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;IntProgressModel&quot;, &quot;bar_style&quot;: &quot;info&quot;, &quot;max&quot;: 1, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: 1, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;min&quot;: 0, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_23dabf490fce496b959a8b4753bffa49&quot;}}, &quot;bedbca85516641ccb5ceca90c0843bb3&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;style&quot;: &quot;IPY_MODEL_3922184c838c4b768573ac7a8f91a672&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: &quot; 9920512/? [00:20&amp;lt;00:00, 2045129.04it/s]&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_cd09091252824483a7a123a3fc039302&quot;}}, &quot;aaefda59b2674f03934cea78f5aa8275&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;description_width&quot;: &quot;initial&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;bar_color&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;23dabf490fce496b959a8b4753bffa49&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;3922184c838c4b768573ac7a8f91a672&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;description_width&quot;: &quot;&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;cd09091252824483a7a123a3fc039302&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;3a355391c87b4c888dbca83b9cfb9380&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;_dom_classes&quot;: [], &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;layout&quot;: &quot;IPY_MODEL_f8a260b479dd4075a704f177066c8720&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;children&quot;: [&quot;IPY_MODEL_3777889f58d54a58a5e8f2a5b16df6b1&quot;, &quot;IPY_MODEL_b8b316e04d01479aa5fd7a8664a3d9b6&quot;]}}, &quot;f8a260b479dd4075a704f177066c8720&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;3777889f58d54a58a5e8f2a5b16df6b1&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;IntProgressModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;style&quot;: &quot;IPY_MODEL_059d05f7fef7445389c670d9f707566f&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;IntProgressModel&quot;, &quot;bar_style&quot;: &quot;success&quot;, &quot;max&quot;: 1, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: 1, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;min&quot;: 0, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_b49c87bfd0a84116b2a326fdaf6d22fb&quot;}}, &quot;b8b316e04d01479aa5fd7a8664a3d9b6&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;style&quot;: &quot;IPY_MODEL_d54d605f816540a1b4e676c30475f017&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: &quot; 32768/? [00:00&amp;lt;00:00, 101260.58it/s]&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_5a088b3b0af54652a71d5e408f939206&quot;}}, &quot;059d05f7fef7445389c670d9f707566f&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;description_width&quot;: &quot;initial&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;bar_color&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;b49c87bfd0a84116b2a326fdaf6d22fb&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;d54d605f816540a1b4e676c30475f017&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;description_width&quot;: &quot;&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;5a088b3b0af54652a71d5e408f939206&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;1065faac074147cc9792e0f043081094&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;_dom_classes&quot;: [], &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;layout&quot;: &quot;IPY_MODEL_ecd217c464c14e6095792f4697211cd3&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;children&quot;: [&quot;IPY_MODEL_bcbafb2883dd4437abf2365dc5a8be63&quot;, &quot;IPY_MODEL_5611437463484c99b23b4c070f360f58&quot;]}}, &quot;ecd217c464c14e6095792f4697211cd3&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;bcbafb2883dd4437abf2365dc5a8be63&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;IntProgressModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;style&quot;: &quot;IPY_MODEL_113eecce0332490097c3d36fdb56311a&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;IntProgressModel&quot;, &quot;bar_style&quot;: &quot;info&quot;, &quot;max&quot;: 1, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: 1, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;min&quot;: 0, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_6d077393fd9f45b3b1233d5094f2e1c5&quot;}}, &quot;5611437463484c99b23b4c070f360f58&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;style&quot;: &quot;IPY_MODEL_bf58b2e8e0034e1b8d3ce65866716c5f&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: &quot; 1654784/? [00:13&amp;lt;00:00, 279110.66it/s]&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_1d6824e180b3480380d7a3d3a21dbbb1&quot;}}, &quot;113eecce0332490097c3d36fdb56311a&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;description_width&quot;: &quot;initial&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;bar_color&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;6d077393fd9f45b3b1233d5094f2e1c5&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;bf58b2e8e0034e1b8d3ce65866716c5f&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;description_width&quot;: &quot;&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;1d6824e180b3480380d7a3d3a21dbbb1&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;a675418e0fc14a3da632065af6cce1b3&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;_dom_classes&quot;: [], &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;layout&quot;: &quot;IPY_MODEL_b76d4d565dc44335aa82eeb26151fc8e&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;children&quot;: [&quot;IPY_MODEL_e1b9abefd878480aa26d58d97a03cdb8&quot;, &quot;IPY_MODEL_290c15eb8eee476ba529fb49b398ccc4&quot;]}}, &quot;b76d4d565dc44335aa82eeb26151fc8e&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;e1b9abefd878480aa26d58d97a03cdb8&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;IntProgressModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;style&quot;: &quot;IPY_MODEL_aa1bf32e6c754b398dec2eeed0f7a294&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;IntProgressModel&quot;, &quot;bar_style&quot;: &quot;success&quot;, &quot;max&quot;: 1, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: 1, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;min&quot;: 0, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_6df3ddebe9624052b8792b5c79c6d403&quot;}}, &quot;290c15eb8eee476ba529fb49b398ccc4&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;style&quot;: &quot;IPY_MODEL_350a750f76784d86840f361182ad03dc&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: &quot; 8192/? [00:00&amp;lt;00:00, 20212.65it/s]&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_61c200a7ebea4afcbb7c14e4e9b32b3a&quot;}}, &quot;aa1bf32e6c754b398dec2eeed0f7a294&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;description_width&quot;: &quot;initial&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;bar_color&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;6df3ddebe9624052b8792b5c79c6d403&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;350a750f76784d86840f361182ad03dc&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;description_width&quot;: &quot;&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;61c200a7ebea4afcbb7c14e4e9b32b3a&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}}
&lt;/script&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">VAE Tutorial</title><link href="https://fastpages.fast.ai/blog/vae/deeplearning/2020/03/25/VAE.html" rel="alternate" type="text/html" title="VAE Tutorial" /><published>2020-03-25T00:00:00-05:00</published><updated>2020-03-25T00:00:00-05:00</updated><id>https://fastpages.fast.ai/blog/vae/deeplearning/2020/03/25/VAE</id><content type="html" xml:base="https://fastpages.fast.ai/blog/vae/deeplearning/2020/03/25/VAE.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-25-VAE.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Auto-Encoding-Variational-Bayes&quot;&gt;Auto-Encoding Variational Bayes&lt;a class=&quot;anchor-link&quot; href=&quot;#Auto-Encoding-Variational-Bayes&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;Abstract&quot;&gt;Abstract&lt;a class=&quot;anchor-link&quot; href=&quot;#Abstract&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;intractable한 posterior distribution의 random variable인 latent variable과 probabilitstic model이 주어졌을 때, 어떻게 효율적인 inference와 learning을 진행할 수 있을까?&lt;/p&gt;
&lt;p&gt;해당 논문에서는 대형 데이터셋에도 적용가능한 stochastic variational inference와 learning 알고리즘을 제안한다.&lt;/p&gt;
&lt;p&gt;이 논문의 contribution은 두 가지이다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;reparameterisztion of variational lower bound를 통해서 SGD를 사용하여 최적화할 수 있다.&lt;/li&gt;
&lt;li&gt;독립적인 데이터라는 가정하에서 lower bound estimator를 이용하여 poseterior inference(intractable)를 근사하여 구할 수 있다.&lt;blockquote&gt;&lt;p&gt;probabilistic model과 대비되는 개념으로는 deterministic model이 있다. 일반적으로 output이 특정확률 분포에서 추출된 random variable이라고 가정한다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;graph model&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://2.bp.blogspot.com/-VnKSz_Ds8HI/WPV9J6d7CCI/AAAAAAAABno/oySdUuZJOS83tBdTnb00ADIK8G7IUrAvQCK4B/s400/vae_2.PNG&quot; alt=&quot;&quot; title=&quot;Directed Graphical Model&quot; /&gt;
위의 그림을 보면, 대략적인 구조를 알 수 있다. 우선, 실선은 generative model $p_{\theta}(Z)p_{\theta}(X \mid Z)$을 나타내며, 점선은 variational approximation $q_{\phi}(Z \mid X)$과정을 나타낸다.&lt;/p&gt;
&lt;h2 id=&quot;Method&quot;&gt;Method&lt;a class=&quot;anchor-link&quot; href=&quot;#Method&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;우선, 다음과 같은 가정을 하였다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;i.i.d dataset with latent variables per datapoint&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;위와 같은 가정에서 global parameter 기반으로 MLE 혹은 MAP inference를 진행하고 latent variable으로 variational inference를 진행했다. global parameter에 variational inference를 진행해도 되지만, 해당 논문에서는 다루지 않았다.&lt;/p&gt;
&lt;h3 id=&quot;Problem-scenario&quot;&gt;Problem scenario&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-scenario&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;i.i.d dataset $X = \{ x^{(i)} \}^N_{i=1}$ 은 관측되지 않고 연속적인 변수인 $z$에 생성된 것이라고 가정하고 이는 다음과 같은 과정을 통해서 이루어진다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;$z$는 prior distribution에서 생성된다.&lt;/p&gt;
&lt;p&gt;$$z \sim p_{\theta *}(z)$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;데이터는 조건부 확률을 통해서 생성된다.&lt;/p&gt;
&lt;p&gt;$$x^{(i)} \sim p_{\theta *}(x \mid z)$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그리고, $p_{\theta *}(z)$와 $p_{\theta *}(x \mid z)$는 각각 미분가능한($\theta, z$에 대해서) PDF(확률밀도함수)를 가진 $p_{\theta}(z)$와 $p_{\theta}(x \mid z)$에서 출발했다고 가정한다.&lt;/p&gt;
&lt;p&gt;중요한 점은 위의 과정에서는 marginal probability와 posterior probability에 대해서는 어떤 가정도 하지 않았다는 점이다. 이는 아래의 경우에서 보편적으로 사용할 수 있다는 뜻이다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Intractability&lt;/p&gt;
&lt;p&gt;margianl likelihood $p_{\theta}(x) = \int p_{\theta}(z) p_{\theta}(x \mid z)$는 intractable하다. 일반적으로 neural network는 수많은 hidden layer로 이루어져있기 때문에 해당 liklihood$p_{\theta}(x \mid z)$는 intractable하다. 또한 이런 이유 때문에 unsupervised learning에서 사용되는 EM알고리즘은 사용하기 힘들다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A large dataset&lt;/p&gt;
&lt;p&gt;Monte Carlo EM은 너무 느리다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;결론적으로 해당 논문이 하고자 하는바는 다음과 같다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Efficient approximate ML or MAP estimation for the paramters $\theta$&lt;/li&gt;
&lt;/ol&gt;
$$
p_{\theta}(x \mid z)
$$&lt;ol&gt;
&lt;li&gt;Efficient approximate posterior inference of the latent variable z given an observed value x for a choice of parameters $\theta$&lt;/li&gt;
&lt;/ol&gt;
$$
p_{\theta}(z \mid x)
$$&lt;ol&gt;
&lt;li&gt;Efficient approximate marginal inference of the variable X&lt;/li&gt;
&lt;/ol&gt;
$$
p_{\theta}(x) = \int p_{\theta}(x \mid z) p_{\theta}(z) dz
$$&lt;p&gt;위의 목적을 달성하기 위해서, recognition model $q_{\phi}(z \mid x)$를 사용하였다.&lt;/p&gt;
$$
q_{\phi}(z \mid x) \approx p_{\theta}(z \mid x)
$$&lt;p&gt;아래에는 $\theta, \phi$을 함께 학습시키는 방법을 소개할 것이다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;mean-field variational inference
추후 작성 예정&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$q_{\phi}(Z \mid X)$는 probabilistic encoder 역할을 하고 $p_{\theta}(X \mid Z)$는 probabilistic decoder의 역할을 한다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://datascienceschool.net/upfiles/f38b90fa89cb46eba22178edbae07a26.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;The-variational-bound&quot;&gt;The variational bound&lt;a class=&quot;anchor-link&quot; href=&quot;#The-variational-bound&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;variational inference란, intractable한 posetrior분포 $p(z \mid x)$를 다루기 쉬운 확률분포 $q(z)$로 근사하는 것을 의미한다. intractable한 posterior를 직접다루지 않고, lower bound를 증가하는 방식으로 ${ D }_{ KL }\left( q\left( z \right) \mid \mid p\left( z \mid x \right)  \right)$를 감소시킬 수 있다.&lt;/p&gt;
$$
D_{\mathrm{KL}}(Q \parallel P) = \sum_\mathbf{Z}  Q(\mathbf{Z}) \left[ \log Q(\mathbf{Z}) -  \log P(\mathbf{Z},\mathbf{X}) \right] + \log P(\mathbf{X}) 
$$$$
D_{\mathrm{KL}}(Q \parallel P) 
= \mathbb{E}_{\mathbf Z } \left[ \log Q(\mathbf{Z}) -  \log P(\mathbf{Z},\mathbf{X}) \right] + \log P(\mathbf{X}) 
$$&lt;ul&gt;
&lt;li&gt;marginal probability, 즉 사후확률의 분모인 $p(x)=Σzp(x,z)$를 계산하기 힘든 경우&lt;/li&gt;
&lt;li&gt;likelihood, 즉 $p(x \mid z)$를 더 복잡하게 모델링하고 싶은 경우&lt;/li&gt;
&lt;li&gt;prior, 즉 p(z)를 더 복잡하게 모델링하고 싶은 경우&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;전체 marginal likelihood는 각 data point들의 marginal likelihood의 합으로 구성된다.&lt;/p&gt;
$$
\log p_{\theta}(X^{(1)}, \cdots, X^{(N)} = \sum _{i=1}^N \log p_{\theta}(X^{(i)})
$$&lt;p&gt;그리고 각 data point의 marginal likelihood는 아래와 같이 구성된다.&lt;/p&gt;
$$
log p_{\theta}(X^{(i)}) = D_{KL}(q_{\phi}(Z \mid X^{(i)}) \mid \mid p_{\theta}(Z \mid X^{(i)})) + \mathcal{L}(\theta, \phi; X^{(i)})
$$&lt;p&gt;첫 번째 term인 $D_{KL}(q_{\phi}(Z \mid X^{(i)}) \mid \mid p_{\theta}(Z \mid X^{(i)}))$은 true posterior와 pred posterior간의 kl-divergence 값으로 non-negative하다는 성격을 가진다. 두 번째 term $\mathcal{L}(\theta, \phi; X^{(i)})$은 lower bound이며 다음과 같이 표현될 수 있다.&lt;/p&gt;
$$
log p_{\theta}(X^{(i)}) \ge \mathcal{L}(\theta, \phi; X^{(i)}) = \mathbb{E}_{q_{\phi}(Z \mid X)}[-\log q_{\phi}(z \mid x) + \log p_{\theta}(X)]
$$$$
\mathcal{L}(\theta, \phi; X^{(i)}) = -D_{KL}(q_{\phi}(Z \mid X^{(i)}) \mid \mid p_{\theta}(Z )) + \mathbb{E}_{q_{\phi}(Z \mid X)}[\log p_{\theta}(X)]
$$&lt;p&gt;위의 형태는 $\mathcal{L}(\theta, \phi; X^{(i)})$를 미분하고 최적화를 variational parameters $\phi$와 generative parameters $\theta$에 대해서 할 수 있다. 하지만, $\phi$에 대해서 lower bound의 gradient를 구하는 것은 약간의 문제가 있다. 일반적인 Monte Carlo를 이용하게 되면, variance가 너무 높다는 한계가 있다.&lt;/p&gt;
&lt;h3 id=&quot;The-SGVB-estimator-and-AEVB-algorithm&quot;&gt;The SGVB estimator and AEVB algorithm&lt;a class=&quot;anchor-link&quot; href=&quot;#The-SGVB-estimator-and-AEVB-algorithm&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;이 섹션에서는 효율적으로 lower bound와 lower bound의 parameter에 대한 미분을 구하는 것을 다룬다.&lt;/p&gt;
&lt;p&gt;reparameterize를 통해서 $\tilde{z} \sim q_{\phi}(z \mid x)$를 다음과 같은 미분가능한 fuction의 형태로 바꿔줄 수 있다.&lt;/p&gt;
$$
\tilde{z} = g_{\phi}(\epsilon, X) \text{  with } \epsilon \sim p(\epsilon) 
$$&lt;p&gt;이를 통해서, Monte Carlo를 이용하여 $f(z)$ w.r.t $q_{\phi}(z \mid x)$의 기댓값을 구할 수 있다.&lt;/p&gt;
$$
\mathbb{E}_{q_{\phi}(z \mid x ^{(i)})}[f(z)] = \mathbb{E}_{p(\epsilon)}[f(g_{\phi}(\epsilon, X ^{(i)}))] = \frac{1}{L} \sum_{l=1}^L f(g_{\phi}(\epsilon^{(l)}, X ^{(i)})) \text{   where  } \epsilon^{(l)} \sim p(\epsilon)
$$&lt;p&gt;여기서, variational lower bound에 Monte Carlo Estimation을 적용하면 아래와 같이 전개된다. ($\mathcal{L}(\theta, \phi; X^{(i)}) = \mathbb{E}_{q_{\phi}(Z \mid X)}[-\log q_{\phi}(z \mid x) + \log p_{\theta}(X)]$)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SGVB(stochastic gradient variational bayes) 1&lt;/strong&gt;&lt;/p&gt;
$$
\tilde{\mathcal{L}}^A(\theta, \phi; X^{(i)}) = \frac{1}{L} \sum_{l=1}^L \log p_{\theta}(X^{(i)}, Z^{(i, l)}) - \log q_{\phi}(Z^{(i, l)} \mid X^{(i)}) \text{    where   } Z^{(i, l)} = g_{\phi}(\epsilon^{(i, l)}, X^{(i)}), \ \ \epsilon^{(l)} \sim p(\epsilon)
$$&lt;p&gt;또한, kl-divergence term $D_{KL}(q_{\phi}(Z \mid X^{(i)}) \mid \mid p_{\theta}(Z))$은 적분될 수 있는데, 이는 해당논문의 appendix B를 참고하길 바란다.&lt;/p&gt;
&lt;p&gt;kl-divergence는 $\phi$를 regularization한다고 해석할 수 있는데, approximate posterior가 prior $p_{\theta}(z)$를 근사하도록 한다.&lt;/p&gt;
&lt;p&gt;이러한 관점을 바탕으로 아래와 같은 SGVB(stochastic gradient variational bayes)가 전개된다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SGVB(stochastic gradient variational bayes) 2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;sampling을 통해서 gradient estimate 방법보다 더 낮은 variance를 가진다. $\log p_{\theta}(x^{(i)}) \mid z^{(i, l)})$은 reconstruction error를 나타낸다.&lt;/p&gt;
$$
\tilde{\mathcal{L}}^B(\theta, \phi; X^{(i)}) = -D_{KL}(q_{\phi}(Z \mid X^{(i)}) \mid \mid p_{\theta}(Z)) + \frac{1}{L} \sum_{l=1}^L ( \log p_{\theta}(x^{(i)}) \mid z^{(i, l)})
\text{    where   } Z^{(i, l)} = g_{\phi}(\epsilon^{(i, l)}, X^{(i)}), \ \ \epsilon^{(l)} \sim p(\epsilon)
$$&lt;ul&gt;
&lt;li&gt;$\log p_{\theta}(x^{(i)}) \mid z^{(i, l)})$ 은 다음과 같은 관계를 가진다.&lt;/li&gt;
&lt;/ul&gt;
$$
p_{\theta}(x^{(i)}) \mid z^{(i, l)}) = p_{\theta}(x^{(i)}_1) \mid z^{(i, l)}) \times \cdots \times p_{\theta}(x^{(i)}_M) \mid z^{(i, l)}) 
$$$$
\log p_{\theta}(x^{(i)}) \mid z^{(i, l)}) = \log p_{\theta}(x^{(i)}_1) \mid z^{(i, l)}) + \cdots + \log p_{\theta}(x^{(i)}_M) \mid z^{(i, l)}) 
$$&lt;h3 id=&quot;The-reparameterization-trick&quot;&gt;The reparameterization trick&lt;a class=&quot;anchor-link&quot; href=&quot;#The-reparameterization-trick&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;reparameterize를 통해서 $\tilde{z} \sim q_{\phi}(z \mid x)$를 다음과 같은 미분가능한 fuction의 형태로 바꿔줄 수 있다.&lt;/p&gt;
$$
\tilde{z} = g_{\phi}(\epsilon, X) \text{  with } \epsilon \sim p(\epsilon) 
$$&lt;p&gt;여기서 $\epsilon$은 auxiliary variable이며, 이를 통해서 $g_{\phi}(\cdot)$은 vector z를 도출한다.&lt;/p&gt;
&lt;p&gt;reparameterization이 필요한 이유는 미분가능한 상태를 얻기 위해서이다. 아래는 증명이다.&lt;/p&gt;
$$
q_{\phi}(Z \mid X) dz = p(\epsilon) d\epsilon
$$&lt;p&gt;그러므로,&lt;/p&gt;
$$
\int q_{\phi}(Z \mid X) f(z) dz = \int p(\epsilon) f(Z) d\epsilon = \int p(\epsilon) f(g_{\phi}(\epsilon, X)) d\epsilon
$$&lt;p&gt;그리고, Monte Carlo Estimation을 고려하면,&lt;/p&gt;
$$
\int q_{\phi}(Z \mid X) f(z) dz \approx \frac{1}{L} \sum_{l=1}^Lf(g_{\phi}(\epsilon^{(l)}, X))
$$&lt;p&gt;&lt;strong&gt;가우시안 분포를 예시로 살펴보자&lt;/strong&gt;&lt;/p&gt;
$$
z \sim p(z \mid x) = \mathcal{N}(u, \sigma^2)
$$&lt;p&gt;reparameterization을 적용하게 되면, 다음과 같이 생각할 수 있다.&lt;/p&gt;
$$
z = u + \sigma \epsilon \text{    where  } \epsilon \sim \mathcal{N}(0, 1)
$$&lt;p&gt;이를 바탕으로, 다음과 같은 수식전개가 가능하다.&lt;/p&gt;
$$
\mathbb{E}_{\mathcal{N}(z;u,\sigma^2)}[f(z)] = \mathbb{E}_{\mathcal{N}(\epsilon;0,1)}[f(u + \sigma \epsilon)] \approx \frac{1}{L} \sum_{l=1}^L f(u + \sigma \epsilon ^{(l)}) \text{   where  } \epsilon^{(l)} \sim \mathcal{N}(0,1)
$$&lt;p&gt;어떤 $q_{\phi}(z \mid x)$에대해 변환 함수 $g_{\phi}(\cdot)$과 $\epsilon \sim p(\epsilon)$을 사용하여 위와 같이 reparmeterization 할 수 있을지 살펴보자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Tractable Inverse of CDF&lt;/li&gt;
&lt;li&gt;Gaussian과 유사하게 location, scale 개념의 분포&lt;/li&gt;
&lt;li&gt;random variables as different transformations
of auxiliary variables&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;위의 과정이 모두 실패하면, inverse of CDF를 근사하는 방식으로 접근할 수 있으며, time complexity는 PDF만큼 필요하다고 한다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;inverse CDF&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;아래와 같이 CDF가 정의된다면,&lt;/p&gt;
$$
F(X) = U \text{   where X is random variable}
$$&lt;p&gt;inverse CDF는 다음과 같이 정의될 수 있다.&lt;/p&gt;
$$
F^{-1}(U) = X \text{   where X is random variable}
$$&lt;p&gt;즉, $g_{\phi}(\cdot)$를 inverse CDF로 사용한다는 것은 $\epsilon$을 활용하여, 난수를 생성한다고 이해할 수 있다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pytorch-&amp;#44396;&amp;#54788;&amp;#52404;&quot;&gt;Pytorch &amp;#44396;&amp;#54788;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#Pytorch-&amp;#44396;&amp;#54788;&amp;#52404;&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;reference: &lt;a href=&quot;https://github.com/GunhoChoi/PyTorch-FastCampus&quot;&gt;https://github.com/GunhoChoi/PyTorch-FastCampus&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;1)--Import-required-libraries&quot;&gt;1)  Import required libraries&lt;a class=&quot;anchor-link&quot; href=&quot;#1)--Import-required-libraries&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.optim&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;optim&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn.init&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;init&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torchvision.datasets&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;dset&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torchvision.transforms&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;transforms&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.autograd&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;2) Set hyperparameters&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0005&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hidden_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;3)-Download-Data&quot;&gt;3) Download Data&lt;a class=&quot;anchor-link&quot; href=&quot;#3)-Download-Data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MNIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;./&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;download&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mnist_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MNIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;./&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;download&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./MNIST/raw/train-images-idx3-ubyte.gz
Extracting ./MNIST/raw/train-images-idx3-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./MNIST/raw/train-labels-idx1-ubyte.gz
Extracting ./MNIST/raw/train-labels-idx1-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./MNIST/raw/t10k-images-idx3-ubyte.gz
Extracting ./MNIST/raw/t10k-images-idx3-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./MNIST/raw/t10k-labels-idx1-ubyte.gz
Extracting ./MNIST/raw/t10k-labels-idx1-ubyte.gz to ./MNIST/raw
Processing...
Done!
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;4)-Set-DataLoader&quot;&gt;4) Set DataLoader&lt;a class=&quot;anchor-link&quot; href=&quot;#4)-Set-DataLoader&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;5)-Model&quot;&gt;5) Model&lt;a class=&quot;anchor-link&quot; href=&quot;#5)-Model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# for mu&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# for logvar&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;log_var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_var&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reparametrize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Transformation for differentiable function&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Return&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            z = mu + std * eps&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;eps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FloatTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;eps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparametrize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigmoid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sigmoid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigmoid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;
                
&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;6)-Loss-function-&amp;amp;-Optimizer&quot;&gt;6) Loss function &amp;amp; Optimizer&lt;a class=&quot;anchor-link&quot; href=&quot;#6)-Loss-function-&amp;amp;-Optimizer&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Kingma and Welling. Auto-Encoding Variational Bayes. ICLR, 2014&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/1312.6114&quot;&gt;https://arxiv.org/abs/1312.6114&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
$$
\tilde{\mathcal{L}}^B(\theta, \phi; X^{(i)}) = -D_{KL}(q_{\phi}(Z \mid X^{(i)}) \mid \mid p_{\theta}(Z)) + \frac{1}{L} \sum_{l=1}^L ( \log p_{\theta}(x^{(i)}) \mid z^{(i, l)})
\text{    where   } Z^{(i, l)} = g_{\phi}(\epsilon^{(i, l)}, X^{(i)}), \ \ \epsilon^{(l)} \sim p(\epsilon)
$$&lt;p&gt;From appendix B
$$
-D_{KL}(q_{\phi}(Z \mid X^{(i)}) \mid \mid p_{\theta}(Z)) = \frac{1}{2} \sum_{j=1}^J(1 + \log(\sigma_j^2) - u_j^2 -\sigma_j^2)
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reconstruction_function&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BCELoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size_average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 각 element들의 BCE loss를 모두 sum해야 kld scale과 일치한다.&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;loss_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recon_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;BCE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reconstruction_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recon_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reconstruction error&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# see Appendix B from VAE paper:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Kingma and Welling. Auto-Encoding Variational Bayes. ICLR, 2014&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# https://arxiv.org/abs/1312.6114&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# 0.5 * sum(1 + log(sigma^2) - mu^2 - sigma^2)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;KLD_element&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mul_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logvar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;KLD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KLD_element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mul_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# regularizer term&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BCE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KLD&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/usr/local/lib/python3.6/dist-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction=&amp;#39;sum&amp;#39; instead.
  warnings.warn(warning.format(ret))
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;7)-Train&quot;&gt;7) Train&lt;a class=&quot;anchor-link&quot; href=&quot;#7)-Train&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./model/variational_autoencoder.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;--------model restored--------&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;--------model not restored--------&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cum_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reparam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log_var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;cum_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cum_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Train graph&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;
--------model not restored--------

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/usr/local/lib/python3.6/dist-packages/torch/nn/modules/loss.py:498: UserWarning: Using a target size (torch.Size([128, 1, 28, 28])) that is different to the input size (torch.Size([128, 28, 28, 1])) is deprecated. Please ensure they have the same size.
  return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
6gAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;8)-Check-with-Train-Image&quot;&gt;8) Check with Train Image&lt;a class=&quot;anchor-link&quot; href=&quot;#8)-Check-with-Train-Image&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;아래의 이미지를 통해서 encoding된 train image가 decoding된 것을 확인할 수 있다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gray&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;torch.Size([128, 28, 28])
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
uRoo3HZLAAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
brbf3Xd2bQKBXp1br85LYm6N6tTceBoPJEHYgSS6HfY9Xb7/SK/OrVfnJTG3RnVkbl39nR1A53T7
zA6gQwg7kERXwm5md5vZH8xswMwe7cYc6pjZoJm9bWZvdnt/umoPvVEzOzjt2Coze9HMDlcfZ9xj
r0tze9zMhqvH7k0zu6dLc9toZi+b2btm9o6Z/bA63tXHLphXRx63jv/ObmbzJL0v6VuShiTtk/SA
u7/b0YnUMLNBSTvdvetvwDCz2yWdk/RLd/+j6tg/Sjrt7k9U/1GudPe/7ZG5Pa6vuI13m+ZWt834
X6qLj10rtz9vRDfO7LskDbj7UXe/JOnXku7rwjx6nru/Iun0Fw7fJ2lv9fleTf1j6biaufUEdx9x
99erz89K+myb8a4+dsG8OqIbYV8v6aNpXw+pt/Z7d0m/M7MDZra725OZQd+0bbaOSerr5mRmUNzG
u5O+sM14zzx2jWx/3ixeoPuy29z9TyT9uaQfVE9Xe5JP/Q7WS73Tn0n6hqb2AByR9JNuTqbaZvwZ
ST9y97HptW4+djPMqyOPWzfCPixp47SvN1THeoK7D1cfRyU9p97bivr4ZzvoVh9Huzyf/9NL23jP
tM24euCx6+b2590I+z5JW81si5ldLel7kl7owjy+xMyWVi+cyMyWSvq2em8r6hckPVh9/qCk57s4
l8/plW2867YZV5cfu65vf+7uHf8j6R5NvSJ/RNLfdWMONfO6TtL/VH/e6fbcJD2tqad1lzX12sZD
klZLeknSYUn/KWlVD83tXzW1tfdbmgpWf5fmdpumnqK/JenN6s893X7sgnl15HHj7bJAErxAByRB
2IEkCDuQBGEHkiDsQBKEHUiCsANJ/C8hdLihKzGgxgAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
Xeo51y+usvSwJJ09e7a0Nn369OS2AwMDyXqqhy9JBw4cSNaHhoZKa7l5/Lmx5/ZLar9Wna9+Oc53
58gOBEHYgSAIOxAEYQeCIOxAEIQdCIKwA0HQZy/k5kaneulV++i5nm1ubNOmTSutzZ07N7ntnXfe
maxff/31yXpu2eVTp06V1nJ99lmzZiXruT77mTNnSmtVz224IvvsZvaymR02sx3j7nvBzIbNbHvx
9XizwwRQ1WRexv9c0mMT3P+v7r6k+PpNvcMCULds2N39LUnHujAWAA2q8gHds2Y2WLzMn1P2S2a2
2sy2mtnWCs8FoKJOw/5TSYskLZE0IunHZb/o7mvcfam7L+3wuQDUoKOwu/shd7/g7hcl/UzSsnqH
BaBuHYXdzMbPi/y2pB1lvwugN2T77Gb2iqSHJM0zsyFJP5L0kJktkeSS9kn6XoNj7IoqffbcnO9c
PdezzdX7+vpKa/fcc09y2/vuuy9Zz/XCc2us79+/v7R2+vTpSs+dW3s+1Uuv+ndyOcqG3d1XTnD3
Sw2MBUCDOF0WCIKwA0EQdiAIwg4EQdiBIMJMcc1NQ81dDjol18apOl0yN/bUJZfvv//+5LbXXXdd
sr579+5kfcOGDcn6nj17SmtNtySb2raO7dvAkR0IgrADQRB2IAjCDgRB2IEgCDsQBGEHgqDPXpgy
ZUqynpsCm1K1J5sbe39/f2nt3nvvTW47OjqarK9fvz5ZHxwcTNY//fTT0lruz5Xb5+fOnUvWU+c3
NNnD71Uc2YEgCDsQBGEHgiDsQBCEHQiCsANBEHYgCPrshVxPN3VZ46aX/505c2ayvnRp+WI78+bN
S26bW3J58+bNyXqqjy6le+G5awjk9lvV/R4NR3YgCMIOBEHYgSAIOxAEYQeCIOxAEIQdCCJMnz3X
y8712VPLA0+bNi257ZkzZ5L1XL85Nyf9qaeeKq3l5unnrgs/MjKSrOfmlFeZF547NyJXvxLnpFeR
PbKb2QIz+52Z7TSz98zsB8X9c83sTTPbW3yf0/xwAXRqMi/jz0v6O3f/uqQ/k/R9M/u6pOckbXT3
xZI2Fj8D6FHZsLv7iLtvK26PSnpf0nxJKyStLX5traQnmxokgOq+0nt2M7tZ0jck/V5Sv7tfekN3
UNKEF0Izs9WSVnc+RAB1mPSn8WY2S9Krkn7o7ifG13zsk5AJPw1x9zXuvtTdy2drAGjcpMJuZn0a
C/ov3f214u5DZjZQ1AckHW5miADqkH0Zb2P9jZckve/uPxlXWidplaQXi+9vNDLCmuTaMLnlg1Ot
t/nz5ye3HRgYSNZvvfXWZP3hhx9O1pctW1ZaO3LkSHLbnTt3JuvHjx9P1nP7ta+vr6OaVH1qcKoe
sS03mffsfy7pryS9a2bbi/ue11jIf21mz0jaL+k7zQwRQB2yYXf3zZLKzl74Zr3DAdAUTpcFgiDs
QBCEHQiCsANBEHYgCKa4FnLTUE+ePFlay02Pveuuu5L15cuXJ+u33357sp6aInvw4MHktrkprqdP
n07Wc1L7PXduQ+5S0bnptanHr9rDvxxxZAeCIOxAEIQdCIKwA0EQdiAIwg4EQdiBIML02XNyPd1P
PvmktJabE57rB+eWPb7ttts63n7Tpk3Jbbds2ZKsp84vkKotq5y7FHTu76TKks1XYh89hyM7EARh
B4Ig7EAQhB0IgrADQRB2IAjCDgRh3ew3mtkV2dzMzWfP1XPLKue2T/WTq/Si65Dqpef67BHnnNfB
3SfcsRzZgSAIOxAEYQeCIOxAEIQdCIKwA0EQdiCIbJ/dzBZI+oWkfkkuaY27/5uZvSDpbyVdWgD8
eXf/TeaxaIwCDSvrs08m7AOSBtx9m5nNlvSOpCc1th77SXf/l8kOgrADzSsL+2TWZx+RNFLcHjWz
9yXNr3d4AJr2ld6zm9nNkr4h6ffFXc+a2aCZvWxmc0q2WW1mW81sa6WRAqhk0ufGm9ksSf8t6Z/c
/TUz65d0VGPv4/9RYy/1/ybzGLyMBxrW8Xt2STKzPknrJf3W3X8yQf1mSevd/U8zj0PYgYZ1PBHG
xqYmvSTp/fFBLz64u+TbknZUHSSA5kzm0/gHJG2S9K6kS3MOn5e0UtISjb2M3yfpe8WHeanH4sgO
NKzSy/i6EHagecxnB4Ij7EAQhB0IgrADQRB2IAjCDgRB2IEgCDsQBGEHgiDsQBCEHQiCsANBEHYg
CMIOBJG94GTNjkraP+7necV9vahXx9ar45IYW6fqHNuflBW6Op/9S09uttXdl7Y2gIReHVuvjkti
bJ3q1th4GQ8EQdiBINoO+5qWnz+lV8fWq+OSGFunujK2Vt+zA+ieto/sALqEsANBtBJ2M3vMzHab
2Qdm9lwbYyhjZvvM7F0z2972+nTFGnqHzWzHuPvmmtmbZra3+D7hGnstje0FMxsu9t12M3u8pbEt
MLPfmdlOM3vPzH5Q3N/qvkuMqyv7revv2c1siqQ9kpZLGpK0RdJKd9/Z1YGUMLN9kpa6e+snYJjZ
X0g6KekXl5bWMrN/lnTM3V8s/qOc4+5/3yNje0FfcRnvhsZWtsz4X6vFfVfn8uedaOPIvkzSB+7+
obuflfQrSStaGEfPc/e3JB37wt0rJK0tbq/V2D+WrisZW09w9xF331bcHpV0aZnxVvddYlxd0UbY
50v6w7ifh9Rb6727pA1m9o6ZrW57MBPoH7fM1kFJ/W0OZgLZZby76QvLjPfMvutk+fOq+IDuyx5w
9/sk/aWk7xcvV3uSj70H66Xe6U8lLdLYGoAjkn7c5mCKZcZflfRDdz8xvtbmvptgXF3Zb22EfVjS
gnE/f624rye4+3Dx/bCk1zX2tqOXHLq0gm7x/XDL4/l/7n7I3S+4+0VJP1OL+65YZvxVSb9099eK
u1vfdxONq1v7rY2wb5G02MwWmtlUSd+VtK6FcXyJmc0sPjiRmc2U9C313lLU6yStKm6vkvRGi2P5
I72yjHfZMuNqed+1vvy5u3f9S9LjGvtE/n8l/UMbYygZ1y2S/qf4eq/tsUl6RWMv685p7LONZyRd
L2mjpL2S/kvS3B4a279rbGnvQY0Fa6ClsT2gsZfog5K2F1+Pt73vEuPqyn7jdFkgCD6gA4Ig7EAQ
hB0IgrADQRB2IAjCDgRB2IEg/g+Cdq53kQ7BiQAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;9)-Check-with-Test-image&quot;&gt;9) Check with Test image&lt;a class=&quot;anchor-link&quot; href=&quot;#9)-Check-with-Test-image&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;       
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;volatile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:3: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  This is separate from the ipykernel package so we can avoid doing imports until
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gray&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gray&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;torch.Size([128, 28, 28])
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD4CAYAAAAq5pAIAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0
dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAQAklEQVR4nO3dTYxc5ZXG8efQdsvGNGBjj7GMMSbY
BoSAjIyFNIAYogSGDYQFhMWISCidRRglUhaDmEVYotEk0awiOQLFGWWIIiUIFtEMHguJsCDYWMZf
EGxMI3fT7jZf/gJ/cmbRl6iBrvN26lbVLXP+P6nV3ff0rXop+eHeuqfe+5q7C8BX33lNDwBAbxB2
IAnCDiRB2IEkCDuQxJxePpmZcekf6DJ3t5m21zqym9ldZvYXM9tnZo/WeSwA3WXt9tnNbEDSm5K+
KWlU0hZJD7r7nmAfjuxAl3XjyL5e0j533+/upyT9VtI9NR4PQBfVCftySQem/T5abfscMxs2s61m
trXGcwGoqesX6Nx9g6QNEqfxQJPqHNnHJK2Y9vtl1TYAfahO2LdIWm1mq8xsUNJ3JD3XmWEB6LS2
T+Pd/YyZPSLpfyUNSHrK3Xd3bGQAOqrt1ltbT8Z7dqDruvKhGgDnDsIOJEHYgSQIO5AEYQeSIOxA
EoQdSIKwA0kQdiAJwg4kQdiBJAg7kARhB5Lo6a2k0XtmM06AmnW9SXVnZLJo6edxZAeSIOxAEoQd
SIKwA0kQdiAJwg4kQdiBJOiz94G6ve7zzmv9/+zSY0f7StLAwECteqTUBz979mytevT4pefudr0J
HNmBJAg7kARhB5Ig7EAShB1IgrADSRB2IAn67B1Qd854qdddZ/9SH3zOnPifQKk+d+7csB6N7dNP
Pw33rdtnj+p1n/vMmTO19i89fzfUCruZjUg6KumspDPuvq4TgwLQeZ04sv+ju7/XgccB0EW8ZweS
qBt2l/S8mb1qZsMz/YGZDZvZVjPbWvO5ANRgdT6wb2bL3X3MzP5O0iZJ/+LuLwZ/33+zAzqAC3St
cYGuveevw91n/AdT68ju7mPV90lJz0haX+fxAHRP22E3swVmNvTZz5K+JWlXpwYGoLPqXI1fKumZ
6hRzjqT/dvf/6cioGlDnVLy0b+lUunQaX6deOg0fHBwM6/Pnzw/rQ0NDYX3evHkta6X/rtKp8smT
J8P6iRMnurLvbPY/depUWD99+nTLWrdO8dsOu7vvl3RDB8cCoItovQFJEHYgCcIOJEHYgSQIO5AE
U1xnKWqv1f2UWmn/Oq29BQsWhPsuXbo0rK9Zsyasr169OqxfcMEFLWsff/xxuO/Ro0fDemn/Q4cO
tayNj4+H+05MTIT10thK6ny6r10c2YEkCDuQBGEHkiDsQBKEHUiCsANJEHYgiTR99rp3k6nTZ687
hbX0+NE002uuuSbc98477wzrt956a1hfvHhxWD9y5EjL2rvvvhvue/DgwbD+3nvt3+f0ww8/DOul
OziVeuFN3Cq6hCM7kARhB5Ig7EAShB1IgrADSRB2IAnCDiSRps9eV6kPH6nbR7/wwgvD+nXXXdey
9sADD4T73nHHHWF9yZIlYb00rzuaF3748OFajz05ORnWR0dH26pJ0kcffRTWS7eaLt1Kuok+PEd2
IAnCDiRB2IEkCDuQBGEHkiDsQBKEHUiCPnsPlHr0559/flhfuXJlWL/tttta1krz2T/55JOwvmfP
nrC+f//+sP7mm2+2rH3wwQfhvqU++8jISFiPxlbq0ZfuSR/d93029dJ8+W4oHtnN7CkzmzSzXdO2
LTKzTWa2t/q+sLvDBFDXbE7jfyXpri9se1TSZndfLWlz9TuAPlYMu7u/KOmL51v3SNpY/bxR0r0d
HheADmv3PftSd/9ssayDklouGGZmw5KG23weAB1S+wKdu7uZtbza4O4bJG2QpOjvAHRXu623CTNb
JknV9/jSJoDGtRv25yQ9VP38kKRnOzMcAN1SPI03s6cl3S5psZmNSvqJpCck/c7MHpb0jqT7uznI
c11pffZLLrkkrF9//fVhfdWqVS1rpXXIt23bFtbHxsbCeunx66xjfvz48bB+4MCBsB7dV770+YIz
Z86E9Sb65HUVw+7uD7YofaPDYwHQRXxcFkiCsANJEHYgCcIOJEHYgSTSTHGt2yqJ9i9NYZ03b15Y
v/zyy8P6DTfcENYXLFjQsrZ3795w39I00VKLqlSfO3duy1rpFtulZZWPHTsW1k+ePNmyVncKat16
EziyA0kQdiAJwg4kQdiBJAg7kARhB5Ig7EASafrs3VTqs0d9cElas2ZNWF+7dm1Yj6bQDg0Nhfuu
WLEirJeUpoJGy1GXbtdcutV0qVceLYvcj33wbuPIDiRB2IEkCDuQBGEHkiDsQBKEHUiCsANJ0Gfv
gNK87MHBwbC+aNGisF5a0jmaM758+fJw30svvTSsl+bil+rR2N5+++1w3927d4f10use1UufjSjV
z8U+PUd2IAnCDiRB2IEkCDuQBGEHkiDsQBKEHUiCPnsHRPOmJenEiRNhff/+/WF9+/btYT3q45fu
vX7RRReF9SuvvDKsr1y5MqxHc+1HR0fDfUv3pK/T6y710b+Kikd2M3vKzCbNbNe0bY+b2ZiZba++
7u7uMAHUNZvT+F9JumuG7T939xurrz92dlgAOq0Ydnd/UVJ8fyAAfa/OBbpHzGxHdZq/sNUfmdmw
mW01s601ngtATe2G/ReSvibpRknjkn7a6g/dfYO7r3P3dW0+F4AOaCvs7j7h7mfd/VNJv5S0vrPD
AtBpbYXdzJZN+/Xbkna1+lsA/aHYZzezpyXdLmmxmY1K+omk283sRkkuaUTS97s4xp6o03ct9dkP
Hz4c1l9++eWwXurDl54/csUVV4T1iy++OKxfe+21YT3q8+/cuTPcd3x8PKyfPn06rEfqzmc/F+e7
F8Pu7g/OsPnJLowFQBfxcVkgCcIOJEHYgSQIO5AEYQeSYIprB5RaX6WlicfGxsL6xMREWI/aQKVb
PS9c2PKTzrOql5Zs3rJlS8vaSy+9FO578ODBsH7y5MmwXkepddaPrbUSjuxAEoQdSIKwA0kQdiAJ
wg4kQdiBJAg7kESaPnvdKYt1lv8t9eFL/eLSVM5oWeTSctA333xzWF+7dm1Yn5ycDOsvvPBCy1pp
6u7x48fD+tmzZ8N6k/pxCixHdiAJwg4kQdiBJAg7kARhB5Ig7EAShB1IIk2fva6ozz4wMFDrsUs9
19LjDw0NtaytXx+v33HvvfeG9VKffvPmzWF9x44dLWtHjhwJ9y3Nla+j233ufpzvzpEdSIKwA0kQ
diAJwg4kQdiBJAg7kARhB5Kgz16pM999zpz4Zaw7l37+/Plh/aqrrmpZu++++8J9S/PVS/esf+WV
V8L6oUOHWtbqLLkslXvZ0X0E6t4Xvh/76CXFI7uZrTCzF8xsj5ntNrMfVtsXmdkmM9tbfY9XEwDQ
qNmcxp+R9GN3v1bSzZJ+YGbXSnpU0mZ3Xy1pc/U7gD5VDLu7j7v7turno5Jel7Rc0j2SNlZ/tlFS
/LlLAI36m96zm9kVkr4u6c+Slrr7eFU6KGlpi32GJQ23P0QAnTDrq/FmdoGk30v6kbt/bgaDT12t
mPGKhbtvcPd17r6u1kgB1DKrsJvZXE0F/Tfu/odq84SZLavqyyTFtxkF0KjiabxN9YWelPS6u/9s
Wuk5SQ9JeqL6/mxXRtgnovZYqXVWas0NDg6G9SVLloT1m266qWXt6quvDvc9duxYWC+11nbu3BnW
o+Wq67a3Srfojm41Xdr3XGytlczmPfs/SPpnSTvNbHu17TFNhfx3ZvawpHck3d+dIQLohGLY3f0l
Sa0OXd/o7HAAdAsflwWSIOxAEoQdSIKwA0kQdiCJNFNcu9nTLfVso9tQS+UprKU++7Jly1rWStNI
S33y559/PqwfOHAgrEfLUZduFV2nj156/Ix9do7sQBKEHUiCsANJEHYgCcIOJEHYgSQIO5BEmj57
SamvGvV0S/3eUk+3NN89WpJZiufT79u3L9z3jTfeCOu7du0K66Vll7vZZ69T/yr20Us4sgNJEHYg
CcIOJEHYgSQIO5AEYQeSIOxAEvTZK6WebeTUqVNhvTSfPepFz+bxx8bGWtZGRkbCfV977bWw/tZb
b4X1Up89Gnu3l03O2EuPcGQHkiDsQBKEHUiCsANJEHYgCcIOJEHYgSSs1Is0sxWSfi1pqSSXtMHd
/9PMHpf0PUmHqj99zN3/WHisr2Tjs9RHHxgYCOul+eqXXXZZ2/u///774b4TExNh/fjx42G9NCc9
+vdFH7w73H3GGxzM5kM1ZyT92N23mdmQpFfNbFNV+7m7/0enBgmge2azPvu4pPHq56Nm9rqk5d0e
GIDO+pves5vZFZK+LunP1aZHzGyHmT1lZgtb7DNsZlvNbGutkQKoZdZhN7MLJP1e0o/c/YikX0j6
mqQbNXXk/+lM+7n7Bndf5+7rOjBeAG2aVdjNbK6mgv4bd/+DJLn7hLufdfdPJf1S0vruDRNAXcWw
29StS5+U9Lq7/2za9ulLh35bUnwbUgCNmk3r7RZJf5K0U9Jn80Afk/Sgpk7hXdKIpO9XF/Oix0rZ
aym15kq3kh4cHGz78UtLNpfqpdtk0z7rP61ab8WwdxJhnxlhRye1CjufoAOSIOxAEoQdSIKwA0kQ
diAJwg4kQesN+Iqh9QYkR9iBJAg7kARhB5Ig7EAShB1IgrADSfR6yeb3JL0z7ffF1bZ+1K9j69dx
SYytXZ0c28pWhZ5+qOZLT262tV/vTdevY+vXcUmMrV29Ghun8UAShB1Ioumwb2j4+SP9OrZ+HZfE
2NrVk7E1+p4dQO80fWQH0COEHUiikbCb2V1m9hcz22dmjzYxhlbMbMTMdprZ9qbXp6vW0Js0s13T
ti0ys01mtrf6PuMaew2N7XEzG6teu+1mdndDY1thZi+Y2R4z221mP6y2N/raBePqyevW8/fsZjYg
6U1J35Q0KmmLpAfdfU9PB9KCmY1IWufujX8Aw8xuk3RM0q/d/bpq279L+sDdn6j+R7nQ3f+1T8b2
uKRjTS/jXa1WtGz6MuOS7pX0XTX42gXjul89eN2aOLKvl7TP3fe7+ylJv5V0TwPj6Hvu/qKkD76w
+R5JG6ufN2rqH0vPtRhbX3D3cXffVv18VNJny4w3+toF4+qJJsK+XNKBab+Pqr/We3dJz5vZq2Y2
3PRgZrB02jJbByUtbXIwMygu491LX1hmvG9eu3aWP6+LC3Rfdou7/72kf5L0g+p0tS/51Huwfuqd
zmoZ716ZYZnxv2rytWt3+fO6mgj7mKQV036/rNrWF9x9rPo+KekZ9d9S1BOfraBbfZ9seDx/1U/L
eM+0zLj64LVrcvnzJsK+RdJqM1tlZoOSviPpuQbG8SVmtqC6cCIzWyDpW+q/paifk/RQ9fNDkp5t
cCyf0y/LeLdaZlwNv3aNL3/u7j3/knS3pq7IvyXp35oYQ4txXSnpteprd9Njk/S0pk7rTmvq2sbD
ki6RtFnSXkn/J2lRH43tvzS1tPcOTQVrWUNju0VTp+g7JG2vvu5u+rULxtWT142PywJJcIEOSIKw
A0kQdiAJwg4kQdiBJAg7kARhB5L4f3Bf/8LCOdrHAAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
H2t6PcT2cVYyAAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
7EASfwUm7zAcd6+VvQAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD4CAYAAAAq5pAIAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0
dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAPz0lEQVR4nO3dX4xc5XnH8d/D+h/+b4Oxl42NU2Mh
TFEdZKCoqKKKElFuTG6i+KJyVZTNRZASKRdF9CJIVSVUNal6FWkjUJwqJYoECCuK6lDLKskFkf/g
gm1wvDU2trXrxdjG//+s9+nFHFcL7Hnf8ZyZOWM/34+02tl55uy8HPbnc2aeec9r7i4At77b6h4A
gO4g7EAQhB0IgrADQRB2IIhp3XwyM+Otf6DD3N2mur/Skd3MnjSz/WY2bGbPVfldADrLWu2zm1mf
pD9K+pqko5K2S9rg7vsS23BkBzqsE0f2RyQNu/tBd78i6ZeS1lf4fQA6qErYByQdmfTz0eK+zzCz
QTPbYWY7KjwXgIo6/gaduw9JGpI4jQfqVOXIfkzS8kk/f6m4D0APqhL27ZJWm9mXzWyGpG9J2tye
YQFot5ZP49193MyelbRFUp+kl919b9tGBqCtWm69tfRkvGYHOq4jH6oBcPMg7EAQhB0IgrADQRB2
IAjCDgTR1fnswI0wm7KD1DSunPxZHNmBIAg7EARhB4Ig7EAQhB0IgrADQdB6uwVUbVF18rlT9b6+
vkq/O+fatWultYmJieS2ufrNiCM7EARhB4Ig7EAQhB0IgrADQRB2IAjCDgRBn70LqvSim6nfdlv5
v9mpmiRNm5b+E5g5c2ayPn/+/GT9jjvuKK3Nmzcvue3Vq1eT9RMnTiTrH3/8cWntwoULlZ4714fv
xem1HNmBIAg7EARhB4Ig7EAQhB0IgrADQRB2IAj67G1QtU+em9edq6d65dOnT09um+uTL1++PFlf
u3Ztsn7fffeV1nJjO3LkSLK+ffv2ZP3SpUultVwfPTUXXsr30Xuxz14p7GZ2SNJZSdckjbv7unYM
CkD7tePI/lfunv4oE4Da8ZodCKJq2F3Sb81sp5kNTvUAMxs0sx1mtqPicwGooOpp/OPufszM7pL0
ppl94O5vTX6Auw9JGpIkM+u9dy2AICod2d39WPF9TNLrkh5px6AAtF/LYTezOWY27/ptSV+XtKdd
AwPQXlVO45dKer3oIU+T9B/u/p9tGVUPSvXKq/bRc3PKc/VUv3rOnDnJbZcsWZKsr1mzJll/9NFH
k/WVK1eW1s6cOZPcdmxsLFnP9cJT9U73wXN/E3X04VsOu7sflPRnbRwLgA6i9QYEQdiBIAg7EARh
B4Ig7EAQTHEtdHLp4Sqts2bqM2bMKK3Nnj07ue2iRYuS9dSloKX8paYvX75cWsu11j788MNk/dSp
U8n6lStXSmtVp7Dm9OIUV47sQBCEHQiCsANBEHYgCMIOBEHYgSAIOxBEmD57J5dNzi2LXPVS0VV+
f65Hf/vttyfrqR6+lO6jS+leeu5S0aOjo8n6p59+mqynLhd9M14KuiqO7EAQhB0IgrADQRB2IAjC
DgRB2IEgCDsQRJg+e1W5PnxKrmc7MTFRqZ4ya9asZD23ZHOuD5/7jEBq3vjFixeT26aWXJak8fHx
ZD2132/F+eo5HNmBIAg7EARhB4Ig7EAQhB0IgrADQRB2IIgwffZcX7TOPnruGua5+eypa7cvW7Ys
uW1qSWVJuueee5L1/v7+ZP306dPJekpuv+RU+X96K8oe2c3sZTMbM7M9k+5bbGZvmtmB4nt6pQEA
tWvmNP5nkp783H3PSdrq7qslbS1+BtDDsmF397cknfzc3eslbSpub5L0dJvHBaDNWn3NvtTdR4rb
o5KWlj3QzAYlDbb4PADapPIbdO7uZlb6DpW7D0kakqTU4wB0Vqutt+Nm1i9Jxff0cpwAatdq2DdL
2ljc3ijpjfYMB0CnZE/jzewVSU9IutPMjkr6oaQXJf3KzJ6RdFjSNzs5yG6och3xqn32XD84N2d8
yZIlpbWHHnooue1jjz2WrN97773Jeu669MPDw6W11HXdpfx+y+2XKm7F68pnw+7uG0pKX23zWAB0
EB+XBYIg7EAQhB0IgrADQRB2IIgwU1yrqtJ6qzq9Nne55wcffLC09vDDDye3feCBB5L13BTW3OWe
U8syT5uW/vObN29esp67zPWZM2dKa7diay2HIzsQBGEHgiDsQBCEHQiCsANBEHYgCMIOBEGfvQ2q
9mRnzJiRrN91113Jeupy0AsXLkxuO3fu3GQ91wvPXe45dSnp3H937jLY58+fT9Y/+eSTZD0ajuxA
EIQdCIKwA0EQdiAIwg4EQdiBIAg7EAR99i7ILbk8e/bsZH3BggXJ+vj4eGktt2Ryas63JF25ciVZ
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
7LvdZvZUTWNbbmbbzGyfme01s+8V99e67xLj6sp+6/prdjPrk/RHSV+TdFTSdkkb3H1fVwdSwswO
SVrn7rV/AMPM/lLSOUk/v760lpn9s6ST7v5i8Q/lInf/+x4Z2wu6wWW8OzS2smXG/1Y17rt2Ln/e
ijqO7I9IGnb3g+5+RdIvJa2vYRw9z93fknTyc3evl7SpuL1JjT+WrisZW09w9xF331XcPivp+jLj
te67xLi6oo6wD0g6Munno+qt9d5d0m/NbKeZDdY9mCksnbTM1qikpXUOZgrZZby76XPLjPfMvmtl
+fOqeIPuix5394ck/bWk7xanqz3JG6/Beql3+hNJq9RYA3BE0o/qHEyxzPirkr7v7mcm1+rcd1OM
qyv7rY6wH5O0fNLPXyru6wnufqz4PibpdTVedvSS49dX0C2+j9U8nv/n7sfd/Zq7T0j6qWrcd8Uy
469K+oW7v1bcXfu+m2pc3dpvdYR9u6TVZvZlM5sh6VuSNtcwji8wsznFGycyszmSvq7eW4p6s6SN
xe2Nkt6ocSyf0SvLeJctM66a913ty5+7e9e/JD2lxjvy/yvpH+oYQ8m4/kTS/xRfe+sem6RX1Dit
u6rGexvPSLpD0lZJByT9l6TFPTS2f1djae931QhWf01je1yNU/R3Je0uvp6qe98lxtWV/cbHZYEg
eIMOCIKwA0EQdiAIwg4EQdiBIAg7EARhB4L4P4MPdMXeLeL1AAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
Qfw/av3aBUq6Gy8AAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
/QMkz8YAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
xyUxtlo1a2y8jAeCIOxAEK0Oe1+LHz+lXcfWruOSGFutmjK2lr5nB9A8rT6yA2gSwg4E0ZKwm9kj
ZnbAzA6b2ZOtGEMZMxs0s/fMbG+r16cr1tAbNbP9k7YtNbNXzexQ8XXKNfZaNLanzWyoeO72mtmj
LRrbWjPbbWYfmNn7ZvbDYntLn7vEuJryvDX9PbuZdUg6KOkbko5LelvSNnf/oKkDKWFmg5K2uHvL
T8Aws7+SNCbplzeW1jKzf5H0ibs/U/xHebu7/0ObjO1pfcVlvBs0trJlxr+rFj539Vz+vBatOLLf
L+mwux9x93FJv5a0tQXjaHvu/rqkT76weaukHcXtHZr4ZWm6krG1BXcfdvd3i9vnJd1YZrylz11i
XE3RirB3Szo26fvjaq/13l3S783sHTPrbfVgptA5aZmtE5I6WzmYKWSX8W6mLywz3jbPXS3Ln1fF
B3Rf9oC7/7mkv5H0g+Llalvyifdg7dQ7/ZmkDZpYA3BY0k9aOZhimfEXJP3I3c9NrrXyuZtiXE15
3loR9iFJayd9v6bY1hbcfaj4OirpJU287WgnIzdW0C2+jrZ4PH/k7iPufs3dr0v6uVr43BXLjL8g
6Vfu/mKxueXP3VTjatbz1oqwvy2px8zWm9kcSd+RtLMF4/gSM5tffHAiM5sv6Ztqv6Wod0raXtze
LunlFo7lc9plGe+yZcbV4ueu5cufu3vT/0h6VBOfyH8k6R9bMYaScf2JpP7iz/utHpuk5zXxsu6K
Jj7beFzSMkmvSTok6b8lLW2jsf2HJpb23qeJYHW1aGwPaOIl+j5Je4s/j7b6uUuMqynPG6fLAkHw
AR0QBGEHgiDsQBCEHQiCsANBEHYgCMIOBPH/gLZpWFtbQVcAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;

&lt;script type=&quot;application/vnd.jupyter.widget-state+json&quot;&gt;
{&quot;5e76c34dd901463b9fbdeb1c48d54088&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;_dom_classes&quot;: [], &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;layout&quot;: &quot;IPY_MODEL_47276df89ad84945954602713f386748&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;children&quot;: [&quot;IPY_MODEL_027b9860761e455bb095c3c3e683ffe2&quot;, &quot;IPY_MODEL_884e8a83e9c14d2bb2ae9353b225cdc9&quot;]}}, &quot;47276df89ad84945954602713f386748&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;027b9860761e455bb095c3c3e683ffe2&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;IntProgressModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;style&quot;: &quot;IPY_MODEL_a5299502abd64731ac5fb15e978a3f99&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;IntProgressModel&quot;, &quot;bar_style&quot;: &quot;info&quot;, &quot;max&quot;: 1, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: 1, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;min&quot;: 0, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_87ad92c50cba440ab5d2db237b4f1413&quot;}}, &quot;884e8a83e9c14d2bb2ae9353b225cdc9&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;style&quot;: &quot;IPY_MODEL_393dd41007a04fcfa050697cb736cbc1&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: &quot; 9920512/? [06:00&amp;lt;00:00, 29762.07it/s]&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_d24df2cae33b4eaa9068b0174872511a&quot;}}, &quot;a5299502abd64731ac5fb15e978a3f99&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;description_width&quot;: &quot;initial&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;bar_color&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;87ad92c50cba440ab5d2db237b4f1413&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;393dd41007a04fcfa050697cb736cbc1&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;description_width&quot;: &quot;&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;d24df2cae33b4eaa9068b0174872511a&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;30ac7ad7b4c84d988c5fca9f669a23c3&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;_dom_classes&quot;: [], &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;layout&quot;: &quot;IPY_MODEL_79a238e2fc614c0b868804d9d4c4b162&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;children&quot;: [&quot;IPY_MODEL_c1ad885f0b43495db070a3e8f0abfcb5&quot;, &quot;IPY_MODEL_52deed4db1c14ba9b42741e55d6dc959&quot;]}}, &quot;79a238e2fc614c0b868804d9d4c4b162&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;c1ad885f0b43495db070a3e8f0abfcb5&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;IntProgressModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;style&quot;: &quot;IPY_MODEL_6f81bcf6acc44f52bd0cc039e4c8929d&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;IntProgressModel&quot;, &quot;bar_style&quot;: &quot;info&quot;, &quot;max&quot;: 1, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: 1, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;min&quot;: 0, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_8e8a92f8b0724e7e81d99b1e3e0f7591&quot;}}, &quot;52deed4db1c14ba9b42741e55d6dc959&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;style&quot;: &quot;IPY_MODEL_3d2338b4d37d447b9456d23f6b9275aa&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: &quot; 32768/? [00:15&amp;lt;00:00, 111824.10it/s]&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_72246747eb8b42f495400076fa5f015c&quot;}}, &quot;6f81bcf6acc44f52bd0cc039e4c8929d&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;description_width&quot;: &quot;initial&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;bar_color&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;8e8a92f8b0724e7e81d99b1e3e0f7591&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;3d2338b4d37d447b9456d23f6b9275aa&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;description_width&quot;: &quot;&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;72246747eb8b42f495400076fa5f015c&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;48eec7d5e37a4e63bb4972065a5c5a37&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;_dom_classes&quot;: [], &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;layout&quot;: &quot;IPY_MODEL_56afeafb750f450193d253c18eaec478&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;children&quot;: [&quot;IPY_MODEL_05db3d36ffed4ef4be7c5d03a134d362&quot;, &quot;IPY_MODEL_d01eef2562e9458c8ceebb57c47a5fe0&quot;]}}, &quot;56afeafb750f450193d253c18eaec478&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;05db3d36ffed4ef4be7c5d03a134d362&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;IntProgressModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;style&quot;: &quot;IPY_MODEL_653c852c95b442aa95fed3f005c696ce&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;IntProgressModel&quot;, &quot;bar_style&quot;: &quot;info&quot;, &quot;max&quot;: 1, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: 1, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;min&quot;: 0, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_6f44c36dcea34304bb6da6d7965b56ca&quot;}}, &quot;d01eef2562e9458c8ceebb57c47a5fe0&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;style&quot;: &quot;IPY_MODEL_7ccff9fe7a0b4d7eab4b5c94ffd45440&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: &quot; 1654784/? [01:15&amp;lt;00:00, 34654.63it/s]&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_d04ae96983144e5b99f11dd8264ec7f3&quot;}}, &quot;653c852c95b442aa95fed3f005c696ce&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;description_width&quot;: &quot;initial&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;bar_color&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;6f44c36dcea34304bb6da6d7965b56ca&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;7ccff9fe7a0b4d7eab4b5c94ffd45440&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;description_width&quot;: &quot;&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;d04ae96983144e5b99f11dd8264ec7f3&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;02635a9a3dce4920b295925354d72659&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;_dom_classes&quot;: [], &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;layout&quot;: &quot;IPY_MODEL_b73c2cf3fe074e8dad9ff81caf558aec&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;children&quot;: [&quot;IPY_MODEL_bf9aac33a0844b7a8655656806b622c7&quot;, &quot;IPY_MODEL_1cdadc66c5a5448e8dde34a2b8d726a5&quot;]}}, &quot;b73c2cf3fe074e8dad9ff81caf558aec&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;bf9aac33a0844b7a8655656806b622c7&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;IntProgressModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;style&quot;: &quot;IPY_MODEL_6e89c5b1d4cc4e1ea9491a41b7b28c53&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;  0%&quot;, &quot;_model_name&quot;: &quot;IntProgressModel&quot;, &quot;bar_style&quot;: &quot;info&quot;, &quot;max&quot;: 1, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: 0, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;min&quot;: 0, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_407d309cd2cc49d78f3f60cb3fa8a6e5&quot;}}, &quot;1cdadc66c5a5448e8dde34a2b8d726a5&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;style&quot;: &quot;IPY_MODEL_ba351c402b0b4e87a37cb78887b618cb&quot;, &quot;_dom_classes&quot;: [], &quot;description&quot;: &quot;&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;value&quot;: &quot; 0/4542 [00:00&amp;lt;?, ?it/s]&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;description_tooltip&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;layout&quot;: &quot;IPY_MODEL_8822fe89cb0e4c9da6d94b029a1e3a6b&quot;}}, &quot;6e89c5b1d4cc4e1ea9491a41b7b28c53&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;description_width&quot;: &quot;initial&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;bar_color&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;407d309cd2cc49d78f3f60cb3fa8a6e5&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}, &quot;ba351c402b0b4e87a37cb78887b618cb&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;StyleView&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;description_width&quot;: &quot;&quot;, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_count&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;}}, &quot;8822fe89cb0e4c9da6d94b029a1e3a6b&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;grid_template_rows&quot;: null, &quot;right&quot;: null, &quot;justify_content&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;overflow&quot;: null, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_count&quot;: null, &quot;flex_flow&quot;: null, &quot;width&quot;: null, &quot;min_width&quot;: null, &quot;border&quot;: null, &quot;align_items&quot;: null, &quot;bottom&quot;: null, &quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;top&quot;: null, &quot;grid_column&quot;: null, &quot;overflow_y&quot;: null, &quot;overflow_x&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_template_columns&quot;: null, &quot;flex&quot;: null, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;justify_items&quot;: null, &quot;grid_row&quot;: null, &quot;max_height&quot;: null, &quot;align_content&quot;: null, &quot;visibility&quot;: null, &quot;align_self&quot;: null, &quot;height&quot;: null, &quot;min_height&quot;: null, &quot;padding&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_gap&quot;: null, &quot;max_width&quot;: null, &quot;order&quot;: null, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;grid_template_areas&quot;: null, &quot;object_position&quot;: null, &quot;object_fit&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;margin&quot;: null, &quot;display&quot;: null, &quot;left&quot;: null}}}
&lt;/script&gt;</content><author><name>Wontak Ryu</name></author><summary type="html"></summary></entry><entry><title type="html">Missing Semester 정리글</title><link href="https://fastpages.fast.ai/blog/shell/bash/2020/03/05/missing-semeste-%EC%A0%95%EB%A6%AC%EA%B8%80.html" rel="alternate" type="text/html" title="Missing Semester 정리글" /><published>2020-03-05T00:00:00-06:00</published><updated>2020-03-05T00:00:00-06:00</updated><id>https://fastpages.fast.ai/blog/shell/bash/2020/03/05/missing-semeste-%EC%A0%95%EB%A6%AC%EA%B8%80</id><content type="html" xml:base="https://fastpages.fast.ai/blog/shell/bash/2020/03/05/missing-semeste-%EC%A0%95%EB%A6%AC%EA%B8%80.html">&lt;h1 id=&quot;missing-semester-정리글&quot;&gt;Missing Semester 정리글&lt;/h1&gt;

&lt;h2 id=&quot;1-shell&quot;&gt;1. Shell&lt;/h2&gt;

&lt;p&gt;리눅스의 쉘은 명령어와 프로그램을 실행할 때 사용하는 인터페이스이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/2020-03-05-missing-semeste-정리글/shell.png&quot; alt=&quot;&quot; title=&quot;Shell&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;echo&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;리눅스 명령어 echo는 주어진 문자열을, 문자열 사이에 포함된 공백과 줄 마지막에 개행문자를 포함하여 표준출력으로 출력하는 명령어다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo &quot;Hellow Wolrd&quot;
&amp;gt;&amp;gt;&amp;gt; Hellow World

echo Hellow\ Wolrd
&amp;gt;&amp;gt;&amp;gt; Hellow World

echo $HOME
&amp;gt;&amp;gt;&amp;gt; /root

echo $PATH
&amp;gt;&amp;gt;&amp;gt; $PATH에 포함된 주소들을 출력

which echo
&amp;gt;&amp;gt;&amp;gt; /usr/bin/echo # 사용하고 있는 echo 위치 출력

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;pwd&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pwd
&amp;gt;&amp;gt;&amp;gt; /home # present working directory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;cd&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd /roundtable # change directory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;. (dot) / .. (dot dot)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.. # parent directory
cd .. # /home/roundtable -&amp;gt; /home

. # current directory
cd ./roundtable # /home -&amp;gt; /home/roundtable
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;ls&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ls
&amp;gt;&amp;gt;&amp;gt; print all files in the current directory
ls -help
&amp;gt;&amp;gt;&amp;gt; 다양한 옵션에 대한 정보를 받아볼 수 있음
ls -l
&amp;gt;&amp;gt;&amp;gt; 파일에 대한 추가적인 정보를 얻을 수 있음
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;~&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd ~ # home directory
cd ~/roundtable # cd /home/roundtable
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;cd -&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd - # back to parent directory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;mv&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mv &amp;lt;current_file&amp;gt; &amp;lt;new_file&amp;gt; # rename the file or move the file in dirrent directory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;cp&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cp &amp;lt;current_file&amp;gt; &amp;lt;new_file&amp;gt; # copy
cp -r &amp;lt;current folder&amp;gt; &amp;lt;new_folder&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;rm&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rm &amp;lt;current_file&amp;gt; # remove
rmdir &amp;lt;folder&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;mkdir&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mkdir &amp;lt;new directory name&amp;gt; # make directory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;man&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;man ls # manual page for ls
# if you want to quik, press q
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;ctrl + l&lt;/strong&gt;: clear the terminal&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Angle bracket signs&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;input stream, output stream이 존재한다. 이를 적절히 조절할 수 있다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# &amp;lt; file 
# &amp;gt; file

echo hello &amp;gt; hello.txt # hello(print)가 hello.txt의 입력으로 들어간다.
cat hello.txt
&amp;gt;&amp;gt;&amp;gt; hello

cat &amp;lt; hello.txt &amp;gt; hello2.txt
cat hello2.txt
&amp;gt;&amp;gt;&amp;gt; hello
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;**&lt;/td&gt;
      &lt;td&gt;(pipe)**&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# file1 | file2 # make output of file1 input of file2
# tail # 마지막 line만 출력해준다.

ls -l / tail -n1
&amp;gt;&amp;gt;&amp;gt; drwxrwxr-x 11 ubuntu ubuntu 4096 Mar  4 12:55 dev # print last line

curl --head --silent google.com | grep -i content-length
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;tail&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;마지막 line만 출력해준다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;curl&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl --head --silent google.com | grep -i content-length
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;sudo: root permission&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo find -L /sys/class/backlight -maxdepth 2 -name '*brightness*'
&amp;gt;&amp;gt;&amp;gt; /sys/class/backlight/thinkpad_screen/brightness

cd /sys/class/backlight/thinkpad_screen

sudo echo 3 &amp;gt; brightness

&amp;gt;&amp;gt;&amp;gt; An error occurred while redirecting file 'brightness'
open: Permission denied


echo 3 | sudo tee brightness
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;cat&lt;/strong&gt;: concatenate&lt;/p&gt;

&lt;p&gt;파일의 내용을 출력&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cat file1
# file1의 내용 출력

cat file1 file2 file3
# file1, file2, file3 이어서 출력

cat &amp;gt; file1 # (내용을 입력하고 ctrl + d를 눌러 저장한다.) 기존 내용을 지우고
cat &amp;gt;&amp;gt; file1 # (내용을 입력하고 ctrl + d를 눌러 저장한다.) 기존의 내용에 이어서

cat file1 file2 &amp;gt; file3 # file1 + file2 = file3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;cd /sys&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd /sys # to access various kernel parameters

total 0
drwxr-xr-x   2 root root  0 Mar  5 08:03 block
drwxr-xr-x  47 root root  0 Mar  3 06:53 bus
drwxr-xr-x  69 root root  0 Mar  3 06:51 class
drwxr-xr-x   4 root root  0 Mar  5 08:03 dev
drwxr-xr-x  71 root root  0 Mar  3 04:43 devices
drwxrwxrwt   2 root root 40 Mar  3 04:43 firmware
drwxr-xr-x  12 root root  0 Mar  3 04:43 fs
drwxr-xr-x   2 root root  0 Mar  5 08:03 hypervisor
drwxr-xr-x  14 root root  0 Mar  5 08:03 kernel
drwxr-xr-x 219 root root  0 Mar  5 08:03 module
drwxr-xr-x   2 root root  0 Mar  5 08:03 power
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;shell은 단순한 argument가 아니라 일종의 프로그래밍이라고 볼 수 있다. 예를 들어서 조건문이나 반복문같은 설정을 할 수 있다.&lt;/p&gt;

&lt;h2 id=&quot;2-shell-tools-and-scripting&quot;&gt;2. Shell Tools and Scripting&lt;/h2&gt;

&lt;p&gt;’’ 하고 “” 는 유사해보이지만, 서로 다르다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;foo=bar
echo &quot;$foo&quot;
# prints bar
echo '$foo'
# prints $foo

echo &quot;Value is $foo&quot;
# prints 'Value is foo'

echo 'Value is $foo'
# prints 'Value is $foo'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;bash는  if, case, while, for와 같은 구문을 제공한다.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mcd (){
	mkdir -p &quot;$1&quot;
	cd &quot;$1&quot;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/home: vim mcd.sh
/home: source mcd.sh
/home: mcd.sh test

/home/test:  # /home -&amp;gt; mkdir /home/test -&amp;gt; cd /home/test
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;$0 - Name of the script&lt;/li&gt;
  &lt;li&gt;$1 to $9 - Arguments to the script. $1 is the first argument and so on.&lt;/li&gt;
  &lt;li&gt;$@ - All the arguments&lt;/li&gt;
  &lt;li&gt;$# - Number of arguments&lt;/li&gt;
  &lt;li&gt;$? - Return code of the previous command&lt;/li&gt;
  &lt;li&gt;$$ - Process Identification number for the current script&lt;/li&gt;
  &lt;li&gt;!! - Entire last command, including arguments. A common pattern is to execute a command only for it to fail due to missing permissions, then you can quickly execute it with sudo by doing sudo !!&lt;/li&gt;
  &lt;li&gt;$_ - Last argument from the last command. If you are in an interactive shell, you can also quickly get this value by typing Esc followed by .&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo &quot;Hello&quot;
&amp;gt;&amp;gt;&amp;gt; Hello

echo $?
&amp;gt;&amp;gt;&amp;gt; 0 # No Error

grep foobar mcd.sh
echo $?
&amp;gt;&amp;gt;&amp;gt; 1 # Error
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# || or
false || echo &quot;Oops, fail&quot; 
# Oops, fail


true || echo &quot;Will not be printed&quot;
#

# &amp;amp;&amp;amp; and
true &amp;amp;&amp;amp; echo &quot;Things went well&quot;
# Things went well

false &amp;amp;&amp;amp; echo &quot;Will not be printed&quot;
#

false ; echo &quot;This will always run&quot;
# This will always run
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Starting program at &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Date will be substituted&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Running program &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; with &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$# &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;arguments with pid &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;file &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;foobar &lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /dev/null 2&amp;gt; /dev/null
    &lt;span class=&quot;c&quot;&gt;# When pattern is not found, grep has exit status 1&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# We redirect STDOUT and STDERR to a null register since we do not care about them&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;File &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; does not have any foobar, adding one&quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;# foobar&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi
done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;?&lt;/strong&gt; : one of character
***** : any amount of characters&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
convert image.{png,jpg}
# Will expand to
convert image.png image.jpg

cp /path/to/project/{foo,bar,baz}.sh /newpath
# Will expand to
cp /path/to/project/foo.sh /path/to/project/bar.sh /path/to/project/baz.sh /newpath

# Globbing techniques can also be combined
mv *{.py,.sh} folder
# Will move all *.py and *.sh files


mkdir foo bar
# This creates files foo/a, foo/b, ... foo/h, bar/a, bar/b, ... bar/h
touch {foo,bar}/{a..j}
touch foo/x bar/y
# Show differences between files in foo and bar
diff &amp;lt;(ls foo) &amp;lt;(ls bar)
# Outputs
# &amp;lt; x
# ---
# &amp;gt; y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;in python&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Shebang&lt;/strong&gt;은 (사전에 검색해보면) 쉬뱅이라고 읽습니다. 쉬뱅은 &lt;code class=&quot;highlighter-rouge&quot;&gt;#!&lt;/code&gt;로 시작하는 문자열이며 스크립트의 맨 첫번째 라인에 있습니다. 쉬뱅은 유닉스 계열 운영체제에서 스크립트가 실행될 때, 파이썬, 배쉬쉘 등 어떤 인터프리터에 의해서 동작이 되는지 알려줍니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/local/bin/python
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;reversed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;shellcheck&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ shellcheck test.sh

In test.sh line 2:
T0=`date +%s`
   ^-- SC2006: Use $(..) instead of legacy `..`.

In test.sh line 4:
T1=`date +%s`
   ^-- SC2006: Use $(..) instead of legacy `..`.

In test.sh line 5:
ELAPSED_TIME=$((T1-T0))
^-- SC2034: ELAPSED_TIME appears unused. Verify it or export it.

In test.sh line 7:
echo &quot;START_TIME: &quot; ${T0}
                    ^-- SC2086: Double quote to prevent globbing and word splitting.

In test.sh line 8:
echo &quot;END_TIME: &quot; ${T1}
                  ^-- SC2086: Double quote to prevent globbing and word splitting.

In test.sh line 9:
echo &quot;ELAPSED_TIME: ${ELAPSES_TIME} sec&quot;
                    ^-- SC2153: Possible misspelling: ELAPSES_TIME may not be assigned, but ELAPSED_TIME is.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;export&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;환경변수를 저장하는 역할, 터미널이 꺼지면 사라진다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vi ~/.bashrc # 해당 주소에서 작업을 하게되면 영구적으로 남는다.

export water=&quot;삼다수&quot;
export TEMP_DIR=/tmp
export BASE_DIR=$TEMP_DIR/backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# gpu idx를 지정할 때 사용할 수도 있다.

export CUDA_VISIBLE_DEVICES = 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Finding how to use commands&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ls -h
ls --help

man ls
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;manpage&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://tldr.sh/&quot;&gt;TLDR pages&lt;/a&gt;: 간단하게 찾아볼 수 있음&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Finding files&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Find all directories named src
find . -name src -type d
# Find all python files that have a folder named test in their path
find . -path '**/test/**/*.py' -type f
# Find all files modified in the last day
find . -mtime -1
# Find all zip files with size in range 500k to 10M
find . -size +500k -size -10M -name '*.tar.gz'

# Delete all files with .tmp extension
find . -name '*.tmp' -exec rm {} \;
# Find all PNG files and convert them to JPG
find . -name '*.png' -exec convert {} {.}.jpg \;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Finding code&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://man7.org/linux/man-pages/man1/grep.1.html&quot;&gt;&lt;strong&gt;grep&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;grep foobar mcd.sh
grep -R foobar . # source code 검색도 가능
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/BurntSushi/ripgrep&quot;&gt;&lt;strong&gt;ripgrep&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Find all python files where I used the requests library
rg -t py 'import requests'
# Find all files (including hidden files) without a shebang line
rg -u --files-without-match &quot;^#!&quot;
# Find all matches of foo and print the following 5 lines
rg foo -A 5
# Print statistics of matches (# of matched lines and files )
rg --stats PATTERN
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Finding shell commands&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;history&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;history

 1 cd .\OneDrive\sourceCode\CPPS\
 2 cd ..
 3 cd .\EEN-with-Keras\

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Ctrl + R&lt;/strong&gt; : history 추적, 유용&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;zsh&lt;/strong&gt;: 유용한 bash 도구&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Directory Naviation&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ls -R&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://linux.die.net/man/1/tree&quot;&gt;tree&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/Canop/broot&quot;&gt;broot&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;nnn&lt;/li&gt;
  &lt;li&gt;ranger&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ls -R
tree 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;3-git&quot;&gt;3. Git&lt;/h2&gt;

&lt;h3 id=&quot;gits-data-model&quot;&gt;Git’s data model&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;snapshots&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;root&amp;gt; (tree): snapshots, top-level directory
|
+- foo (tree)
|  |
|  + bar.txt (blob, contents = &quot;hello world&quot;)
|
+- baz.txt (blob, contents = &quot;git is wonderful&quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Modeling history: relating snapshots&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;o &amp;lt;-- o &amp;lt;-- o &amp;lt;-- o
^  
\
--- o &amp;lt;-- o
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;with the newly created merge commit shown in bold:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;o &amp;lt;-- o &amp;lt;-- o &amp;lt;-- o &amp;lt;---- o
            ^            /
             \          v
              --- o &amp;lt;-- o
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// a file is a bunch of bytes
type blob = array&amp;lt;byte&amp;gt;

// a directory contains named files and directories
type tree = map&amp;lt;string, tree | file&amp;gt;

// a commit has parents, metadata, and the top-level tree
type commit = struct {
    parent: array&amp;lt;commit&amp;gt;
    author: string
    message: string
    snapshot: tree
}

type object = blob | tree | commit # 모두 다 object다


objects = map&amp;lt;string, object&amp;gt;

def store(object):
    id = sha1(object)
    objects[id] = object

def load(id):
    return objects[id]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;References&lt;/strong&gt;: HEAD&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;references = map&amp;lt;string, string&amp;gt;

def update_reference(name, id):
    references[name] = id

def read_reference(name):
    return references[name]

def load_reference(name_or_id):
    if name_or_id in references:
        return load(references[name_or_id])
    else:
        return load(name_or_id)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hook&quot;&gt;Hook&lt;/h3&gt;

&lt;p&gt;특정상황에서 특정 스크립트를 실행할 수 있도록 하는 기능&lt;/p&gt;

&lt;p&gt;위치: cd ./git/hook&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/sh&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# git diff --exit-code --cached --name-only --diff-filter=ACM -- '*.png' '*.jpg'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 위의 명령어는 현재 add 되어있는 파일 중, .png와 .jpg 확장자를 가진 파일들을 '이름만' 추출합니다.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;git diff &lt;span class=&quot;nt&quot;&gt;--exit-code&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cached&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name-only&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--diff-filter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ACM &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'*.png'&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'*.jpg'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 추출된 이미지 파일들을 ImageOptimCLI에 넘겨주기만 하면 되는 것이죠!&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 이미지들이 압축되어 변경되었으니 다시 add 해줘야겠죠?&lt;/span&gt;
&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$images&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | ~/.woowa/imageoptim-cli/bin/imageOptim &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; git add &lt;span class=&quot;nv&quot;&gt;$images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;pre-commit&lt;/strong&gt;: https://pre-commit.com/&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;reference: https://woowabros.github.io/tools/2017/07/12/git_hook.html&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;github-deployment--actions&quot;&gt;Github Deployment &amp;amp; Actions&lt;/h3&gt;

&lt;p&gt;https://blog.banksalad.com/tech/become-an-organization-that-deploys-1000-times-a-day/?fbclid=IwAR1X6CC1mz6Akrxcyt-BpeMZ-ZnpLOvdGlK7dvxh0De85D1qsEoLN2JEhAU&lt;/p&gt;

&lt;h3 id=&quot;git-command-line-interface&quot;&gt;Git command-line interface&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git help &amp;lt;command&amp;gt;: get help for a git command
git init: creates a new git repo, with data stored in the .git directory
git status: tells you what’s going on
git add &amp;lt;filename&amp;gt;: adds files to staging area
git commit: creates a new commit
git log: shows a flattened log of history
git log --all --graph --decorate: visualizes history as a DAG
git diff &amp;lt;filename&amp;gt;: show differences since the last commit
git diff &amp;lt;revision&amp;gt; &amp;lt;filename&amp;gt;: shows differences in a file between snapshots
git checkout &amp;lt;revision&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Branching and merging&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git branch: shows branches
git branch &amp;lt;name&amp;gt;: creates a branch
git checkout -b &amp;lt;name&amp;gt;: creates a branch and switches to it
same as git branch &amp;lt;name&amp;gt;; git checkout &amp;lt;name&amp;gt;
git merge &amp;lt;revision&amp;gt;: merges into current branch
git mergetool: use a fancy tool to help resolve merge conflicts
git rebase: rebase set of patches onto a new base
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Remotes&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git remote: list remotes
git remote add &amp;lt;name&amp;gt; &amp;lt;url&amp;gt;: add a remote
git push &amp;lt;remote&amp;gt; &amp;lt;local branch&amp;gt;:&amp;lt;remote branch&amp;gt;: send objects to remote, and update remote reference
git branch --set-upstream-to=&amp;lt;remote&amp;gt;/&amp;lt;remote branch&amp;gt;: set up correspondence between local and remote branch
git fetch: retrieve objects/references from a remote
git pull: same as git fetch; git merge
git clone: download repository from remote
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Undo&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git commit --amend: edit a commit’s contents/message
git reset HEAD &amp;lt;file&amp;gt;: unstage a file
git checkout -- &amp;lt;file&amp;gt;: discard changes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;https://git-scm.com/book/en/v2&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;github로-협업하기&quot;&gt;Github로 협업하기&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;checkout&lt;/strong&gt;
https://mytory.net/archives/10078&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;stash&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;특정 커밋 선택해서 반영하기:cherry pick&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git cherry-pick {Commit ID}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;여러개의 커밋을 반영하기: rebase&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git rebase {가져올 Branch 이름}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;https://www.tuwlab.com/ece/22218&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;github-actions&quot;&gt;&lt;strong&gt;Github Actions&lt;/strong&gt;&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Build&lt;/p&gt;

    &lt;p&gt;코드 스타일 검사를 위한 lint&lt;/p&gt;

    &lt;p&gt;유닛 테스트를 실행하는 test&lt;/p&gt;

    &lt;p&gt;docker image를 build하는 build&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Deploy&lt;/p&gt;

    &lt;p&gt;아직은 경험하기 힘든 영역이라고 생각&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;gitflow&quot;&gt;Gitflow&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;github-slack-integration&quot;&gt;Github slack integration&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;https://slack.github.com/&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;http://wepla.net/?p=2353&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;github-commit-message&quot;&gt;Github Commit message&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Type: 제목

본문

꼬리말
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;feat: 새로운 기능을 추가할 경우
fix: 버그를 고친 경우
docs: 문서 수정한 경우
style: 코드 포맷 변경, 세미 콜론 누락, 코드 수정이 없는 경우
refactor: 프로덕션 코드 리팩터링
test: 테스트 추가, 테스트 리팩터링 (프로덕션 코드 변경 없음)
chore: 빌드 테스크 업데이트, 패키지 매니저 설정할 경우 (프로덕션 코드 변경 없음)&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;feat: Summarize changes in around 50 characters or less

More detailed explanatory text, if necessary. Wrap it to about 72
characters or so. In some contexts, the first line is treated as the
subject of the commit and the rest of the text as the body. The
blank line separating the summary from the body is critical (unless
you omit the body entirely); various tools like `log`, `shortlog`
and `rebase` can get confused if you run the two together.

Explain the problem that this commit is solving. Focus on why you
are making this change as opposed to how (the code explains that).
Are there side effects or other unintuitive consequenses of this
change? Here's the place to explain them.

Further paragraphs come after blank lines.

 - Bullet points are okay, too

 - Typically a hyphen or asterisk is used for the bullet, preceded
   by a single space, with blank lines in between, but conventions
   vary here

If you use an issue tracker, put references to them at the bottom,
like this:

Resolves: #123
See also: #456, #789
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;https://sujinlee.me/professional-github/&lt;/li&gt;
  &lt;li&gt;https://junwoo45.github.io/2020-02-06-commit_template/?fbclid=IwAR2HKgwO9imOxWAvWUPtaXDymUzMRRJ18LnwR_Cwa3s6kcrFidIwvz8CvmY&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;4-python-ci-핑퐁팀-사례&quot;&gt;4. &lt;a href=&quot;https://blog.pingpong.us/python-in-pingpong/?fbclid=IwAR0ijQfAoKTFtXsppYN-b9iqw_vnnR6VoEMcL9Wr8TJFUyHnuOBwBgyHCZw#%EC%8B%9C%EC%9E%91%EC%9D%80-%EA%B0%80%EB%B3%8D%EA%B2%8C-%EC%BD%94%EB%93%9C-%ED%92%88%EC%A7%88-%EA%B4%80%EB%A6%AC-%EB%8F%84%EA%B5%AC&quot;&gt;Python CI: 핑퐁팀 사례&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;코드 스타일 확인 및 포맷 자동화&lt;/strong&gt;**&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://github.com/psf/black&quot;&gt;black&lt;/a&gt;
  Python Software Foundation에서 작성한 Python 자동 포맷팅 도구입니다. pycodestyle을 따른다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;flake8&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;pycodestyle + pyflakes + 복잡도 검사 기능&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;Python Code Quality Authority (PyCQA)에서 작성한 스타일 체크 도구로, 플러그인을 붙이기 쉬운 것이 장점이다. docstring 형식 부분을 잡아내기 위해서 적용하기도 한다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;yapf
  구글에서 배포하는 자동 포맷팅 도구입니다. 다른 포맷팅 도구들이 스타일 가이드를 어긴 부분만 잡아준다면, yapf는 스타일 가이드를 어기지 않았더라도 다시 포맷팅을 진행하는 상당히 엄격한 자동 포맷팅 도구입니다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;isort: import statement 정렬하는 도구&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Type Checker&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Type Hints란, 예상치 못한 타입이 변수에 할당되는 것을 검사기가 막아주는 역할을 한다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/microsoft/pyright&quot;&gt;pyright&lt;/a&gt;: vscode와 연동가능&lt;/li&gt;
  &lt;li&gt;mypy&lt;/li&gt;
  &lt;li&gt;pyre-check&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;CI&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CircleCI&lt;/li&gt;
  &lt;li&gt;Jenkins Blueocean&lt;/li&gt;
  &lt;li&gt;GitHub Actions&lt;/li&gt;
  &lt;li&gt;travisCI&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;테스트 코드&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.pytest.org/en/latest/&quot;&gt;pytest&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;unittest&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Code Coverage&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;pytest-cov&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;초기 템플릿 생성&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;5-debugging-and-profiling&quot;&gt;5. Debugging and Profiling&lt;/h2&gt;

&lt;h3 id=&quot;logging&quot;&gt;Logging&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;print문 삽입하는 법&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.python.org/ko/3/howto/logging.html&quot;&gt;log&lt;/a&gt;: 일반적으로 log가 더 좋은 방법&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Log의 장점&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;log를 사용하면 file로 저장할 수 있다. (remote server에도 가능)&lt;/li&gt;
  &lt;li&gt;Serverity level별로 나타낼 수 있다.
    &lt;ol&gt;
      &lt;li&gt;INFO&lt;/li&gt;
      &lt;li&gt;DEBUG&lt;/li&gt;
      &lt;li&gt;WARN&lt;/li&gt;
      &lt;li&gt;ERROR&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;새로운 이슈가 추가될 때, 더 골고루 살펴볼 수 있다.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;python logging 모듈 활용하기&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;logging&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# logger instance
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# handler
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;streamHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StreamHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fileHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FileHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'./server.log'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;streamHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FileHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setLevel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DEBUG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;debug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'원하는 log 문 작성하기'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;https://hamait.tistory.com/880&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;debugger&quot;&gt;Debugger&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.python.org/3/library/pdb.html&quot;&gt;pdb&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;static-analysis&quot;&gt;Static Analysis&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://www.shellcheck.net/&quot;&gt;shellcheck&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;linting&quot;&gt;linting&lt;/h3&gt;

&lt;p&gt;잠재적인 오류에 대한 코드를 분석하는 프로그램.&lt;/p&gt;

&lt;p&gt;flake8을 이용하여 진행할 수 있다.&lt;/p&gt;

&lt;h3 id=&quot;profiling&quot;&gt;Profiling&lt;/h3&gt;

&lt;h4 id=&quot;timing&quot;&gt;Timing&lt;/h4&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get current time
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Do some work
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Sleeping for {} ms&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Compute time between start and now
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Output
# Sleeping for 500 ms
# 0.5713930130004883
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;위의 예시처럼 시간을 측정하면, 실제 시간과 차이가 나는 경우가 있다. 예를 들면, 다른 작업이 cpu를 할당 받고 있어서 그 후에 실행된 경우가 그러한 경우이다. 따라서, 해당 소스코드의 동작시간을 알고 싶다면, User가 사용한 시간 + system이 사용한 시간을 더해서 구할 수 있다. (User + Sys)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Real - Wall clock elapsed time from start to finish of the program, including the time taken by other processes and time taken while blocked (e.g. waiting for I/O or network)&lt;/li&gt;
  &lt;li&gt;User - Amount of time spent in the CPU running user code&lt;/li&gt;
  &lt;li&gt;Sys - Amount of time spent in the CPU running kernel code&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;profilers&quot;&gt;Profilers&lt;/h4&gt;
&lt;h5 id=&quot;cpu&quot;&gt;CPU&lt;/h5&gt;

&lt;p&gt;tracing, sampling profilers 두 가지의 종류가 있다.&lt;/p&gt;

&lt;p&gt;tracing profiler는 모든 function call을 기록하는 반면에 sampling profiler는 특정 간격마다 기록한다.&lt;/p&gt;

&lt;p&gt;python의 경우 cProfile 모듈을 이용할 수 있다. 아래와 같은 소스코드가 있다고 가정하자.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;grep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'r'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;pattern&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;{}: {}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'__main__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;times&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pattern&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;times&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;grep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;아래와 같이 프로파일링을 진행할 수 있다. 모든 function call을 확인할 수 있다.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ python -m cProfile -s tottime grep.py 1000 '^(import|\s*def)[^,]*$' *.py

[omitted program output]

 ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     8000    0.266    0.000    0.292    0.000 {built-in method io.open}
     8000    0.153    0.000    0.894    0.000 grep.py:5(grep)
    17000    0.101    0.000    0.101    0.000 {built-in method builtins.print}
     8000    0.100    0.000    0.129    0.000 {method 'readlines' of '_io._IOBase' objects}
    93000    0.097    0.000    0.111    0.000 re.py:286(_compile)
    93000    0.069    0.000    0.069    0.000 {method 'search' of '_sre.SRE_Pattern' objects}
    93000    0.030    0.000    0.141    0.000 re.py:231(compile)
    17000    0.019    0.000    0.029    0.000 codecs.py:318(decode)
        1    0.017    0.017    0.911    0.911 grep.py:3(&amp;lt;module&amp;gt;)

[omitted lines]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;line마다 profiling 하고 싶다면, kernprof를 사용할 수 있다. 단, 데코레이터를 사용해야한다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;bs4&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BeautifulSoup&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# This is a decorator that tells line_profiler
# that we want to analyze this function
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_urls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'https://missing.csail.mit.edu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BeautifulSoup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'lxml'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;urls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'a'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'href'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'__main__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;get_urls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ kernprof -l -v a.py
Wrote profile results to urls.py.lprof
Timer unit: 1e-06 s

Total time: 0.636188 s
File: a.py
Function: get_urls at line 5

Line #  Hits         Time  Per Hit   % Time  Line Contents
==============================================================
 5                                           @profile
 6                                           def get_urls():
 7         1     613909.0 613909.0     96.5      response = requests.get('https://missing.csail.mit.edu')
 8         1      21559.0  21559.0      3.4      s = BeautifulSoup(response.content, 'lxml')
 9         1          2.0      2.0      0.0      urls = []
10        25        685.0     27.4      0.1      for url in s.find_all('a'):
11        24         33.0      1.4      0.0          urls.append(url['href'])
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;memory&quot;&gt;Memory&lt;/h5&gt;

&lt;p&gt;python을 사용할 시에, 데코레이터를 사용한 후, memory_profiler를 사용하면, 메모리 사용량을 검사할 수 있다.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profile&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;my_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'__main__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;my_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ python -m memory_profiler example.py
Line #    Mem usage  Increment   Line Contents
==============================================
     3                           @profile
     4      5.97 MB    0.00 MB   def my_func():
     5     13.61 MB    7.64 MB       a = [1] * (10 ** 6)
     6    166.20 MB  152.59 MB       b = [2] * (2 * 10 ** 7)
     7     13.61 MB -152.59 MB       del b
     8     13.61 MB    0.00 MB       return a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;파이썬에서 데코레이터란&lt;/p&gt;

  &lt;p&gt;https://wikidocs.net/23106&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;event-profiling&quot;&gt;Event Profiling&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;strace&lt;/li&gt;
  &lt;li&gt;perf&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;visualization&quot;&gt;Visualization&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Call graphs: python - &lt;a href=&quot;http://pycallgraph.slowchop.com/en/master/&quot;&gt;pycallgraph&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Flame Graph&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;resource-monitoring&quot;&gt;Resource Monitoring&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;General Monitoring&lt;/strong&gt; - Probably the most popular is &lt;a href=&quot;https://hisham.hm/htop/index.php&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;htop&lt;/code&gt;&lt;/a&gt;, which is an improved version of &lt;a href=&quot;http://man7.org/linux/man-pages/man1/top.1.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;top&lt;/code&gt;&lt;/a&gt;. &lt;code class=&quot;highlighter-rouge&quot;&gt;htop&lt;/code&gt; presents various statistics for the currently running processes on the system. &lt;code class=&quot;highlighter-rouge&quot;&gt;htop&lt;/code&gt; has a myriad of options and keybinds, some useful ones are: `` to sort processes, &lt;code class=&quot;highlighter-rouge&quot;&gt;t&lt;/code&gt; to show tree hierarchy and &lt;code class=&quot;highlighter-rouge&quot;&gt;h&lt;/code&gt; to toggle threads. See also &lt;a href=&quot;https://nicolargo.github.io/glances/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;glances&lt;/code&gt;&lt;/a&gt; for similar implementation with a great UI. For getting aggregate measures across all processes, &lt;a href=&quot;http://dag.wiee.rs/home-made/dstat/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dstat&lt;/code&gt;&lt;/a&gt; is another nifty tool that computes real-time resource metrics for lots of different subsystems like I/O, networking, CPU utilization, context switches, &amp;amp;c.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;I/O operations&lt;/strong&gt; - &lt;a href=&quot;http://man7.org/linux/man-pages/man8/iotop.8.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;iotop&lt;/code&gt;&lt;/a&gt; displays live I/O usage information and is handy to check if a process is doing heavy I/O disk operations&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Disk Usage&lt;/strong&gt; - &lt;a href=&quot;http://man7.org/linux/man-pages/man1/df.1.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;df&lt;/code&gt;&lt;/a&gt; displays metrics per partitions and &lt;a href=&quot;http://man7.org/linux/man-pages/man1/du.1.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;du&lt;/code&gt;&lt;/a&gt; displays &lt;strong&gt;d&lt;/strong&gt;isk &lt;strong&gt;u&lt;/strong&gt;sage per file for the current directory. In these tools the &lt;code class=&quot;highlighter-rouge&quot;&gt;-h&lt;/code&gt; flag tells the program to print with &lt;strong&gt;h&lt;/strong&gt;uman readable format. A more interactive version of &lt;code class=&quot;highlighter-rouge&quot;&gt;du&lt;/code&gt; is &lt;a href=&quot;https://dev.yorhel.nl/ncdu&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ncdu&lt;/code&gt;&lt;/a&gt; which lets you navigate folders and delete files and folders as you navigate.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Memory Usage&lt;/strong&gt; - &lt;a href=&quot;http://man7.org/linux/man-pages/man1/free.1.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;free&lt;/code&gt;&lt;/a&gt; displays the total amount of free and used memory in the system. Memory is also displayed in tools like &lt;code class=&quot;highlighter-rouge&quot;&gt;htop&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Open Files&lt;/strong&gt; - &lt;a href=&quot;http://man7.org/linux/man-pages/man8/lsof.8.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;lsof&lt;/code&gt;&lt;/a&gt; lists file information about files opened by processes. It can be quite useful for checking which process has opened a specific file.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Network Connections and Config&lt;/strong&gt; - &lt;a href=&quot;http://man7.org/linux/man-pages/man8/ss.8.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ss&lt;/code&gt;&lt;/a&gt; lets you monitor incoming and outgoing network packets statistics as well as interface statistics. A common use case of &lt;code class=&quot;highlighter-rouge&quot;&gt;ss&lt;/code&gt; is figuring out what process is using a given port in a machine. For displaying routing, network devices and interfaces you can use &lt;a href=&quot;http://man7.org/linux/man-pages/man8/ip.8.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ip&lt;/code&gt;&lt;/a&gt;. Note that &lt;code class=&quot;highlighter-rouge&quot;&gt;netstat&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;ifconfig&lt;/code&gt; have been deprecated in favor of the former tools respectively.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Network Usage&lt;/strong&gt; - &lt;a href=&quot;https://github.com/raboof/nethogs&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;nethogs&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;http://www.ex-parrot.com/pdw/iftop/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;iftop&lt;/code&gt;&lt;/a&gt; are good interactive CLI tools for monitoring network usage.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;6-metaprogramming&quot;&gt;6. Metaprogramming&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;paper&lt;/li&gt;
  &lt;li&gt;source code&lt;/li&gt;
  &lt;li&gt;tool&lt;/li&gt;
  &lt;li&gt;dependency&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;build-systems&quot;&gt;Build systems&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;make&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ubuntu에서 make 명령어는 파일 관리 유틸리티이다. make 명령어를 실행하는 위치에 Makefile이 있어야 한다.&lt;/p&gt;

&lt;p&gt;Makefile은 다음과 같은 구조를 가진다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Target: 명령어가 실행되어 나온 결과를 저장할 파일&lt;/li&gt;
  &lt;li&gt;Dependency: Target을 만들기 위해 필요한 재료&lt;/li&gt;
  &lt;li&gt;Command: 실행되어야 할 명령어들&lt;/li&gt;
  &lt;li&gt;macro: 코드를 단순화 시키기 위한 방법&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CC=&amp;lt;컴파일러&amp;gt;
CFLAGS=&amp;lt;컴파일 옵션&amp;gt;
LDFLAGS=&amp;lt;링크 옵션&amp;gt;
LDLIBS=&amp;lt;링크 라이브러리 목록&amp;gt;
OBJS=&amp;lt;Object 파일 목록&amp;gt;
TARGET=&amp;lt;빌드 대상 이름&amp;gt;
 
all: $(TARGET)
 
clean:
    rm -f *.o
    rm -f $(TARGET)
 
$(TARGET): $(OBJS)
$(CC) -o $@ $(OBJS)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;빌드규칙 블록&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;Target&amp;gt;: &amp;lt;Dependencies&amp;gt;
    &amp;lt;Recipe&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Target:&lt;/strong&gt; 빌드 대상 이름. 통상 이 Rule에서 최종적으로 생성해내는 파일명을 써 줍니다.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Dependencies:&lt;/strong&gt; 빌드 대상이 의존하는 Target이나 파일 목록. 여기에 나열된 대상들을 먼저 만들고 빌드 대상을 생성합니다.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Recipe:&lt;/strong&gt; 빌드 대상을 생성하는 명령. 여러 줄로 작성할 수 있으며, 각 줄 시작에 반드시 Tab문자로 된 Indent가 있어야 합니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;예시&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;paper.pdf: paper.tex plot-data.png
	pdflatex paper.tex

plot-%.png: %.dat plot.py
	./plot.py -i $*.dat -o $@

# %: pattern
# $@: current target
# reference: http://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;자세한 정보를 알고 싶다면, https://www.tuwlab.com/ece/27193&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;dependency-management&quot;&gt;Dependency management&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://spoqa.github.io/2012/12/18/semantic-versioning.html&quot;&gt;semantic versioning&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;continuous-integration-systems&quot;&gt;Continuous integration systems&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Github Actions&lt;/li&gt;
  &lt;li&gt;Travis CI&lt;/li&gt;
  &lt;li&gt;Pipelines&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;a-brief-aside-on-testing&quot;&gt;A brief aside on testing&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;test suite&lt;/li&gt;
  &lt;li&gt;unit test&lt;/li&gt;
  &lt;li&gt;intergration test&lt;/li&gt;
  &lt;li&gt;regression test&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Mocking&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Reference: https://missing.csail.mit.edu/2020/?fbclid=IwAR2gQe5LToKuqVUwbfegqSOk6BnIqscbnqjK0e3js64EceMswNqW0KgeSEo&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">Missing Semester 정리글</summary></entry><entry><title type="html">Fastpages Notebook Blog Post</title><link href="https://fastpages.fast.ai/blog/jupyter/2020/02/20/test.html" rel="alternate" type="text/html" title="Fastpages Notebook Blog Post" /><published>2020-02-20T00:00:00-06:00</published><updated>2020-02-20T00:00:00-06:00</updated><id>https://fastpages.fast.ai/blog/jupyter/2020/02/20/test</id><content type="html" xml:base="https://fastpages.fast.ai/blog/jupyter/2020/02/20/test.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-20-test.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;About&quot;&gt;About&lt;a class=&quot;anchor-link&quot; href=&quot;#About&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;This notebook is a demonstration of some of capabilities of &lt;a href=&quot;https://github.com/fastai/fastpages&quot;&gt;fastpages&lt;/a&gt; with notebooks.&lt;/p&gt;
&lt;p&gt;With &lt;code&gt;fastpages&lt;/code&gt; you can save your jupyter notebooks into the &lt;code&gt;_notebooks&lt;/code&gt; folder at the root of your repository, and they will be automatically be converted to Jekyll compliant blog posts!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Front-Matter&quot;&gt;Front Matter&lt;a class=&quot;anchor-link&quot; href=&quot;#Front-Matter&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The first cell in your Jupyter Notebook or markdown blog post contains front matter. Front matter is metadata that can turn on/off options in your Notebook. It is formatted like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# &quot;My Title&quot;
&amp;gt; &quot;Awesome summary&quot;

- toc:true- branch: master- badges: true- comments: true
- author: Hamel Husain &amp;amp; Jeremy Howard
- categories: [fastpages, jupyter]&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Setting &lt;code&gt;toc: true&lt;/code&gt; will automatically generate a table of contents&lt;/li&gt;
&lt;li&gt;Setting &lt;code&gt;badges: true&lt;/code&gt; will automatically include GitHub and Google Colab links to your notebook.&lt;/li&gt;
&lt;li&gt;Setting &lt;code&gt;comments: true&lt;/code&gt; will enable commenting on your blog post, powered by &lt;a href=&quot;https://github.com/utterance/utterances&quot;&gt;utterances&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The title and description need to be enclosed in double quotes only if they include special characters such as a colon. More details and options for front matter can be viewed on the &lt;a href=&quot;https://github.com/fastai/fastpages#front-matter-related-options&quot;&gt;front matter section&lt;/a&gt; of the README.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Markdown-Shortcuts&quot;&gt;Markdown Shortcuts&lt;a class=&quot;anchor-link&quot; href=&quot;#Markdown-Shortcuts&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;A &lt;code&gt;#hide&lt;/code&gt; comment at the top of any code cell will hide &lt;strong&gt;both the input and output&lt;/strong&gt; of that cell in your blog post.&lt;/p&gt;
&lt;p&gt;A &lt;code&gt;#hide_input&lt;/code&gt; comment at the top of any code cell will &lt;strong&gt;only hide the input&lt;/strong&gt; of that cell.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;The comment #hide_input was used to hide the code that produced this.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;put a &lt;code&gt;#collapse-hide&lt;/code&gt; flag at the top of any cell if you want to &lt;strong&gt;hide&lt;/strong&gt; that cell by default, but give the reader the option to show it:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;altair&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;alt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;put a &lt;code&gt;#collapse-show&lt;/code&gt; flag at the top of any cell if you want to &lt;strong&gt;show&lt;/strong&gt; that cell by default, but give the reader the option to hide it:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/cars.json&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/movies.json&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sp500&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/sp500.csv&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stocks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/stocks.csv&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/flights-5k.json&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Interactive-Charts-With-Altair&quot;&gt;Interactive Charts With Altair&lt;a class=&quot;anchor-link&quot; href=&quot;#Interactive-Charts-With-Altair&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Charts made with Altair remain interactive.  Example charts taken from &lt;a href=&quot;https://github.com/uwdata/visualization-curriculum&quot;&gt;this repo&lt;/a&gt;, specifically &lt;a href=&quot;https://github.com/uwdata/visualization-curriculum/blob/master/altair_interaction.ipynb&quot;&gt;this notebook&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Example-1:-DropDown&quot;&gt;Example 1: DropDown&lt;a class=&quot;anchor-link&quot; href=&quot;#Example-1:-DropDown&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# single-value selection over [Major_Genre, MPAA_Rating] pairs&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# use specific hard-wired values as the initial selected values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;selection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selection_single&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Select&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Major_Genre&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;MPAA_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Major_Genre&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Drama&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;MPAA_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Major_Genre&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;binding_select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;genres&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;MPAA_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;binding_radio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mpaa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
&lt;span class=&quot;c1&quot;&gt;# scatter plot, modify opacity based on selection&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_selection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;selection&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Rotten_Tomatoes_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;IMDB_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tooltip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Title:N&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.75&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;

&lt;div id=&quot;altair-viz-1a49e83878ce4d678d7b162f3d6b510f&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  (function(spec, embedOpt){
    const outputDiv = document.getElementById(&quot;altair-viz-1a49e83878ce4d678d7b162f3d6b510f&quot;);
    const paths = {
      &quot;vega&quot;: &quot;https://cdn.jsdelivr.net/npm//vega@5?noext&quot;,
      &quot;vega-lib&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lib?noext&quot;,
      &quot;vega-lite&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext&quot;,
      &quot;vega-embed&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-embed@6?noext&quot;,
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () =&gt; resolve(paths[lib]);
        s.onerror = () =&gt; reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName(&quot;head&quot;)[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `&lt;div class=&quot;error&quot; style=&quot;color:red;&quot;&gt;${err}&lt;/div&gt;`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err =&gt; showError(`Javascript Error: ${err.message}&lt;br&gt;This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === &quot;function&quot; &amp;&amp; define.amd) {
      requirejs.config({paths});
      require([&quot;vega-embed&quot;], displayChart, err =&gt; showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === &quot;function&quot;) {
      displayChart(vegaEmbed);
    } else {
      loadScript(&quot;vega&quot;)
        .then(() =&gt; loadScript(&quot;vega-lite&quot;))
        .then(() =&gt; loadScript(&quot;vega-embed&quot;))
        .catch(showError)
        .then(() =&gt; displayChart(vegaEmbed));
    }
  })({&quot;config&quot;: {&quot;view&quot;: {&quot;continuousWidth&quot;: 400, &quot;continuousHeight&quot;: 300}}, &quot;data&quot;: {&quot;url&quot;: &quot;https://vega.github.io/vega-datasets/data/movies.json&quot;}, &quot;mark&quot;: &quot;circle&quot;, &quot;encoding&quot;: {&quot;opacity&quot;: {&quot;condition&quot;: {&quot;value&quot;: 0.75, &quot;selection&quot;: &quot;Select&quot;}, &quot;value&quot;: 0.05}, &quot;tooltip&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;Title&quot;}, &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;Rotten_Tomatoes_Rating&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;IMDB_Rating&quot;}}, &quot;selection&quot;: {&quot;Select&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;Major_Genre&quot;, &quot;MPAA_Rating&quot;], &quot;init&quot;: {&quot;Major_Genre&quot;: &quot;Drama&quot;, &quot;MPAA_Rating&quot;: &quot;R&quot;}, &quot;bind&quot;: {&quot;Major_Genre&quot;: {&quot;input&quot;: &quot;select&quot;, &quot;options&quot;: [&quot;Action&quot;, &quot;Adventure&quot;, &quot;Black Comedy&quot;, &quot;Comedy&quot;, &quot;Concert/Performance&quot;, &quot;Documentary&quot;, &quot;Drama&quot;, &quot;Horror&quot;, &quot;Musical&quot;, &quot;Romantic Comedy&quot;, &quot;Thriller/Suspense&quot;, &quot;Western&quot;]}, &quot;MPAA_Rating&quot;: {&quot;input&quot;: &quot;radio&quot;, &quot;options&quot;: [&quot;G&quot;, &quot;PG&quot;, &quot;PG-13&quot;, &quot;R&quot;, &quot;NC-17&quot;, &quot;Not Rated&quot;]}}}}, &quot;$schema&quot;: &quot;https://vega.github.io/schema/vega-lite/v4.0.2.json&quot;}, {&quot;mode&quot;: &quot;vega-lite&quot;});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Example-2:-Tooltips&quot;&gt;Example 2: Tooltips&lt;a class=&quot;anchor-link&quot; href=&quot;#Example-2:-Tooltips&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_selection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selection_interval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;scales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Rotten_Tomatoes_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;IMDB_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minExtent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# use min extent to stabilize axis title placement&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tooltip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Title:N&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Release_Date:N&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;IMDB_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Rotten_Tomatoes_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;

&lt;div id=&quot;altair-viz-c022b476f4fb482ca6f609bf6ed082d2&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  (function(spec, embedOpt){
    const outputDiv = document.getElementById(&quot;altair-viz-c022b476f4fb482ca6f609bf6ed082d2&quot;);
    const paths = {
      &quot;vega&quot;: &quot;https://cdn.jsdelivr.net/npm//vega@5?noext&quot;,
      &quot;vega-lib&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lib?noext&quot;,
      &quot;vega-lite&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext&quot;,
      &quot;vega-embed&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-embed@6?noext&quot;,
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () =&gt; resolve(paths[lib]);
        s.onerror = () =&gt; reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName(&quot;head&quot;)[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `&lt;div class=&quot;error&quot; style=&quot;color:red;&quot;&gt;${err}&lt;/div&gt;`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err =&gt; showError(`Javascript Error: ${err.message}&lt;br&gt;This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === &quot;function&quot; &amp;&amp; define.amd) {
      requirejs.config({paths});
      require([&quot;vega-embed&quot;], displayChart, err =&gt; showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === &quot;function&quot;) {
      displayChart(vegaEmbed);
    } else {
      loadScript(&quot;vega&quot;)
        .then(() =&gt; loadScript(&quot;vega-lite&quot;))
        .then(() =&gt; loadScript(&quot;vega-embed&quot;))
        .catch(showError)
        .then(() =&gt; displayChart(vegaEmbed));
    }
  })({&quot;config&quot;: {&quot;view&quot;: {&quot;continuousWidth&quot;: 400, &quot;continuousHeight&quot;: 300}}, &quot;data&quot;: {&quot;url&quot;: &quot;https://vega.github.io/vega-datasets/data/movies.json&quot;}, &quot;mark&quot;: &quot;circle&quot;, &quot;encoding&quot;: {&quot;tooltip&quot;: [{&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;Title&quot;}, {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;Release_Date&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;IMDB_Rating&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;Rotten_Tomatoes_Rating&quot;}], &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;Rotten_Tomatoes_Rating&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;axis&quot;: {&quot;minExtent&quot;: 30}, &quot;field&quot;: &quot;IMDB_Rating&quot;}}, &quot;height&quot;: 400, &quot;selection&quot;: {&quot;selector001&quot;: {&quot;type&quot;: &quot;interval&quot;, &quot;bind&quot;: &quot;scales&quot;, &quot;encodings&quot;: [&quot;x&quot;]}}, &quot;width&quot;: 600, &quot;$schema&quot;: &quot;https://vega.github.io/schema/vega-lite/v4.0.2.json&quot;}, {&quot;mode&quot;: &quot;vega-lite&quot;});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Example-3:-More-Tooltips&quot;&gt;Example 3: More Tooltips&lt;a class=&quot;anchor-link&quot; href=&quot;#Example-3:-More-Tooltips&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# select a point for which to provide details-on-demand&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selection_single&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;encodings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# limit selection to x-axis value&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mouseover&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# select on mouseover events&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;nearest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# select data point nearest the cursor&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;none&amp;#39;&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;# empty selection includes no data points&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# define our base line chart of stock prices&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;date:T&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;price:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;log&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;symbol:N&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# base line chart&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# add a rule mark to serve as a guide line&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_rule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;#aaa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;date:T&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# add circle marks for selected time points, hide unselected points&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_selection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# add white stroked text to provide a legible background for labels&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;align&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stroke&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strokeWidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;price:Q&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# add text labels for stock prices&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;align&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;price:Q&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stocks&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;

&lt;div id=&quot;altair-viz-9283d3681fd24aafa3d1e2f9ad193ecf&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  (function(spec, embedOpt){
    const outputDiv = document.getElementById(&quot;altair-viz-9283d3681fd24aafa3d1e2f9ad193ecf&quot;);
    const paths = {
      &quot;vega&quot;: &quot;https://cdn.jsdelivr.net/npm//vega@5?noext&quot;,
      &quot;vega-lib&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lib?noext&quot;,
      &quot;vega-lite&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext&quot;,
      &quot;vega-embed&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-embed@6?noext&quot;,
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () =&gt; resolve(paths[lib]);
        s.onerror = () =&gt; reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName(&quot;head&quot;)[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `&lt;div class=&quot;error&quot; style=&quot;color:red;&quot;&gt;${err}&lt;/div&gt;`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err =&gt; showError(`Javascript Error: ${err.message}&lt;br&gt;This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === &quot;function&quot; &amp;&amp; define.amd) {
      requirejs.config({paths});
      require([&quot;vega-embed&quot;], displayChart, err =&gt; showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === &quot;function&quot;) {
      displayChart(vegaEmbed);
    } else {
      loadScript(&quot;vega&quot;)
        .then(() =&gt; loadScript(&quot;vega-lite&quot;))
        .then(() =&gt; loadScript(&quot;vega-embed&quot;))
        .catch(showError)
        .then(() =&gt; displayChart(vegaEmbed));
    }
  })({&quot;config&quot;: {&quot;view&quot;: {&quot;continuousWidth&quot;: 400, &quot;continuousHeight&quot;: 300}}, &quot;layer&quot;: [{&quot;mark&quot;: &quot;line&quot;, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;symbol&quot;}, &quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;, &quot;scale&quot;: {&quot;type&quot;: &quot;log&quot;}}}}, {&quot;mark&quot;: {&quot;type&quot;: &quot;rule&quot;, &quot;color&quot;: &quot;#aaa&quot;}, &quot;encoding&quot;: {&quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}}, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;selector002&quot;}}]}, {&quot;mark&quot;: &quot;circle&quot;, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;symbol&quot;}, &quot;opacity&quot;: {&quot;condition&quot;: {&quot;value&quot;: 1, &quot;selection&quot;: &quot;selector002&quot;}, &quot;value&quot;: 0}, &quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;, &quot;scale&quot;: {&quot;type&quot;: &quot;log&quot;}}}, &quot;selection&quot;: {&quot;selector002&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;encodings&quot;: [&quot;x&quot;], &quot;on&quot;: &quot;mouseover&quot;, &quot;nearest&quot;: true, &quot;empty&quot;: &quot;none&quot;}}}, {&quot;mark&quot;: {&quot;type&quot;: &quot;text&quot;, &quot;align&quot;: &quot;left&quot;, &quot;dx&quot;: 5, &quot;dy&quot;: -5, &quot;stroke&quot;: &quot;white&quot;, &quot;strokeWidth&quot;: 2}, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;symbol&quot;}, &quot;text&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;}, &quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;, &quot;scale&quot;: {&quot;type&quot;: &quot;log&quot;}}}, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;selector002&quot;}}]}, {&quot;mark&quot;: {&quot;type&quot;: &quot;text&quot;, &quot;align&quot;: &quot;left&quot;, &quot;dx&quot;: 5, &quot;dy&quot;: -5}, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;symbol&quot;}, &quot;text&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;}, &quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;, &quot;scale&quot;: {&quot;type&quot;: &quot;log&quot;}}}, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;selector002&quot;}}]}], &quot;data&quot;: {&quot;url&quot;: &quot;https://vega.github.io/vega-datasets/data/stocks.csv&quot;}, &quot;height&quot;: 400, &quot;width&quot;: 700, &quot;$schema&quot;: &quot;https://vega.github.io/schema/vega-lite/v4.0.2.json&quot;}, {&quot;mode&quot;: &quot;vega-lite&quot;});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Data-Tables&quot;&gt;Data Tables&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-Tables&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can display tables per the usual way in your blog:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/movies.json&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# display table with pandas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Title&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Worldwide_Gross&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;Production_Budget&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Distributor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;MPAA_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;IMDB_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Rotten_Tomatoes_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Title&lt;/th&gt;
      &lt;th&gt;Worldwide_Gross&lt;/th&gt;
      &lt;th&gt;Production_Budget&lt;/th&gt;
      &lt;th&gt;Distributor&lt;/th&gt;
      &lt;th&gt;MPAA_Rating&lt;/th&gt;
      &lt;th&gt;IMDB_Rating&lt;/th&gt;
      &lt;th&gt;Rotten_Tomatoes_Rating&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;The Land Girls&lt;/td&gt;
      &lt;td&gt;146083.0&lt;/td&gt;
      &lt;td&gt;8000000.0&lt;/td&gt;
      &lt;td&gt;Gramercy&lt;/td&gt;
      &lt;td&gt;R&lt;/td&gt;
      &lt;td&gt;6.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;First Love, Last Rites&lt;/td&gt;
      &lt;td&gt;10876.0&lt;/td&gt;
      &lt;td&gt;300000.0&lt;/td&gt;
      &lt;td&gt;Strand&lt;/td&gt;
      &lt;td&gt;R&lt;/td&gt;
      &lt;td&gt;6.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;I Married a Strange Person&lt;/td&gt;
      &lt;td&gt;203134.0&lt;/td&gt;
      &lt;td&gt;250000.0&lt;/td&gt;
      &lt;td&gt;Lionsgate&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;6.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Let's Talk About Sex&lt;/td&gt;
      &lt;td&gt;373615.0&lt;/td&gt;
      &lt;td&gt;300000.0&lt;/td&gt;
      &lt;td&gt;Fine Line&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;13.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Slam&lt;/td&gt;
      &lt;td&gt;1087521.0&lt;/td&gt;
      &lt;td&gt;1000000.0&lt;/td&gt;
      &lt;td&gt;Trimark&lt;/td&gt;
      &lt;td&gt;R&lt;/td&gt;
      &lt;td&gt;3.4&lt;/td&gt;
      &lt;td&gt;62.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Images&quot;&gt;Images&lt;a class=&quot;anchor-link&quot; href=&quot;#Images&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h3 id=&quot;Local-Images&quot;&gt;Local Images&lt;a class=&quot;anchor-link&quot; href=&quot;#Local-Images&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You can reference local images and they will be copied and rendered on your blog automatically.  You can include these with the following markdown syntax:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;![](my_icons/fastai_logo.png)&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/images/copied_from_nb/my_icons/fastai_logo.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Remote-Images&quot;&gt;Remote Images&lt;a class=&quot;anchor-link&quot; href=&quot;#Remote-Images&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Remote images can be included with the following markdown syntax:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;![](https://image.flaticon.com/icons/svg/36/36686.svg)&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;https://image.flaticon.com/icons/svg/36/36686.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Animated-Gifs&quot;&gt;Animated Gifs&lt;a class=&quot;anchor-link&quot; href=&quot;#Animated-Gifs&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Animated Gifs work, too!&lt;/p&gt;
&lt;p&gt;&lt;code&gt;![](https://upload.wikimedia.org/wikipedia/commons/7/71/ChessPawnSpecialMoves.gif)&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/7/71/ChessPawnSpecialMoves.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Captions&quot;&gt;Captions&lt;a class=&quot;anchor-link&quot; href=&quot;#Captions&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You can include captions with markdown images like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;![](https://www.fast.ai/images/fastai_paper/show_batch.png &quot;Credit: https://www.fast.ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/&quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://www.fast.ai/images/fastai_paper/show_batch.png&quot; alt=&quot;&quot; title=&quot;Credit: https://www.fast.ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Other-Elements&quot;&gt;Other Elements&lt;a class=&quot;anchor-link&quot; href=&quot;#Other-Elements&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;GitHub-Flavored-Emojis&quot;&gt;GitHub Flavored Emojis&lt;a class=&quot;anchor-link&quot; href=&quot;#GitHub-Flavored-Emojis&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Typing &lt;code&gt;I give this post two :+1:!&lt;/code&gt; will render this:&lt;/p&gt;
&lt;p&gt;I give this post two :+1:!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tweetcards&quot;&gt;Tweetcards&lt;a class=&quot;anchor-link&quot; href=&quot;#Tweetcards&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Typing &lt;code&gt;&amp;gt; twitter: https://twitter.com/jakevdp/status/1204765621767901185?s=20&lt;/code&gt; will render this:

&lt;center&gt;
    &lt;div class=&quot;jekyll-twitter-plugin&quot;&gt;&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Altair 4.0 is released! &lt;a href=&quot;https://t.co/PCyrIOTcvv&quot;&gt;https://t.co/PCyrIOTcvv&lt;/a&gt;&lt;br /&gt;Try it with:&lt;br /&gt;&lt;br /&gt;  pip install -U altair&lt;br /&gt;&lt;br /&gt;The full list of changes is at &lt;a href=&quot;https://t.co/roXmzcsT58&quot;&gt;https://t.co/roXmzcsT58&lt;/a&gt; ...read on for some highlights. &lt;a href=&quot;https://t.co/vWJ0ZveKbZ&quot;&gt;pic.twitter.com/vWJ0ZveKbZ&lt;/a&gt;&lt;/p&gt;&amp;mdash; Jake VanderPlas (@jakevdp) &lt;a href=&quot;https://twitter.com/jakevdp/status/1204765621767901185?ref_src=twsrc%5Etfw&quot;&gt;December 11, 2019&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;/center&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Youtube-Videos&quot;&gt;Youtube Videos&lt;a class=&quot;anchor-link&quot; href=&quot;#Youtube-Videos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Typing &lt;code&gt;&amp;gt; youtube: https://youtu.be/XfoYk_Z5AkI&lt;/code&gt; will render this:

&lt;center&gt;
    &lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/XfoYk_Z5AkI&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;/center&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Boxes-/-Callouts&quot;&gt;Boxes / Callouts&lt;a class=&quot;anchor-link&quot; href=&quot;#Boxes-/-Callouts&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Typing &lt;code&gt;&amp;gt; Warning: There will be no second warning!&lt;/code&gt; will render this:
&lt;div class=&quot;flash flash-error&quot;&gt;
    &lt;svg class=&quot;octicon octicon-alert&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; width=&quot;16&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 000 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 00.01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Warning: &lt;/strong&gt;There will be no second warning!
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Typing &lt;code&gt;&amp;gt; Important: Pay attention! It's important.&lt;/code&gt; will render this:
&lt;div class=&quot;flash flash-warn&quot;&gt;
    &lt;svg class=&quot;octicon octicon-zap&quot; viewBox=&quot;0 0 10 16&quot; version=&quot;1.1&quot; width=&quot;10&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M10 7H6l3-7-9 9h4l-3 7 9-9z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Important: &lt;/strong&gt;Pay attention! It&amp;#8217;s important.
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Typing &lt;code&gt;&amp;gt; Tip: This is my tip.&lt;/code&gt; will render this:
&lt;div class=&quot;flash flash-success&quot;&gt;
    &lt;svg class=&quot;octicon octicon-checklist&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; width=&quot;16&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M16 8.5l-6 6-3-3L8.5 10l1.5 1.5L14.5 7 16 8.5zM5.7 12.2l.8.8H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h7c.55 0 1 .45 1 1v6.5l-.8-.8c-.39-.39-1.03-.39-1.42 0L5.7 10.8a.996.996 0 000 1.41v-.01zM4 4h5V3H4v1zm0 2h5V5H4v1zm0 2h3V7H4v1zM3 9H2v1h1V9zm0-2H2v1h1V7zm0-2H2v1h1V5zm0-2H2v1h1V3z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Tip: &lt;/strong&gt;This is my tip.
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Typing &lt;code&gt;&amp;gt; Note: Take note of this.&lt;/code&gt; will render this:
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;Take note of this.
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Typing &lt;code&gt;&amp;gt; Note: A doc link to [an example website: fast.ai](https://www.fast.ai/) should also work fine.&lt;/code&gt; will render in the docs:
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;A doc link to &lt;a href=&quot;https://www.fast.ai/&quot;&gt;an example website: fast.ai&lt;/a&gt; should also work fine.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Footnotes&quot;&gt;Footnotes&lt;a class=&quot;anchor-link&quot; href=&quot;#Footnotes&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can have footnotes in notebooks, however the syntax is different compared to markdown documents. &lt;a href=&quot;https://github.com/fastai/fastpages/blob/master/_fastpages_docs/NOTEBOOK_FOOTNOTES.md&quot;&gt;This guide provides more detail about this syntax&lt;/a&gt;, which looks like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;For example, here is a footnote {% fn 1 %}.
And another {% fn 2 %}
{{ 'This is the footnote.' | fndetail: 1 }}
{{ 'This is the other footnote. You can even have a [link](www.github.com)!' | fndetail: 2 }}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For example, here is a footnote &lt;sup id=&quot;fnref-1&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;And another &lt;sup id=&quot;fnref-2&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-2&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-1&quot;&gt;1. This is the footnote.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote footnotes&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-2&quot;&gt;2. This is the other footnote. You can even have a &lt;a href=&quot;www.github.com&quot;&gt;link&lt;/a&gt;!&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote footnotes&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://fastpages.fast.ai/blog/images/chart-preview.png" /><media:content medium="image" url="https://fastpages.fast.ai/blog/images/chart-preview.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">늦은 2019 회고</title><link href="https://fastpages.fast.ai/blog/2020/01/22/%EB%8A%A6%EC%9D%80-2019-%ED%9A%8C%EA%B3%A0.html" rel="alternate" type="text/html" title="늦은 2019 회고" /><published>2020-01-22T00:00:00-06:00</published><updated>2020-01-22T00:00:00-06:00</updated><id>https://fastpages.fast.ai/blog/2020/01/22/%EB%8A%A6%EC%9D%80-2019-%ED%9A%8C%EA%B3%A0</id><content type="html" xml:base="https://fastpages.fast.ai/blog/2020/01/22/%EB%8A%A6%EC%9D%80-2019-%ED%9A%8C%EA%B3%A0.html">&lt;h2 id=&quot;1-2019년-계획했던-일&quot;&gt;1. 2019년 계획했던 일&lt;/h2&gt;

&lt;p&gt;2019년은 학생에서 사회인으로 나아가는 경계였다. 2019년에는 특히 좋은 사람들을 많이 만났고, 개인적으로 많은 도움을 받은 해라고 생각한다.&lt;/p&gt;

&lt;h4 id=&quot;1-딥러닝-논문-구현-목표-달성&quot;&gt;(1) 딥러닝 논문 구현: 목표 달성&lt;/h4&gt;

&lt;p&gt;지금도 어렵지만, 처음에 딥러닝 논문을 구현하려고 시도했을때는 정말 큰 벽처럼 느껴졌다.  이전에는 딥러닝 구현체를 주로 가져다 쓰는 식으로 공부를 지속하였고, 돌이켜보면 전혀 성장하지 못했던 시기이다.&lt;/p&gt;

&lt;p&gt;처음 딥러닝 논문을 구현하기로 마음먹은 것은 모두의 연구소 SafeAI랩에서 좋은 사람들을 만나서이다. 그 당시에는 구현하려는 주제가 명확했고, 누군가에게 피드백을 받을 환경이 조성되어 있어서 조금씩 성장했다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;처음에는 tensorflow code를 &lt;a href=&quot;https://github.com/RRoundTable&quot;&gt;keras code&lt;/a&gt;로 옮겨서 구현하는 연습을 하였다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;논문의 결과를 조금 더 명확하게 보여주기 위해서 &lt;a href=&quot;https://github.com/RRoundTable/EEN-with-Keras&quot;&gt;시각화&lt;/a&gt;에 힘을 쓰기도 하였다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;그리고, 논문의 처음부터 끝까지 오로지 &lt;a href=&quot;https://github.com/RRoundTable/hedged_instance_embedding&quot;&gt;나의 코드&lt;/a&gt;로 채우기도 하였다. 저자분이 한국분이셔서 커뮤니티에서 도움을 주기도 하였다.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;2-코딩-테스트-합격하기&quot;&gt;(2) 코딩 테스트 합격하기&lt;/h4&gt;

&lt;p&gt;처음에는 딥러닝 엔지니어 직군이 코딩테스트를 보는지 몰랐다. 그래서 괜찮은 기회들을 놓치기도 했다. 코딩 테스트에 합격하기 위해서 &lt;a href=&quot;https://www.codility.com/&quot;&gt;Codility&lt;/a&gt; 를 활용하였지만, 나의 실력은 제자리 걸음이였다. 지금 생각해보면, 잘못된 방식으로 알고리즘을 대하고 있었다.&lt;/p&gt;

&lt;p&gt;결국은 2019년에 코딩 테스트에서는 모두 좋은 결과를 얻지 못했다.&lt;/p&gt;

&lt;h4 id=&quot;3-딥러닝-엔지니어로-인턴-경험-쌓기&quot;&gt;(3) 딥러닝 엔지니어로 인턴 경험 쌓기&lt;/h4&gt;

&lt;p&gt;수료 후에 인턴을 해야겠다는 계획을 가지고 있었다. 평소에 관심을 가지고 있던 의료기업들에 이메일 혹은 다른 매체로 지원서를 작성하였다. 한 기업에 면접을 보게 되었고,  긍정적인 인상을 가지고 회사에 입사하게 되었다.&lt;/p&gt;

&lt;p&gt;처음하는 사회생활이였다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;이런 점이 인상깊었다.&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;실제 인공지능 기술이 상업화되가는 과정을 지켜볼 수 있었다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;내가 이전에 놓치고 있던 개념들에 대해서 깨달음을 얻을 수 있었다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;능력있는 동료들&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;나에게 맡겨지는 책임과 권한&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;하지만,  나에게 버거웠던 것은&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;명확한 경쟁업체의 존재와 시장에 빠른 진입이 요구되었다.&lt;/li&gt;
  &lt;li&gt;경험해보지 않은 도메인에 대한 빠른 적응이 요구되었다.&lt;/li&gt;
  &lt;li&gt;문서체계 및 코드체계가 정해진 룰이 없었다.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;처음하는 일이라서 잘하고 싶었던 마음이 더 컸다. 요구사항을 충족시키기 위해서 자신을 몰아세우고 있는 ‘나’를 발견하게 되었다.&lt;/p&gt;

&lt;p&gt;하지만, 다행스럽게도 주변에 조언을 구할 사람이 있었다. (감사합니다.)  혼자 생각하기보다 조언을 구하고 심정을 공유했던 것이 악순환을 벗어나는데 큰 도움이 되었다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;돌이켜보니,&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;일하면서 고민하고 고뇌했던 과정이 나에게 많은 영감을 주었다. 특히,  모델의 성능을 끌어올리기 위해서 정말 많은 고민과 스트레스를 받았는데, 그 과정에서 얻은 교훈은 나에게 많은 시도를 할 수 있게 해준 환경도 한 몫 했다고 생각한다. 또한 스트레스에 대해서 더 진지하게 생각해보는 계기가 되었다.&lt;/p&gt;

&lt;h2 id=&quot;2-2019년-계획하지-않았던-일&quot;&gt;2. 2019년 계획하지 않았던 일&lt;/h2&gt;

&lt;h4 id=&quot;1-풀잎스쿨-cpps&quot;&gt;(1) 풀잎스쿨 CPPS&lt;/h4&gt;

&lt;p&gt;기업에서 퇴사하기 약 1 ~ 2주전에 CPPS[competitive programming problem solving]을 시작하게 되었다.  &lt;a href=&quot;https://leetcode.com/&quot;&gt;leetcode&lt;/a&gt;에서 일주일에 다섯문제를 풀고 발표하는 형식으로 이루어졌다. 이 모임에 참여하기 전에는 다른 누군가에게 발표하는 과정의 필요성에 대해서 못느꼈다. 그리고 다른사람들의 중요성도 못 느꼈던 거 같다.&lt;/p&gt;

&lt;p&gt;하지만, 다른 사람들의 생각을 듣게 되면서, 새로운 방향성에 대해서 접하게 되었다. 또한, 내가 처음에 발표를 하는데 내용이 정리가 안되니까, 당황스러울 정도로 매끄럽지 못하게 발표하게 된적도 있다. 이런 경험을  한 후에는 앞에 나가기전에 잠깐 생각을 정리하기도 하고, discuss에서 다른 사람들이 어떤 생각으로 문제를 풀이하는지 어떤 것을 더 배울 수 있는지에 대한 고찰을 많이 하였다.&lt;/p&gt;

&lt;p&gt;혼자하는 것보다 여럿이 하니까, 더 깊은 생각과 생각을 정리할 수 있는 시간을 가질 수 있어서 좋았다.&lt;/p&gt;

&lt;h4 id=&quot;2-성남시-이노베이션-해커톤&quot;&gt;(2) 성남시 이노베이션 해커톤&lt;/h4&gt;

&lt;p&gt;퇴사 후에 해커톤에 참여하게 되었다. 좋은 분들과 함께 할 수 있어서 정말 재밌었다. 물론 그 당시에는 잠을 못자는게 힘들었다.&lt;/p&gt;

&lt;h4 id=&quot;3-의료인공지능-기업-면접&quot;&gt;(3) 의료인공지능 기업 면접&lt;/h4&gt;

&lt;p&gt;의료 도메인 인턴을 한 후, 헤드 헌터 업체를 통해서 Job description이 가끔 왔다. 그 중 하나의 기업에 면접을 보게 되었고, 나름 면접을 원할하게 볼 수 있었다. 하지만, 면접을 진행하면서 알게된 것은, 이전 기업과 너무나 유사한 사업분야였고, 가서 할 일도 비슷해보였다. 오퍼는 받았지만, 장기적으로는 기업과 나의 방향성이 일치하지 않을 것이 분명하여 죄송한 마음으로 거절하게 되었다.&lt;/p&gt;

&lt;h2 id=&quot;3-2019년을-보내고-난-후&quot;&gt;3. 2019년을 보내고 난 후&lt;/h2&gt;

&lt;p&gt;언제나처럼 시간이 너무나 빨랐다.  몇 가지 얻은 교훈이 있다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;성장을 하는데 중요한 자세는 어제보다 나은 오늘이다.&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;같은 실수를 반복하고 있지 않는지 돌이켜 볼 필요가 있다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;멀리가고 싶으면 함께 가는 것이 좋겠다.&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;아직도 여럿이 무엇을 하는데 익숙하지는 않으나, 노력중이다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;신체와 정신 모두 케어 받아야 한다.&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;내가 감당할 수 있는 스트레스 영역에 대한 이해가 필요하다. 불행하다고 느끼지 않는 선에서 노력하고 있다.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;4-2020년을-맞이하며&quot;&gt;4. 2020년을 맞이하며&lt;/h2&gt;

&lt;p&gt;아직은 어떤 기술 스텍을 쌓아야 할지 명확하게 모르겠다.&lt;/p&gt;

&lt;p&gt;하지만, 점점 더 소프트웨어 개발자라는 직업이 매력적으로 느껴진다. 배움의 두려움을 이겨낼 수 있는 개발자가 되고 싶다.&lt;/p&gt;

&lt;p&gt;이런 기술 스텍들은 기본적으로 가져가고 싶다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;자료구조/알고리즘, 문제해결능력&lt;/li&gt;
  &lt;li&gt;운영체제&lt;/li&gt;
  &lt;li&gt;컴퓨터 네트워크&lt;/li&gt;
  &lt;li&gt;NLP, VISION의 중요한 개념들&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">1. 2019년 계획했던 일</summary></entry><entry><title type="html">word representation</title><link href="https://fastpages.fast.ai/blog/nlp/2020/01/14/word-representation.html" rel="alternate" type="text/html" title="word representation" /><published>2020-01-14T00:00:00-06:00</published><updated>2020-01-14T00:00:00-06:00</updated><id>https://fastpages.fast.ai/blog/nlp/2020/01/14/word-representation</id><content type="html" xml:base="https://fastpages.fast.ai/blog/nlp/2020/01/14/word-representation.html">&lt;h1 id=&quot;word-representation-정리글&quot;&gt;Word Representation 정리글&lt;/h1&gt;

&lt;h2 id=&quot;word2vec-distributed-representation&quot;&gt;Word2vec: distributed representation&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;분산 표현(distributed representation) 방법은 기본적으로 분포 가설(distributional hypothesis)이라는 가정 하에 만들어진 표현 방법입니다. 이 가정은 &lt;strong&gt;‘비슷한 위치에서 등장하는 단어들은 비슷한 의미를 가진다’&lt;/strong&gt;라는 가정입니다.&lt;/p&gt;

  &lt;p&gt;reference: https://wikidocs.net/22660&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;1-cbowcontinuous-bag-of-words&quot;&gt;1. CBOW(Continuous Bag of Words)&lt;/h3&gt;

&lt;p&gt;주변에 있는 단어로 중간에 있는 단어를 예측하는 방법입니다. 중심단어를 예측하기 위해서 주변단어를 보는 범위를 window라고 합니다. 예를 들어서, 아래 이미지의 첫 번째 글에서 파란색 부분이 ‘fat’, ‘cat’이므로 window는 2입니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://wikidocs.net/images/page/22660/%EB%8B%A8%EC%96%B4.PNG&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;보통 딥 러닝이라함은, 입력층과 출력층 사이의 은닉층의 개수가 충분히 쌓인 신경망을 학습할 때를 말하는데 Word2Vec는 입력층과 출력층 사이에 하나의 은닉층만이 존재합니다. 이렇게 은닉층(hidden Layer)이 1개인 경우에는 일반적으로 심층신경망(Deep Neural Network)이 아니라 얕은신경망(Shallow Neural Network)이라고 부릅니다. 또한 Word2Vec의 은닉층은 일반적인 은닉층과는 달리 활성화 함수가 존재하지 않으며 룩업 테이블이라는 연산을 담당하는 층으로 일반적인 은닉층과 구분하기 위해 투사층(projection layer)이라고 부르기도 합니다.&lt;/p&gt;

  &lt;p&gt;reference: https://wikidocs.net/22660&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://wikidocs.net/images/page/22660/word2vec_renew_2.PNG&quot; /&gt;&lt;/p&gt;

&lt;p&gt;아래의 이미지를 보면 연산과정을 알 수 있다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$x_{cat}$: word one-hot vector&lt;/li&gt;
  &lt;li&gt;$W_{V * M}$:  input layer와 prejection layer사이의 matrix&lt;/li&gt;
  &lt;li&gt;$W’_{M* V}$: projection layer와 output layer간의 matrix&lt;/li&gt;
  &lt;li&gt;$V, M$: 단어의 개수, embedding 차원&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://wikidocs.net/images/page/22660/word2vec_renew_3.PNG&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://wikidocs.net/images/page/22660/word2vec_renew_5.PNG&quot; /&gt;&lt;/p&gt;

&lt;p&gt;loss function으로는 cross-entropy 함수를 사용하게 됩니다.&lt;/p&gt;

&lt;p&gt;이제 역전파(Back Propagation)를 수행하면 W와 W’가 학습이 되는데, 학습이 다 되었다면 M차원의 크기를 갖는 W의 행이나 W’의 열로부터 어떤 것을 임베딩 벡터로 사용할지를 결정하면 됩니다. 때로는 W와 W’의 평균치를 가지고 임베딩 벡터를 선택하기도 합니다.&lt;/p&gt;

&lt;h3 id=&quot;2-skip-gram&quot;&gt;2. Skip-Gram&lt;/h3&gt;

&lt;p&gt;중간에 있는 단어로 주변의 단어들을 예측하는 방법입니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://wikidocs.net/images/page/22660/word2vec_renew_6.PNG&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;3-negative-sampling&quot;&gt;3. Negative Sampling&lt;/h3&gt;

&lt;p&gt;대부분 word2vec은 negative sampling을 함께 사용합니다. word2vec의 학습과정을 잘 살펴보면, 출력층에 있는 softmax 함수는 단어집합 크기의 vector내의 모든 값을 0과 1사이의 값이면서 모두 더하면 1이 되도록 바꾸는 작업을 수행합니다. 이는 그 단어가 주변단어와 전혀 상관이 없는 단어라도 똑같이 적용되는 부분입니다.&lt;/p&gt;

&lt;p&gt;만약 마지막 단계에서 ‘강아지’와 ‘고양이’와 같은 단어에 집중하고 있다면, Word2Vec은 사실 ‘돈가스’나 ‘컴퓨터’와 같은 연관 관계가 없는 수많은 단어의 임베딩을 조정할 필요가 없습니다. 전체 단어집합이 아니라 일부 단어집합에 대해서만 고려해도 되지 않을까요?&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;‘강아지’, ‘고양이’, ‘애교’와 같은 주변 단어들을 가져옵니다. 그리고 여기에 ‘돈가스’, ‘컴퓨터’, ‘회의실’과 같은 랜덤으로 선택된 주변 단어가 아닌 상관없는 단어들을 일부만 갖고옵니다. 이렇게 전체 단어 집합보다 훨씬 작은 단어 집합을 만들어놓고 마지막 단계를 이진 분류 문제로 바꿔버리는 겁니다. 즉, Word2Vec은 주변 단어들을 긍정(positive)으로 두고 랜덤으로 샘플링 된 단어들을 부정(negative)으로 둔 다음에 이진 분류 문제를 수행합니다.&lt;/p&gt;

  &lt;p&gt;reference: https://wikidocs.net/22660&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;이는 기존의 다중 클래스 분류 문제를 이진 분류 문제로 바꾸면서도 연산량에 있어서 훨씬 효율적입니다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;negative sampling은 word2vec을 만들때 현재 문장에 없는 단어를 전체 데이터셋에서 추출하는 방법이다. 목적 단어와 연관성이 없을 것이라고 추정되는 단어를 추출한다.&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;자주 뽑히는 단어일 수록 연관성이 낮다고 본다. 흔한 단어일수록 목적 단어와의 관계는 강하지 않기 때문&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;아래는 한 단어 $w_i$가  negative sample로 뽑힐 확률이다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$f(w_i)$ : $w_i$의 등장빈도&lt;/li&gt;
&lt;/ul&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;0.75&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;0.75&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P(w_i) =\frac{f(w_i)^{0.75}}{\sum_{j=0}^n (f(w_j)^{0.75})}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.6212180000000003em;vertical-align:-1.1301100000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.491108em;&quot;&gt;&lt;span style=&quot;top:-2.305708em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol small-op&quot; style=&quot;position:relative;top:-0.0000050000000000050004em;&quot;&gt;∑&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.804292em;&quot;&gt;&lt;span style=&quot;top:-2.40029em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.2029em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.43581800000000004em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.311664em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286108em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.740108em;&quot;&gt;&lt;span style=&quot;top:-2.9890000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.1301100000000002em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;h4 id=&quot;word2vec의-한계점&quot;&gt;word2vec의 한계점&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;out of vocalbulary에 대해서는 word representation을 얻을 수 없다.&lt;/li&gt;
  &lt;li&gt;infrequent words는 학습이 불안정하다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;glove&quot;&gt;Glove&lt;/h2&gt;

&lt;p&gt;카운트 기반과 예측기반을 모두 사용하는 방법론입니다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;
      &lt;p&gt;LSA: 카운트 기반, 단어의미 유추 성능이 떨어짐.&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;Word2Vec: 예측기반, 전체적인 통계정보를 반영하지 못함.&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;단어의 동시 등장 행렬은 행과 열을 전체 단어 집합의 단어들로 구성하고, window size내에서 k단어가 등장한 횟수를 기록하는 행렬을 말합니다. 이 행렬은 transpose를 해도 동일합니다. (대칭행렬)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;예시&lt;/p&gt;

  &lt;p&gt;I like deep learning&lt;/p&gt;

  &lt;p&gt;I like NLP&lt;/p&gt;

  &lt;p&gt;I enjoy flying&lt;/p&gt;
&lt;/blockquote&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;카운트&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;I&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;like&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;enjoy&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;deep&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;learning&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;NLP&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;flying&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;I&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;like&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;enjoy&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;deep&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;learning&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NLP&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;flying&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;co-occurrence-probability&quot;&gt;Co-occurrence probability&lt;/h3&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;동시 등장 확률 $P(k&lt;/td&gt;
      &lt;td&gt;i), P(k&lt;/td&gt;
      &lt;td&gt;i)$는 동시 등장 행렬로부터 특정 단어 i의 전체 등장 횟수를 카운트하고, 특정 단어 i가 등장했을 때 어떤 단어 k가 등장한 횟수를 카운트하여 계산한 조건부 확률입니다.&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;예를 들어서, 위의 동시등장행렬을 바탕으로 P(‘I’|’like’)를 구해보자. ‘I’ 는 총 3번 등장하였다. ‘I’와 ‘like’가 동시에 등장한 횟수는 2번이다. 따라서 P(‘I’|’like’) 는 2/3이다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∣&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;∩&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P(A|B) = \frac{P(A) \cap P(B)}{P(B)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.53em;vertical-align:-0.52em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.01em;&quot;&gt;&lt;span style=&quot;top:-2.655em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.485em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;∩&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05017em;&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.52em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th style=&quot;text-align: left&quot;&gt;동시 등장 확률과 크기 관계 비(ratio)&lt;/th&gt;
        &lt;th style=&quot;text-align: left&quot;&gt;k=solid&lt;/th&gt;
        &lt;th style=&quot;text-align: left&quot;&gt;k=gas&lt;/th&gt;
        &lt;th style=&quot;text-align: left&quot;&gt;k=water&lt;/th&gt;
        &lt;th style=&quot;text-align: left&quot;&gt;k=fasion&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;P(k l ice)&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.00019&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.000066&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.003&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.000017&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;P(k l steam)&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.000022&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.00078&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.0022&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.000018&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;P(k l ice) / P(k l steam)&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;8.9&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.085&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;1.36&lt;/td&gt;
        &lt;td style=&quot;text-align: left&quot;&gt;0.96&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;

  &lt;p&gt;위의 표를 통해 알 수 있는 사실은 solid가 등장했을 때 ice가 등장할 확률 0.00019은 solid가 등장했을 때 steam이 등장할 확률인 0.000022보다 약 8.9배 크다는 겁니다. 그도 그럴 것이 solid는 ‘단단한’이라는 의미를 가졌으니까 ‘증기’라는 의미를 가지는 steam보다는 당연히 ‘얼음’이라는 의미를 가지는 ice라는 단어와 더 자주 등장할 겁니다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;loss-function&quot;&gt;Loss function&lt;/h3&gt;

&lt;p&gt;Embedding 된 중심단어와 주변 단어 벡터의 내적이 전체 코퍼스에서 동시 등장 확률이 되도록 모델을 학습시킨다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mstyle mathcolor=&quot;#cc0000&quot;&gt;&lt;mtext&gt;\mbox&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;≈&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∣&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\mbox{doc product}(W_i, W_k) \approx P(k|i) = P_{ik}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot; style=&quot;color:#cc0000;&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;color:#cc0000;&quot;&gt;\mbox&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;실제 학습에서는 아래의 식을 활용한다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mstyle mathcolor=&quot;#cc0000&quot;&gt;&lt;mtext&gt;\mbox&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;≈&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∣&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\mbox{doc product}(W_i, W_k) \approx \log P(k|i) = \log P_{ik}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot; style=&quot;color:#cc0000;&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;color:#cc0000;&quot;&gt;\mbox&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02778em;&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;ul&gt;
  &lt;li&gt;$X$ : 동시 등장 행렬(Co-occurrence Matrix)&lt;/li&gt;
  &lt;li&gt;$X_{ij}$ : 중심 단어 i가 등장했을 때 윈도우 내 주변 단어 j가 등장하는 횟수&lt;/li&gt;
  &lt;li&gt;$X_i$:$\sum_{j}X_{ij}$: 동시 등장 행렬에서 i행의 값을 모두 더한 값&lt;/li&gt;
  &lt;li&gt;$P_{ik}$ :$P(k|i)$ = $\frac{X_{ik}}{X_i}$ : 중심 단어 i가 등장했을 때 윈도우 내 주변 단어 k가 등장할 확률
Ex) P(solid l ice) = 단어 ice가 등장했을 때 단어 solid가 등장할 확률&lt;/li&gt;
  &lt;li&gt;$\frac{P_{ik}}{P_{jk}}$ : $P_{ik}$를  $P_{jk}$로 나눠준 값
Ex) P(solid l ice) / P(solid l steam) = 8.9&lt;/li&gt;
  &lt;li&gt;$W_i$ : 중심 단어 i의 임베딩 벡터&lt;/li&gt;
  &lt;li&gt;$W_k$ : 주변 단어 k의 임베딩 벡터&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;embedding vector의 목적은 단어간의 관계를 잘 표현하는데 있습니다. 위에서 살펴본 $\frac{P_{ik}}{P_{jk}}$ 를 목적함수에 사용합니다. 먼저 함수의 input과 output을 정의해봅니다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F(W_i, W_j, W_k) =\frac{P_{ik}}{P_{jk}}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.036108em;vertical-align:-0.286108em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.311664em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286108em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.4422709999999999em;vertical-align:-0.5480799999999999em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.894191em;&quot;&gt;&lt;span style=&quot;top:-2.6550000000000002em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.13889em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.29011428571428566em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.41586em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.13889em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.5480799999999999em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;input에서 output을 도출하는 방법은 많겠지만, 해당 연구에서는 두 단어간의 차이를 input으로 넣는 것을 제안합니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F(W_i - W_j, W_k) =\frac{P_{ik}}{P_{jk}}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.036108em;vertical-align:-0.286108em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.311664em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286108em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.332438em;vertical-align:-0.972108em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.36033em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3361079999999999em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286108em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.972108em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;그리고  선형 공간에서 두 vector간의 유사도를 보기 위해서 dot product를 선택했습니다. 
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F((W_i -W_j) ^ T W_k) =\frac{P_{ik}}{P_{jk}}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1274389999999999em;vertical-align:-0.286108em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.311664em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286108em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.4422709999999999em;vertical-align:-0.5480799999999999em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.894191em;&quot;&gt;&lt;span style=&quot;top:-2.6550000000000002em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.13889em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.29011428571428566em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.41586em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.13889em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.5480799999999999em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;정리하자면 선형공간에서 단어의 의미 관계를 표현하기 위해 뺄셈과 내적(dot procut)를 활용했습니다.&lt;/p&gt;

&lt;p&gt;여기서 함수 F는 중심단어와 주변단어의 선택기준이 무작위이기 때문에, 이 둘의 관계는 함수 F안에서 자유롭게 교환가능해야 합니다. 이 조건을 만족하기 위해서는 Homomorphism이라는 조건을 만족해야합니다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt; &lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∀&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F(a+b) = F(a)F(b) \ \forall a, b \in R&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∀&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.00773em;&quot;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;In &lt;a href=&quot;https://en.wikipedia.org/wiki/Algebra&quot;&gt;algebra&lt;/a&gt;, a &lt;strong&gt;homomorphism&lt;/strong&gt; is a &lt;a href=&quot;https://en.wikipedia.org/wiki/Morphism&quot;&gt;structure-preserving&lt;/a&gt; &lt;a href=&quot;https://en.wikipedia.org/wiki/Map_(mathematics)&quot;&gt;map&lt;/a&gt; between two &lt;a href=&quot;https://en.wikipedia.org/wiki/Algebraic_structure&quot;&gt;algebraic structures&lt;/a&gt; of the same type (such as two &lt;a href=&quot;https://en.wikipedia.org/wiki/Group_(mathematics)&quot;&gt;groups&lt;/a&gt;, two &lt;a href=&quot;https://en.wikipedia.org/wiki/Ring_(mathematics)&quot;&gt;rings&lt;/a&gt;, or two &lt;a href=&quot;https://en.wikipedia.org/wiki/Vector_space&quot;&gt;vector spaces&lt;/a&gt;).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Homomorphism의 조건하에서 a와 b가 각각 vector라면 scalar값이 나올 수 없지만 내적값이라고 하면 scalar값이 나올 수 있습니다.&lt;/p&gt;

&lt;p&gt;v1, v2, v3, v4 모두 vector입니다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;  &lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∀&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F(v1^T v2 + v3^Tv4) = F(v1^T v2) F(v3^Tv4) \ \ \forall v1, v2, v3, v4 \in V&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0913309999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0913309999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0913309999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∀&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.22222em;&quot;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
F는 두 vector의 차이를  받았기 때문에, 뺄셈에 대한 homomorphism으로 변경했습니다.&lt;/p&gt;

&lt;p&gt;(간단하게 덧셈 ~ 곱셈 관계를 뺄셈 ~ 나누기 관계로 치환하였습니다.)
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;  &lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∀&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F(v1^T v2 - v3^Tv4) = \frac{F(v1^T v2)}{F(v3^Tv4)} \ \ \forall v1, v2, v3, v4 \in V&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0913309999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0913309999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.65523em;vertical-align:-0.5268649999999999em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.128365em;&quot;&gt;&lt;span style=&quot;top:-2.648135em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7740928571428571em;&quot;&gt;&lt;span style=&quot;top:-2.786em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.485em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9190928571428572em;&quot;&gt;&lt;span style=&quot;top:-2.931em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.5268649999999999em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∀&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∈&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.22222em;&quot;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
이제 glove식에 적용해보겠습니다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F((w_i - w_j)^Tw_k) = \frac{F(w_i^T w_k)}{F(w_j^T w_k)}= \frac{P_{ik}}{P_{jk}}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1274389999999999em;vertical-align:-0.286108em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.311664em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286108em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.8694099999999998em;vertical-align:-0.7158449999999998em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.153565em;&quot;&gt;&lt;span style=&quot;top:-2.6069750000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8328928571428571em;&quot;&gt;&lt;span style=&quot;top:-2.177714285714286em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.8448em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.46117142857142857em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.5102em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9190928571428572em;&quot;&gt;&lt;span style=&quot;top:-2.214em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.931em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7158449999999998em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.4422709999999999em;vertical-align:-0.5480799999999999em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.894191em;&quot;&gt;&lt;span style=&quot;top:-2.6550000000000002em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.13889em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.29011428571428566em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.41586em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.13889em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.5480799999999999em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
위의 식에서 조금 더 자세히 살펴보면,
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F(w_i^Tw_k) = P_{ik} = \frac{X_{ik}}{X_i}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0999949999999998em;vertical-align:-0.258664em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.441336em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.258664em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.3392909999999998em;vertical-align:-0.44509999999999994em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.894191em;&quot;&gt;&lt;span style=&quot;top:-2.655em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3280857142857143em;&quot;&gt;&lt;span style=&quot;top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.143em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.41586em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.07847em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.44509999999999994em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
또한 좌변을 풀어쓰면,
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;F((w_i - w_j)^Tw_k) = F(w_i^T w_k - w_j^T w_k) = \frac{F(w_i^T w_k)}{F(w_j^T w_k)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1274389999999999em;vertical-align:-0.286108em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.311664em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286108em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0999949999999998em;vertical-align:-0.258664em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.441336em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.258664em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.236103em;vertical-align:-0.394772em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.441336em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.394772em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.8694099999999998em;vertical-align:-0.7158449999999998em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.153565em;&quot;&gt;&lt;span style=&quot;top:-2.6069750000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8328928571428571em;&quot;&gt;&lt;span style=&quot;top:-2.177714285714286em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.8448em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.46117142857142857em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.5102em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9190928571428572em;&quot;&gt;&lt;span style=&quot;top:-2.214em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.931em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7158449999999998em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
따라서 homomorphism을 형태와 일치하게 됩니다.&lt;/p&gt;

&lt;p&gt;그리고 이러한 조건을 만족시키는 함수는 지수 함수(Exponential function)입니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/Exp.svg/200px-Exp.svg.png&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$x^{a + b} = x ^ a * x ^ b$&lt;/li&gt;
  &lt;li&gt;$x^{a - b} = x ^ a / x ^ b$&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;이제 F를 $\exp$라고 해봅시다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\exp(w_i^T w_k - w_j^T w_k) = \frac{\exp(w_i^T w_k)}{\exp(w_j^T w_k)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0999949999999998em;vertical-align:-0.258664em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.441336em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.258664em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.236103em;vertical-align:-0.394772em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.441336em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.394772em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.8694099999999998em;vertical-align:-0.7158449999999998em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.153565em;&quot;&gt;&lt;span style=&quot;top:-2.6069750000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mop mtight&quot;&gt;&lt;span class=&quot;mtight&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mtight&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mtight&quot;&gt;p&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8328928571428571em;&quot;&gt;&lt;span style=&quot;top:-2.177714285714286em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.05724em;&quot;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.8448em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.46117142857142857em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.5102em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mop mtight&quot;&gt;&lt;span class=&quot;mtight&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;mtight&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mtight&quot;&gt;p&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9190928571428572em;&quot;&gt;&lt;span style=&quot;top:-2.214em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.931em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.286em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3448em;&quot;&gt;&lt;span style=&quot;top:-2.3487714285714287em;margin-left:-0.02691em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15122857142857138em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7158449999999998em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;학습의 안정성을 위해서, log를 사용합니다.&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;w_i^T w_k  = \log P_{ik}=\log (\frac{X_{ik}}{X_i})=\log X_{ik} - \log X_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.138331em;vertical-align:-0.247em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8913309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.4530000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.247em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:2.19633em;vertical-align:-0.8360000000000001em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.36033em;&quot;&gt;&lt;span style=&quot;top:-2.3139999999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8360000000000001em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;위의 식은 homomorphism이 성립해야하지만, $\log X_i$ 때문에 성립하지 않게 됩니다. ($a - b \ne b-  a$)그래서 glove 연구팀은 $\log X_i$항을 bias $b_i$라는 상수항으로 대체합니다. 같은 이유로 $w_k$에 대한 bias $b_k$를 추가합니다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;w_i^T w_k + b_i + b_k = \log X_{ik}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.0999949999999998em;vertical-align:-0.258664em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.441336em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.258664em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mstyle mathcolor=&quot;#cc0000&quot;&gt;&lt;mtext&gt;\mbox&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\mbox{loss function} = \sum_{m,n = 1}^V (w_m ^ T w_n + b_m + b_n - \log X_{mn})^2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot; style=&quot;color:#cc0000;&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;color:#cc0000;&quot;&gt;\mbox&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:3.2315570000000005em;vertical-align:-1.403221em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.8283360000000002em;&quot;&gt;&lt;span style=&quot;top:-1.8828869999999998em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mpunct mtight&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.0500049999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop op-symbol large-op&quot;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.300005em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.22222em;&quot;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.403221em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8913309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.4530000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.247em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.1141079999999999em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8641079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;ul&gt;
  &lt;li&gt;$V$ : 단어집합의 크기&lt;/li&gt;
  &lt;li&gt;$X_{ik}$ 이 0이 될수도 있으므로 $\log(1+X_{ik})$로 바꾼다.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;또한 동시등장행렬이 희소행렬일 가능성이 높다. glove 연구진은 동시 등장 행렬에서 등장 빈도의 값 $X_{ik}$가 매우 낮은 경우에는 정보가 거의 도움이 되지 않는다고 판단합니다. 따라서 동시등장행렬을 바탕으로 가중치함수를 구상하게 됩니다.&lt;/p&gt;

&lt;p&gt;가중치 함수의 그래프는 아래와 같습니다. 특정 값보다 크다면 모두 같은 가중치를 주게 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://wikidocs.net/images/page/22885/%EA%B0%80%EC%A4%91%EC%B9%98.PNG&quot; /&gt;
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;min&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;0.75&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;f(x) = \min(1, (\frac{x}{x_{\max}})^{0.75})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.2592079999999999em;vertical-align:-0.44509999999999994em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.695392em;&quot;&gt;&lt;span style=&quot;top:-2.655em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.16454285714285719em;&quot;&gt;&lt;span style=&quot;top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mop mtight&quot;&gt;&lt;span class=&quot;mtight&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mtight&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mtight&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.143em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.394em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.44509999999999994em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
최종적으로 목적함수는 아래의 식과 같습니다.
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mstyle mathcolor=&quot;#cc0000&quot;&gt;&lt;mtext&gt;\mbox&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;min&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\mbox{loss function} = \sum_{m,n = 1}^V f(X_{\min})(w_m ^ T w_n + b_m + b_n - \log X_{mn})^2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot; style=&quot;color:#cc0000;&quot;&gt;&lt;span class=&quot;mord&quot; style=&quot;color:#cc0000;&quot;&gt;\mbox&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.417049em;vertical-align:-0.43581800000000004em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol small-op&quot; style=&quot;position:relative;top:-0.0000050000000000050004em;&quot;&gt;∑&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.981231em;&quot;&gt;&lt;span style=&quot;top:-2.40029em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mpunct mtight&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.2029em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.22222em;&quot;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.43581800000000004em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31750199999999995em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mop mtight&quot;&gt;&lt;span class=&quot;mtight&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8413309999999999em;&quot;&gt;&lt;span style=&quot;top:-2.4530000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.13889em;&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.247em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.064108em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;h2 id=&quot;fasttext&quot;&gt;FastText&lt;/h2&gt;

&lt;p&gt;FastText는 단어를 구성하는 Subwords(substrings)의 vector 합으로 단어 vector를 표현합니다. 이 방법은 typo(오식)가 있는 단어라 할지라도 비슷한 representation을 얻을 수 있으며, 새로운 단어에 대해서도 형태적 유사성을 고려한 적당한 word representation을 얻도록 도와줍니다.&lt;/p&gt;

&lt;p&gt;자연어 처리에서 자주 등장하는 문제는 (1) out of vocabulary, (2) infrequent words(모호성) 입니다. word2vec에서는 앞/뒤에 등장하는 단어로 가운데 단어를 예측하게 학습함으로서 문맥이 비슷한 단어를 유사한 vector로 표현합니다.&lt;/p&gt;</content><author><name></name></author><summary type="html">Word Representation 정리글</summary></entry><entry><title type="html">BERT 정리글</title><link href="https://fastpages.fast.ai/blog/deeplearning/nlp/2019/12/30/BERT-%EC%A0%95%EB%A6%AC%EA%B8%80.html" rel="alternate" type="text/html" title="BERT 정리글" /><published>2019-12-30T00:00:00-06:00</published><updated>2019-12-30T00:00:00-06:00</updated><id>https://fastpages.fast.ai/blog/deeplearning/nlp/2019/12/30/BERT-%EC%A0%95%EB%A6%AC%EA%B8%80</id><content type="html" xml:base="https://fastpages.fast.ai/blog/deeplearning/nlp/2019/12/30/BERT-%EC%A0%95%EB%A6%AC%EA%B8%80.html">&lt;h1 id=&quot;bert-bidirectional-encoder-representations-from-transformers&quot;&gt;&lt;strong&gt;BERT, Bidirectional Encoder Representations from Transformers&lt;/strong&gt;&lt;/h1&gt;

&lt;h2 id=&quot;abstract&quot;&gt;Abstract&lt;/h2&gt;

&lt;p&gt;BERT는  unlabeled text를 기반으로 deep bidirectional representation을 pretrain하기 위해서 만들어졌다. 이는 모든 layer에서 왼쪽과 오른쪽 모두의 context정보를 바탕으로 만들어진다.&lt;/p&gt;

&lt;p&gt;결과적으로 pretrained된 BERT 모델은 output layer을 추가하고 fine-tuning을 함으로써 question answering 그리고 language inference분야에서 state-of-the-art 성능을 낼 수 있다. 이는 task-specific한 구조의 변화없이 가능하다.&lt;/p&gt;

&lt;h2 id=&quot;1-introduction&quot;&gt;1. Introduction&lt;/h2&gt;

&lt;p&gt;pretrained language representation을 활용하는데는 두 가지 전략이 있다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Feature-based: ELMO&lt;/p&gt;

    &lt;p&gt;task-specific한 architecture를 사용한다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;fine-tuning: OpenAI GPT&lt;/p&gt;

    &lt;p&gt;task-specific한 parameter를 적게 사용한다.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;위의 두 가지 전략은 pretraining을 하는동안 동일한 objective를 사용하게 된다. 또한 모두 unidirectional representation을 사용하고 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://mino-park7.github.io/images/2018/12/%EA%B7%B8%EB%A6%BC1-bert-openai-gpt-elmo-%EC%B6%9C%EC%B2%98-bert%EB%85%BC%EB%AC%B8.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;하지만, 본 논문에서는 unidirectional representation이 pretrained representation 능력을 제한한다고 주장하며,  이는 특히 fine-tuning 방법론에 영향을 많이 끼친다고 말한다. 가장 큰 한계는 standard language models가 unidirectional하며 이는 architecture를 선택할 때 많은 제한을 두게 된다. 예를 들어서, openAI GPT의 경우 left-to-right architecture를 사용한다. 모든 토큰은 self-attention layer에서 자기 자신보다 이전의 있는 토큰에만 영향을 끼친다. 이런 제한은 sentence-level task에서 sub-optimal하다.&lt;/p&gt;

&lt;p&gt;이 논문에서는 세 가지 contribution을 제공한다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Bidirectional pre-training for language representation&lt;/li&gt;
  &lt;li&gt;pre-trained representation은  task-specific architecture의 필요성을 감소시킨다.&lt;/li&gt;
  &lt;li&gt;11가지 NLP task에 대해서 SOTA의 성능을 보인다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;2-related-work&quot;&gt;2. Related Work&lt;/h2&gt;

&lt;p&gt;pre-training general language representations에 관련된 연구들이다.&lt;/p&gt;

&lt;h3 id=&quot;21-unsupervised-feature-based-approaches&quot;&gt;2.1 Unsupervised Feature-based Approaches&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;word embedding vectors&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ELMO&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;22--unsupervised-fine-tuning-approaches&quot;&gt;2.2  Unsupervised Fine-tuning Approaches&lt;/h3&gt;

&lt;p&gt;word embedding parameter를 unlabeled text로 pre-trained 하는 것으로 연구가 시작되었다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;OpenAI GPT&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;fine-tuning approach는 학습과정에서 적은 parameter를 학습시키면 된다는 장점을 가지고 있다.&lt;/p&gt;

&lt;h3 id=&quot;23-transfer-learning-from-supervised-data&quot;&gt;2.3 Transfer Learning from Supervised Data&lt;/h3&gt;

&lt;p&gt;NLP, vision task에서 모두 tranfer learning은 효과적임을 보여주고 있다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Imagenet pretrained&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;3-bert-unified-architecture-across-different-tasks&quot;&gt;3. BERT: unified architecture across different tasks.&lt;/h2&gt;

&lt;p&gt;BERT는 두 가지 단계를 가지고 있다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;pre-training: unlabeled data를 이용해서 학습을 진행한다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;fine-tuning: weight값을 pre-trained된 값으로 초기화해준다. 그 후 labeled data를 이용해서 지도학습을 진행하게 된다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Model Architecture&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;Transformer 기반으로 만들어졌다. Transformer 논문은 encoder decoder구조로 이루어져 있지만, BERT에서는 encoder 위주로 사용한다.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/1250095/49935094-73f99c80-ff13-11e8-8ba5-50a008ed4d20.png&quot; style=&quot;width: 50%&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;**Input/Output Representations **&lt;/p&gt;

    &lt;p&gt;down-stream task에서 잘 작동하려면, input representation이 single sentence 혹은 a pair of sentence에 모두 유연하게 반응할 수 있어야 한다.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/1250095/50039788-8e4e8a00-007b-11e9-9747-8e29fbbea0b3.png&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;해당 논문은 WordPiece embeddings을 사용하였다. 첫번째 token은 항상 [CLS]이다.(special classification token의 역할을 수행) 그리고 [CLS]에 반응하는 hidden state는 classification task를 위한 representation을 모으는 역할을 수행한다.&lt;/p&gt;

    &lt;p&gt;또한 두 가지 방법으로 sentence를 구분한다.&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;special token [SEP]를 이용하여 sentence를 구분한다.&lt;/li&gt;
      &lt;li&gt;각 sentence에 sentence embedding을 더하여 어떤 sentence정보를 가지고 있는지 알려준다.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;31-pre-training-bert&quot;&gt;3.1 Pre-training BERT&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Task #1: Masked LM&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;직관적으로, bidirectional representation이 unidirectional representation보다 좋다는 것은 쉽게 알 수 있다. 하지만,  기존의 연구에서 사용하지 않은 이유는 바로 bidirectional representation을 하게 되면, 간접적으로 각 word가 자신에 대한 정보를 쉽게 얻을 수 있게 되며, 모델이 multi layerd contex에서 target word를 참조하기 힘들게 한다.&lt;/p&gt;

    &lt;p&gt;위의 한계점을 극복하고 deep bidirectional representation한 train을 하기 위해서 해당 연구에서는 input token중 일부를 랜덤하게 마스크하고 이렇게 mask된 단어들을 학습하도록 유도하였다. 이를 masked LM(MLM)이라고 한다. 실험적으로 약 15%의 token을 마스크하는것이 효과적이였다.&lt;/p&gt;

    &lt;p&gt;하지만, fine-tuning을 할 때, 문제가 발생한다. 바로 [Mask] 했던 token들은 fine-tuning과정에서는 발생하지 않기 때문이다. 이러한 문제점을 해결하기 위해서, 다음과 같은 조치를 취하였다.&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;i-token이 mask되었다면, 80% 확률로 [Mask]로 대체한다.&lt;/p&gt;

        &lt;p&gt;나는 학생이다. -&amp;gt; 나는 [Mask]이다.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;i-token이 mask되었다면, 10% 확률로 random하게 다른 단어로 대체한다.&lt;/p&gt;

        &lt;p&gt;나는 학생이다 -&amp;gt; 나는 아파트이다.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;i-token이 mask되었다면,  10% 확률로 변화시키지 않는다.&lt;/p&gt;

        &lt;p&gt;나는 학생이다. -&amp;gt; 나는 학생이다.&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;이런 조치를 취하게 되면, Transformer layer가  cross entropy loss로 학습을 진행하게 된다. 참고로 random하게 단어를 변화시키는 확률은 $0.15 * 0.1 = 0.015$ 로 모델의 표현력을 저하시키지 않는다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Task #2: Next Sentence Prediction(NSP)&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;Question Answering, Natural Language Inference와 같은 task에서 두 문장 사이의 관계를 파악하는 것은 중요하다. 이는 language modeling에서 직접적으로 관계를 파악하기 힘들다. 두 문장 사이의 관계를 파악하기 위해서 해당 논문은 next sentence prediction task로 pre-train을 하였다.&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;특히 A문장과 B문장을 고를때, 50%확률로 B가 실제로 뒤에 있는 문장이다.&lt;/li&gt;
      &lt;li&gt;나머지 50% 확률로 random하게 배치한다.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;하지만, 이전 연구에서는 sentence embedding만 down-task에 전이가 한다. (BERT는 모든 parameter를 전이한다.)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;32-fine-tunning-bert&quot;&gt;3.2 Fine-tunning BERT&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;self-attention layer의 영향으로 fine-tuning은 매우 순조롭다.&lt;/li&gt;
  &lt;li&gt;input sequence에 대해서 일정한 차원수의 representation 결과를 얻고 싶기 때문에, &lt;code class=&quot;highlighter-rouge&quot;&gt;[CLS]&lt;/code&gt; token의 &lt;strong&gt;Transformer output&lt;/strong&gt;값을 사용합니다.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[CLS]&lt;/code&gt; token의 벡터는 H차원을 가집니다. $C∈R^H$&lt;/li&gt;
  &lt;li&gt;여기서 &lt;strong&gt;classify하고 싶은 갯수(K)에 따라 classification layer&lt;/strong&gt;를 붙여 줍니다. classification layer : $W∈R^{K×H} W∈R^{K×H}$&lt;/li&gt;
  &lt;li&gt;label probabilities는 &lt;strong&gt;standard softmax&lt;/strong&gt;로 계산 됩니다.$P=softmax(CWT)P=softmax(CWT)$&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;W matrix와 BERT의 모든 파라미터가 같이 fine-tuning 됩니다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;hyperparmeter&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Batch size&lt;/strong&gt;: 16, 32 &lt;strong&gt;Learning rage (Adam)&lt;/strong&gt;: 5e-5, 3e-5, 2e-5 Number of epochs : 3, 4&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;pretraining과 비교했을때, 상대적으로 fine-tuning은 적은 비용으로 학습시킬수 있다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;fine-tuning시 dataset의 크기가 클수록 hyperparameter의 영향을 덜 받고 잘 training됨을 관측할 수 있었다고 합니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;33-comparision-of-bert-elmo-and-openai-gpt&quot;&gt;3.3 Comparision of BERT, ELMO and OpenAI GPT&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://mino-park7.github.io/images/2018/12/%EA%B7%B8%EB%A6%BC1-bert-openai-gpt-elmo-%EC%B6%9C%EC%B2%98-bert%EB%85%BC%EB%AC%B8.png&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;BERT와 OpenAI GPT는 fine-tuning approach인 반면에, ELMo는 feature-based approach이다.&lt;/li&gt;
  &lt;li&gt;BERT와 OpenAI GPT는 유사한 pre-training방법론을 사용하였다.&lt;/li&gt;
  &lt;li&gt;BERT와 ELMo는 bidirectional representation을 얻는다. OpenAI GPT는 unidirectional representation을 사용한다.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;4experiments&quot;&gt;4.Experiments&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Fine-tunning on Different Tasks&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://mino-park7.github.io/images/2019/02/%EA%B7%B8%EB%A6%BC4-bert-experiment-result.png&quot; style=&quot;width: 80%&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위의 그림은 각 task에 대한 fine-tuning 방법론을 시각화한 것이다. (a), (b)는 sentence level, (c)와 (d)는 token-level task이다. 참고로 [CLS]는 classification을 위한 단어이고, [SEP]는 연속적이지 않은 token을 나누기 위한 단어이다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;GLUE&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;SQuAD v1.1&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;SQuAD v2.0&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;SWAG&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;5-ablation-studies&quot;&gt;5. Ablation Studies&lt;/h2&gt;

&lt;h3 id=&quot;51-effect-of-pre-training-tasks&quot;&gt;5.1 Effect of Pre-training Tasks&lt;/h3&gt;

&lt;h3 id=&quot;51-effect-of-model-size&quot;&gt;5.1 Effect of Model Size&lt;/h3&gt;

&lt;h3 id=&quot;53-feature-based-approach-with-bert&quot;&gt;5.3 Feature-based Approach with BERT&lt;/h3&gt;

&lt;h2 id=&quot;6-conclusion&quot;&gt;6. Conclusion&lt;/h2&gt;</content><author><name></name></author><summary type="html">BERT, Bidirectional Encoder Representations from Transformers</summary></entry></feed>