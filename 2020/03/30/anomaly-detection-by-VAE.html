<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Variational Autoencoder based Anomaly Dection using Reconstruction Probability | RoundTable</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Variational Autoencoder based Anomaly Dection using Reconstruction Probability" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="by jupyter notebook" />
<meta property="og:description" content="by jupyter notebook" />
<link rel="canonical" href="https://rroundtable.github.io//blog/2020/03/30/anomaly-detection-by-VAE.html" />
<meta property="og:url" content="https://rroundtable.github.io//blog/2020/03/30/anomaly-detection-by-VAE.html" />
<meta property="og:site_name" content="RoundTable" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-30T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"by jupyter notebook","mainEntityOfPage":{"@type":"WebPage","@id":"https://rroundtable.github.io//blog/2020/03/30/anomaly-detection-by-VAE.html"},"@type":"BlogPosting","url":"https://rroundtable.github.io//blog/2020/03/30/anomaly-detection-by-VAE.html","headline":"Variational Autoencoder based Anomaly Dection using Reconstruction Probability","dateModified":"2020-03-30T00:00:00-05:00","datePublished":"2020-03-30T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://rroundtable.github.io//blog/feed.xml" title="RoundTable" /><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4NHFHZZ2SF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4NHFHZZ2SF');
</script><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Variational Autoencoder based Anomaly Dection using Reconstruction Probability | RoundTable</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Variational Autoencoder based Anomaly Dection using Reconstruction Probability" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="by jupyter notebook" />
<meta property="og:description" content="by jupyter notebook" />
<link rel="canonical" href="https://rroundtable.github.io//blog/2020/03/30/anomaly-detection-by-VAE.html" />
<meta property="og:url" content="https://rroundtable.github.io//blog/2020/03/30/anomaly-detection-by-VAE.html" />
<meta property="og:site_name" content="RoundTable" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-30T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"by jupyter notebook","mainEntityOfPage":{"@type":"WebPage","@id":"https://rroundtable.github.io//blog/2020/03/30/anomaly-detection-by-VAE.html"},"@type":"BlogPosting","url":"https://rroundtable.github.io//blog/2020/03/30/anomaly-detection-by-VAE.html","headline":"Variational Autoencoder based Anomaly Dection using Reconstruction Probability","dateModified":"2020-03-30T00:00:00-05:00","datePublished":"2020-03-30T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://rroundtable.github.io//blog/feed.xml" title="RoundTable" /><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4NHFHZZ2SF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4NHFHZZ2SF');
</script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script type="text/javascript">
require.config({
  paths: {
    jquery: 'https://code.jquery.com/jquery-3.5.0.min',
    plotly: 'https://cdn.plot.ly/plotly-latest.min'
  },

  shim: {
    plotly: {
      deps: ['jquery'],
      exports: 'plotly'
    }
  }
});
</script>

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">RoundTable</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Variational Autoencoder based Anomaly Dection using Reconstruction Probability</h1><p class="page-description">by jupyter notebook</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-03-30T00:00:00-05:00" itemprop="datePublished">
        Mar 30, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/RoundTable/blog/tree/master/_notebooks/2020-03-30-anomaly-detection-by-VAE.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/RoundTable/blog/master?filepath=_notebooks%2F2020-03-30-anomaly-detection-by-VAE.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/RoundTable/blog/blob/master/_notebooks/2020-03-30-anomaly-detection-by-VAE.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-30-anomaly-detection-by-VAE.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Backgraound">Backgraound<a class="anchor-link" href="#Backgraound"> </a></h2><h3 id="Anomaly-deteciton">Anomaly deteciton<a class="anchor-link" href="#Anomaly-deteciton"> </a></h3><p>anomaly detection 방법은 다음과 같은 3가지 관점으로 분류할 수 있다.</p>
<ul>
<li>statistical</li>
<li>proximity</li>
<li>deviation</li>
</ul>
<p><strong>statistical관점</strong>은 data가 특정 분포를 따른다고 가정한다. 예를 들어, parametric model인 Gaussian Mixture Model이나 nonparametric model인 kernel density estimation은 이런 분포를 정의하는데 사용될 수 있다. 만약 특정 data point가 가정한 분포에서 낮은 확률을 가진다면, anomaly라고 정의할 수 있다. probability를 기반으로 anomaly를 정의할 수 있다는 장점을 가지고 있다.</p>
<p><strong>proximity</strong>관점은 anomaly data가 다른 데이터와 고립되어 있다고 가정한다. 이 관점은 크게 세가지 방법을 가지고 있다.</p>
<ul>
<li><p>clustering</p>
<p>cluster의 크기나 centroid의 거리를 가지고 anomaly를 결정한다.</p>
</li>
<li><p>density</p>
<p>특정 위치의 data가 밀집된 정도가 낮다면, anomaly로 정의할 수 있다.</p>
</li>
<li><p>distance</p>
<p>neighbor와의 거리가 멀다면, anomaly로 정의할 수 있다.</p>
</li>
</ul>
<p><strong>deviation</strong></p>
<p>reconstruction error를 바탕으로 anomaly를 정의할 수 있다. 이를 위해서는 우선, dimension reduction방법을 통해 압축된 정보를 바탕으로 reconstruct해야한다. 그리고 실제 데이터와의 차이를 reconstruction error로 정의한다. 만약 reconstruction error가 특정 수준보다 높다면, anomaly라고 정의한다.</p>
<h3 id="Autoencoder-and-anomaly-detection">Autoencoder and anomaly detection<a class="anchor-link" href="#Autoencoder-and-anomaly-detection"> </a></h3><p><img src="https://lilianweng.github.io/lil-log/assets/images/autoencoder-architecture.png" alt="" title="Autoencoder" /></p>
<p>autoencoder의 objective는 아래와 같다.</p>
$$
L_\text{AE}(\theta, \phi) = \frac{1}{n}\sum_{i=1}^n (\mathbf{x}^{(i)} - f_\theta(g_\phi(\mathbf{x}^{(i)})))^2
$$<p>autoencoder를 활용하여, anomaly detection을 수행하면, 
reconstruction error $ \mid \mid \mathbf{x}^{(i)} - f_\theta(g_\phi(\mathbf{x}^{(i)})) \mid \mid$를 anomaly를 판별하는데 사용한다.</p>
<h3 id="Variational-Autoencoder">Variational Autoencoder<a class="anchor-link" href="#Variational-Autoencoder"> </a></h3><p>variation Autoencoder는 다음 링크에서 자세히 확인 할 수 있다.</p>
<p><a href="https://rroundtable.github.io/FastPages/vae/deeplearning/2020/03/25/VAE.html">https://rroundtable.github.io/FastPages/vae/deeplearning/2020/03/25/VAE.html</a></p>
<p>autoencoder와의 다른 점은 autoencoder는 input variable자체를 압축하고 복원하는 과정을 거치지만, VAE는 복원하는 것이 input variable로 부터 만들어진 paramters(mean, var)를 바탕으로 복원한다.</p>
<h2 id="Proposed-Method">Proposed Method<a class="anchor-link" href="#Proposed-Method"> </a></h2><h3 id="Algorithm">Algorithm<a class="anchor-link" href="#Algorithm"> </a></h3><p>Monte-Carlo estimate를 통해서 $\mathbb{E}_{q_{\phi (x \mid z)} [\log p_{\theta}(x \mid z)]}$를 근사할 수 있다.</p>
<p>한 데이터 포인트의 reconstruction probability는 다음과 같다.</p>
$$
\frac{1}{L} \sum_{l=1}^L p_{\theta}(x^{(i)} \mid u_{\hat{x}^{(i, l)}}, \sigma_{\hat{x}^{(i, l)}})
$$<h3 id="Reconstruction-Probability">Reconstruction Probability<a class="anchor-link" href="#Reconstruction-Probability"> </a></h3><p>VAE는 복원하는 것이 input variable로 부터 만들어진 paramters(mean, var)를 바탕으로 복원한다. 이 mean과 var로 만들어진 분포는 확률분포로 해석할 수 있다.</p>
<p>또한, mean값 뿐만 아니라 variance도 함께 고려한다는 점도 중요하다.</p>
<h3 id="Difference-from-an-autoencoder-based-anomaly-detection">Difference from an autoencoder based anomaly detection<a class="anchor-link" href="#Difference-from-an-autoencoder-based-anomaly-detection"> </a></h3><p>첫 번째 차이점은 VAE의 latent variable이 stochastic variable이라는 것이다.(latent variable이 복원해야하는 대상이 아니고 복원에 필요한 parameter를 의미한다.) autoencoder의 latent variable은 deterministic하게 정해진다. 이런 차이점이 VAE의 표현능력을 키워준다. 특정 분포에서 sampling하기 때문에, 다양한 variable를 경험할 수 있다. 그리고 anomaly data는 variance가 높아서 reconstructiuon probability가 낮다.</p>
<p>두 번째 차이점은 VAE의 reconstruction variable 또한 stochastic하다는 것이다. reconstruction probability는 original input과 reconstruction간의 차이와 함께 variance도 고려한다.</p>
<p>세 번째 차이점은 VAE는 복원정도를 probability 확률로 측정할 수 있다는 것이다. autoencoder는 reconstruction error를 통해서 measure해야하기 때문에, input variable이 heterogeneous하다면 측정하기 힘들다. heterogeneous하다면, 각각 다른 가중치를 곱해줘야 하며, anomaly를 판단하기 위한 threshold를 결정하기도 쉽지 않다.</p>
<p>반면에, VAE는 heterogeneous한 데이터에도 각각 다른 가중치를 곱할 필요가 없다. 이는 각 heterogeneous한 데이터 마다 variance를 구해주기 때문에 각각의 분포를 정의할 수 있게 되기 때문이다. 또한 1%의 확률은 어떤 데이터에서든 1%의 의미를 가진다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pytorch-&#44396;&#54788;&#52404;">Pytorch &#44396;&#54788;&#52404;<a class="anchor-link" href="#Pytorch-&#44396;&#54788;&#52404;"> </a></h2><ul>
<li><a href="https://github.com/GunhoChoi/PyTorch-FastCampus">https://github.com/GunhoChoi/PyTorch-FastCampus</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1)-Import-required-libraries">1) Import required libraries<a class="anchor-link" href="#1)-Import-required-libraries"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">import</span> <span class="nn">torch.nn.init</span> <span class="k">as</span> <span class="nn">init</span>
<span class="kn">import</span> <span class="nn">torchvision.datasets</span> <span class="k">as</span> <span class="nn">dset</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="kn">import</span> <span class="n">Variable</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2)-Set-hyperparmeters">2) Set hyperparmeters<a class="anchor-link" href="#2)-Set-hyperparmeters"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.0005</span>
<span class="n">num_epoch</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">hidden_size</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>3) Download Data</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mnist_train</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">target_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mnist_test</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">target_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./MNIST/raw/train-images-idx3-ubyte.gz
Extracting ./MNIST/raw/train-images-idx3-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./MNIST/raw/train-labels-idx1-ubyte.gz
Extracting ./MNIST/raw/train-labels-idx1-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./MNIST/raw/t10k-images-idx3-ubyte.gz

Extracting ./MNIST/raw/t10k-images-idx3-ubyte.gz to ./MNIST/raw
Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./MNIST/raw/t10k-labels-idx1-ubyte.gz
Extracting ./MNIST/raw/t10k-labels-idx1-ubyte.gz to ./MNIST/raw
Processing...
Done!
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4)-Set-DataLoader">4) Set DataLoader<a class="anchor-link" href="#4)-Set-DataLoader"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">mnist_train</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">mnist_test</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5)-Model">5) Model<a class="anchor-link" href="#5)-Model"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Encoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Encoder</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1_1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">)</span> <span class="c1"># for mu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1_2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">)</span> <span class="c1"># for logvar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
                        
    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1_1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">log_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1_2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span><span class="n">log_var</span>
    
    <span class="k">def</span> <span class="nf">reparametrize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Transformation for differentiable function</span>
<span class="sd">        Return</span>
<span class="sd">            z = mu + std * eps</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">std</span> <span class="o">=</span> <span class="n">logvar</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">exp_</span><span class="p">()</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">std</span><span class="o">.</span><span class="n">size</span><span class="p">())</span><span class="o">.</span><span class="n">normal_</span><span class="p">()</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">eps</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">std</span><span class="p">)</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">reparam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reparametrize</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">logvar</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span><span class="n">logvar</span><span class="p">,</span><span class="n">reparam</span>

<span class="k">class</span> <span class="nc">Decoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Decoder</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_size</span><span class="p">,</span> <span class="mi">784</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">out</span>

<span class="k">class</span> <span class="nc">VAE</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VAE</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">Encoder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Decoder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bce</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">(</span><span class="n">size_average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">reparam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">reparam</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">out</span>

    <span class="k">def</span> <span class="nf">get_recon_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Not Completed: Ask to someone&#39;&#39;&#39;</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">bce_loss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">):</span>
            <span class="n">reparam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">reparametrize</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">)</span>
            <span class="n">recon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">reparam</span><span class="p">)</span>
            <span class="n">bce_loss</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bce</span><span class="p">(</span><span class="n">recon</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">bce_loss</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span>
        <span class="k">return</span> <span class="n">bce_loss</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">()</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction=&#39;sum&#39; instead.
  warnings.warn(warning.format(ret))
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6)-Loss-function-&amp;-Optimizer">6) Loss function &amp; Optimizer<a class="anchor-link" href="#6)-Loss-function-&amp;-Optimizer"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reconstruction_function</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">(</span><span class="n">size_average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">loss_function</span><span class="p">(</span><span class="n">recon_x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">):</span>
    <span class="n">BCE</span> <span class="o">=</span> <span class="n">reconstruction_function</span><span class="p">(</span><span class="n">recon_x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># reconstruction error</span>

    <span class="c1"># see Appendix B from VAE paper:</span>
    <span class="c1"># Kingma and Welling. Auto-Encoding Variational Bayes. ICLR, 2014</span>
    <span class="c1"># https://arxiv.org/abs/1312.6114</span>
    <span class="c1"># 0.5 * sum(1 + log(sigma^2) - mu^2 - sigma^2)</span>
    <span class="n">KLD_element</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">logvar</span><span class="o">.</span><span class="n">exp</span><span class="p">())</span><span class="o">.</span><span class="n">mul_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">logvar</span><span class="p">)</span>
    <span class="n">KLD</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">KLD_element</span><span class="p">)</span><span class="o">.</span><span class="n">mul_</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># regularizer term</span>

    <span class="k">return</span> <span class="n">BCE</span> <span class="o">+</span> <span class="n">KLD</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction=&#39;sum&#39; instead.
  warnings.warn(warning.format(ret))
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7)-Train">7) Train<a class="anchor-link" href="#7)-Train"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epoch</span><span class="p">):</span>
    <span class="n">cum_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,[</span><span class="n">image</span><span class="p">,</span><span class="n">label</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        
        <span class="n">image</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_function</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">)</span>
        <span class="n">cum_loss</span> <span class="o">+=</span> <span class="n">loss</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cum_loss</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">))</span>

<span class="c1"># Train graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/torch/nn/modules/loss.py:498: UserWarning: Using a target size (torch.Size([128, 1, 28, 28])) that is different to the input size (torch.Size([128, 28, 28, 1])) is deprecated. Please ensure they have the same size.
  return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8)-Make-anomaly-data">8) Make anomaly data<a class="anchor-link" href="#8)-Make-anomaly-data"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ood1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ood1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ood 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">ood2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ood2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ood 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
brW7omQAAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test">Test<a class="anchor-link" href="#Test"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">j</span><span class="p">,[</span><span class="n">in_dist</span><span class="p">,</span><span class="n">label</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
    <span class="k">break</span>
<span class="n">in_dist</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">in_dist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">in_recon_prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_recon_prob</span><span class="p">(</span><span class="n">in_dist</span><span class="o">.</span><span class="n">cuda</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/torch/nn/modules/loss.py:498: UserWarning: Using a target size (torch.Size([1, 1, 28, 28])) that is different to the input size (torch.Size([1, 28, 28, 1])) is deprecated. Please ensure they have the same size.
  return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>

<span class="n">out_dist</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">out_dist</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">out_recon_prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_recon_prob</span><span class="p">(</span><span class="n">out_dist</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/torch/nn/modules/loss.py:498: UserWarning: Using a target size (torch.Size([1, 1, 28, 28])) that is different to the input size (torch.Size([1, 28, 28, 1])) is deprecated. Please ensure they have the same size.
  return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">in_recon_prob</span><span class="p">,</span> <span class="n">out_recon_prob</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(110.3578, device=&#39;cuda:0&#39;, grad_fn=&lt;DivBackward0&gt;),
 tensor(1126.5494, device=&#39;cuda:0&#39;, grad_fn=&lt;DivBackward0&gt;))</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>

<script type="application/vnd.jupyter.widget-state+json">
{"3bdf7bfa33424afe9e6664871ae9c29e": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_view_name": "HBoxView", "_dom_classes": [], "_model_name": "HBoxModel", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.5.0", "box_style": "", "layout": "IPY_MODEL_d0d88d816ae943a1812d00a199d59715", "_model_module": "@jupyter-widgets/controls", "children": ["IPY_MODEL_097cc8b59edf42acbfd1ead07f61bbe8", "IPY_MODEL_bedbca85516641ccb5ceca90c0843bb3"]}}, "d0d88d816ae943a1812d00a199d59715": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "097cc8b59edf42acbfd1ead07f61bbe8": {"model_module": "@jupyter-widgets/controls", "model_name": "IntProgressModel", "state": {"_view_name": "ProgressView", "style": "IPY_MODEL_aaefda59b2674f03934cea78f5aa8275", "_dom_classes": [], "description": "", "_model_name": "IntProgressModel", "bar_style": "info", "max": 1, "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": 1, "_view_count": null, "_view_module_version": "1.5.0", "orientation": "horizontal", "min": 0, "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_23dabf490fce496b959a8b4753bffa49"}}, "bedbca85516641ccb5ceca90c0843bb3": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_view_name": "HTMLView", "style": "IPY_MODEL_3922184c838c4b768573ac7a8f91a672", "_dom_classes": [], "description": "", "_model_name": "HTMLModel", "placeholder": "\u200b", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": " 9920512/? [00:20&lt;00:00, 2045129.04it/s]", "_view_count": null, "_view_module_version": "1.5.0", "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_cd09091252824483a7a123a3fc039302"}}, "aaefda59b2674f03934cea78f5aa8275": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_view_name": "StyleView", "_model_name": "ProgressStyleModel", "description_width": "initial", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "bar_color": null, "_model_module": "@jupyter-widgets/controls"}}, "23dabf490fce496b959a8b4753bffa49": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "3922184c838c4b768573ac7a8f91a672": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_view_name": "StyleView", "_model_name": "DescriptionStyleModel", "description_width": "", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "_model_module": "@jupyter-widgets/controls"}}, "cd09091252824483a7a123a3fc039302": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "3a355391c87b4c888dbca83b9cfb9380": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_view_name": "HBoxView", "_dom_classes": [], "_model_name": "HBoxModel", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.5.0", "box_style": "", "layout": "IPY_MODEL_f8a260b479dd4075a704f177066c8720", "_model_module": "@jupyter-widgets/controls", "children": ["IPY_MODEL_3777889f58d54a58a5e8f2a5b16df6b1", "IPY_MODEL_b8b316e04d01479aa5fd7a8664a3d9b6"]}}, "f8a260b479dd4075a704f177066c8720": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "3777889f58d54a58a5e8f2a5b16df6b1": {"model_module": "@jupyter-widgets/controls", "model_name": "IntProgressModel", "state": {"_view_name": "ProgressView", "style": "IPY_MODEL_059d05f7fef7445389c670d9f707566f", "_dom_classes": [], "description": "", "_model_name": "IntProgressModel", "bar_style": "success", "max": 1, "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": 1, "_view_count": null, "_view_module_version": "1.5.0", "orientation": "horizontal", "min": 0, "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_b49c87bfd0a84116b2a326fdaf6d22fb"}}, "b8b316e04d01479aa5fd7a8664a3d9b6": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_view_name": "HTMLView", "style": "IPY_MODEL_d54d605f816540a1b4e676c30475f017", "_dom_classes": [], "description": "", "_model_name": "HTMLModel", "placeholder": "\u200b", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": " 32768/? [00:00&lt;00:00, 101260.58it/s]", "_view_count": null, "_view_module_version": "1.5.0", "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_5a088b3b0af54652a71d5e408f939206"}}, "059d05f7fef7445389c670d9f707566f": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_view_name": "StyleView", "_model_name": "ProgressStyleModel", "description_width": "initial", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "bar_color": null, "_model_module": "@jupyter-widgets/controls"}}, "b49c87bfd0a84116b2a326fdaf6d22fb": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "d54d605f816540a1b4e676c30475f017": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_view_name": "StyleView", "_model_name": "DescriptionStyleModel", "description_width": "", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "_model_module": "@jupyter-widgets/controls"}}, "5a088b3b0af54652a71d5e408f939206": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "1065faac074147cc9792e0f043081094": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_view_name": "HBoxView", "_dom_classes": [], "_model_name": "HBoxModel", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.5.0", "box_style": "", "layout": "IPY_MODEL_ecd217c464c14e6095792f4697211cd3", "_model_module": "@jupyter-widgets/controls", "children": ["IPY_MODEL_bcbafb2883dd4437abf2365dc5a8be63", "IPY_MODEL_5611437463484c99b23b4c070f360f58"]}}, "ecd217c464c14e6095792f4697211cd3": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "bcbafb2883dd4437abf2365dc5a8be63": {"model_module": "@jupyter-widgets/controls", "model_name": "IntProgressModel", "state": {"_view_name": "ProgressView", "style": "IPY_MODEL_113eecce0332490097c3d36fdb56311a", "_dom_classes": [], "description": "", "_model_name": "IntProgressModel", "bar_style": "info", "max": 1, "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": 1, "_view_count": null, "_view_module_version": "1.5.0", "orientation": "horizontal", "min": 0, "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_6d077393fd9f45b3b1233d5094f2e1c5"}}, "5611437463484c99b23b4c070f360f58": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_view_name": "HTMLView", "style": "IPY_MODEL_bf58b2e8e0034e1b8d3ce65866716c5f", "_dom_classes": [], "description": "", "_model_name": "HTMLModel", "placeholder": "\u200b", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": " 1654784/? [00:13&lt;00:00, 279110.66it/s]", "_view_count": null, "_view_module_version": "1.5.0", "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_1d6824e180b3480380d7a3d3a21dbbb1"}}, "113eecce0332490097c3d36fdb56311a": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_view_name": "StyleView", "_model_name": "ProgressStyleModel", "description_width": "initial", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "bar_color": null, "_model_module": "@jupyter-widgets/controls"}}, "6d077393fd9f45b3b1233d5094f2e1c5": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "bf58b2e8e0034e1b8d3ce65866716c5f": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_view_name": "StyleView", "_model_name": "DescriptionStyleModel", "description_width": "", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "_model_module": "@jupyter-widgets/controls"}}, "1d6824e180b3480380d7a3d3a21dbbb1": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "a675418e0fc14a3da632065af6cce1b3": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "state": {"_view_name": "HBoxView", "_dom_classes": [], "_model_name": "HBoxModel", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.5.0", "box_style": "", "layout": "IPY_MODEL_b76d4d565dc44335aa82eeb26151fc8e", "_model_module": "@jupyter-widgets/controls", "children": ["IPY_MODEL_e1b9abefd878480aa26d58d97a03cdb8", "IPY_MODEL_290c15eb8eee476ba529fb49b398ccc4"]}}, "b76d4d565dc44335aa82eeb26151fc8e": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "e1b9abefd878480aa26d58d97a03cdb8": {"model_module": "@jupyter-widgets/controls", "model_name": "IntProgressModel", "state": {"_view_name": "ProgressView", "style": "IPY_MODEL_aa1bf32e6c754b398dec2eeed0f7a294", "_dom_classes": [], "description": "", "_model_name": "IntProgressModel", "bar_style": "success", "max": 1, "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": 1, "_view_count": null, "_view_module_version": "1.5.0", "orientation": "horizontal", "min": 0, "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_6df3ddebe9624052b8792b5c79c6d403"}}, "290c15eb8eee476ba529fb49b398ccc4": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "state": {"_view_name": "HTMLView", "style": "IPY_MODEL_350a750f76784d86840f361182ad03dc", "_dom_classes": [], "description": "", "_model_name": "HTMLModel", "placeholder": "\u200b", "_view_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "value": " 8192/? [00:00&lt;00:00, 20212.65it/s]", "_view_count": null, "_view_module_version": "1.5.0", "description_tooltip": null, "_model_module": "@jupyter-widgets/controls", "layout": "IPY_MODEL_61c200a7ebea4afcbb7c14e4e9b32b3a"}}, "aa1bf32e6c754b398dec2eeed0f7a294": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "state": {"_view_name": "StyleView", "_model_name": "ProgressStyleModel", "description_width": "initial", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "bar_color": null, "_model_module": "@jupyter-widgets/controls"}}, "6df3ddebe9624052b8792b5c79c6d403": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}, "350a750f76784d86840f361182ad03dc": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "state": {"_view_name": "StyleView", "_model_name": "DescriptionStyleModel", "description_width": "", "_view_module": "@jupyter-widgets/base", "_model_module_version": "1.5.0", "_view_count": null, "_view_module_version": "1.2.0", "_model_module": "@jupyter-widgets/controls"}}, "61c200a7ebea4afcbb7c14e4e9b32b3a": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "state": {"_view_name": "LayoutView", "grid_template_rows": null, "right": null, "justify_content": null, "_view_module": "@jupyter-widgets/base", "overflow": null, "_model_module_version": "1.2.0", "_view_count": null, "flex_flow": null, "width": null, "min_width": null, "border": null, "align_items": null, "bottom": null, "_model_module": "@jupyter-widgets/base", "top": null, "grid_column": null, "overflow_y": null, "overflow_x": null, "grid_auto_flow": null, "grid_area": null, "grid_template_columns": null, "flex": null, "_model_name": "LayoutModel", "justify_items": null, "grid_row": null, "max_height": null, "align_content": null, "visibility": null, "align_self": null, "height": null, "min_height": null, "padding": null, "grid_auto_rows": null, "grid_gap": null, "max_width": null, "order": null, "_view_module_version": "1.2.0", "grid_template_areas": null, "object_position": null, "object_fit": null, "grid_auto_columns": null, "margin": null, "display": null, "left": null}}}
</script>



  </div><a class="u-url" href="/blog/2020/03/30/anomaly-detection-by-VAE.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Tech Blog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
